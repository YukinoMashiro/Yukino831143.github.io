{"meta":{"title":"yukino","subtitle":null,"description":"ä¸€æšç¨‹åºå‘˜çš„æ—¥å¸¸","author":"yukino","url":""},"pages":[{"title":"about","date":"2018-12-12T14:14:36.000Z","updated":"2022-10-09T15:19:10.437Z","comments":false,"path":"about/index.html","permalink":"/about/index.html","excerpt":"","text":"[Yukino] ä¸&nbsp; Yukino&nbsp; ï¼ˆ Yukino ï¼‰ å¯¹è¯ä¸­... bot_ui_ini()","keywords":"å…³äº"},{"title":"bangumi","date":"2019-02-10T13:32:48.000Z","updated":"2022-10-09T15:19:10.453Z","comments":false,"path":"bangumi/index.html","permalink":"/bangumi/index.html","excerpt":"","text":"","keywords":null},{"title":"client","date":"2018-12-20T15:13:35.000Z","updated":"2022-10-09T15:19:10.453Z","comments":false,"path":"client/index.html","permalink":"/client/index.html","excerpt":"","text":"ç›´æ¥ä¸‹è½½ or æ‰«ç ä¸‹è½½ï¼š","keywords":"Androidå®¢æˆ·ç«¯"},{"title":"comment","date":"2018-12-20T15:13:48.000Z","updated":"2022-10-09T15:19:10.453Z","comments":true,"path":"comment/index.html","permalink":"/comment/index.html","excerpt":"","text":"å¿µä¸¤å¥è¯— å™åˆ«æ¢¦ã€æ‰¬å·ä¸€è§‰ã€‚ ã€å®‹ä»£ã€‘å´æ–‡è‹±ã€Šå¤œæ¸¸å®«Â·äººå»è¥¿æ¥¼é›æ³ã€‹","keywords":"ç•™è¨€æ¿"},{"title":"donate","date":"2018-12-20T15:13:05.000Z","updated":"2022-10-09T15:19:10.453Z","comments":false,"path":"donate/index.html","permalink":"/donate/index.html","excerpt":"","text":"","keywords":"è°¢è°¢é¥²ä¸»äº†å–µ~"},{"title":"lab","date":"2019-01-05T13:47:59.000Z","updated":"2022-10-09T15:19:10.453Z","comments":false,"path":"lab/index.html","permalink":"/lab/index.html","excerpt":"","text":"sakura ä¸»é¢˜balabala","keywords":"Labå®éªŒå®¤"},{"title":"links","date":"2018-12-19T15:11:06.000Z","updated":"2022-10-09T15:19:10.453Z","comments":true,"path":"links/index.html","permalink":"/links/index.html","excerpt":"","text":"","keywords":"å‹äººå¸"},{"title":"music","date":"2018-12-20T15:14:28.000Z","updated":"2022-10-09T15:19:10.453Z","comments":false,"path":"music/index.html","permalink":"/music/index.html","excerpt":"","text":"","keywords":"å–œæ¬¢çš„éŸ³ä¹"},{"title":"rss","date":"2018-12-20T15:09:03.000Z","updated":"2022-10-09T15:19:10.453Z","comments":true,"path":"rss/index.html","permalink":"/rss/index.html","excerpt":"","text":""},{"title":"tags","date":"2018-12-12T14:14:16.000Z","updated":"2022-10-09T15:19:10.453Z","comments":true,"path":"tags/index.html","permalink":"/tags/index.html","excerpt":"","text":""},{"title":"theme-sakura","date":"2019-01-04T14:53:25.000Z","updated":"2022-10-09T15:19:10.453Z","comments":false,"path":"theme-sakura/index.html","permalink":"/theme-sakura/index.html","excerpt":"","text":"Hexoä¸»é¢˜Sakuraä¿®æ”¹è‡ªWordPressä¸»é¢˜Sakuraï¼Œæ„Ÿè°¢åŸä½œè€…Mashiro","keywords":"Hexo ä¸»é¢˜ Sakura ğŸŒ¸"},{"title":"video","date":"2018-12-20T15:14:38.000Z","updated":"2022-10-09T15:19:10.453Z","comments":false,"path":"video/index.html","permalink":"/video/index.html","excerpt":"","text":"var videos = [ { img: 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: 'æ”¾é€æ—¶é—´: 2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' }, { img : 'https://lain.bgm.tv/pic/cover/l/0e/1e/218971_2y351.jpg', title: 'æœèŠ±å¤•èª“â€”â€”äºç¦»åˆ«ä¹‹æœæŸèµ·çº¦å®šä¹‹èŠ±', status: 'å·²è¿½å®Œ', progress: 100, jp: 'ã•ã‚ˆãªã‚‰ã®æœã«ç´„æŸã®èŠ±ã‚’ã‹ã–ã‚ã†', time: '2018-02-24 SUN.', desc: ' ä½åœ¨è¿œç¦»å°˜åš£çš„åœŸåœ°ï¼Œä¸€è¾¹å°†æ¯å¤©çš„äº‹æƒ…ç¼–ç»‡æˆåä¸ºå¸Œæ¯”æ¬§çš„å¸ƒï¼Œä¸€è¾¹é™é™ç”Ÿæ´»çš„ä¼Šæ¬§å¤«äººæ°‘ã€‚åœ¨15å²å·¦å³å¤–è¡¨å°±åœæ­¢æˆé•¿ï¼Œæ‹¥æœ‰æ•°ç™¾å¹´å¯¿å‘½çš„ä»–ä»¬ï¼Œè¢«ç§°ä¸ºâ€œç¦»åˆ«çš„ä¸€æ—â€ï¼Œå¹¶è¢«è§†ä¸ºæ´»ç€çš„ä¼ è¯´ã€‚æ²¡æœ‰åŒäº²çš„ä¼Šæ¬§å¤«å°‘å¥³ç›å¥‡äºšï¼Œè¿‡ç€è¢«ä¼™ä¼´åŒ…å›´çš„å¹³ç¨³æ—¥å­ï¼Œå´æ€»æ„Ÿè§‰â€œå­¤èº«ä¸€äººâ€ã€‚ä»–ä»¬çš„è¿™ç§æ—¥å¸¸ï¼Œä¸€ç¬é—´å°±å´©æºƒæ¶ˆå¤±ã€‚è¿½æ±‚ä¼Šæ¬§å¤«çš„é•¿å¯¿ä¹‹è¡€ï¼Œæ¢…è¨è’‚å†›ä¹˜åç€åä¸ºé›·çº³ç‰¹çš„å¤ä»£å…½å‘åŠ¨äº†è¿›æ”»ã€‚åœ¨ç»æœ›ä¸æ··ä¹±ä¹‹ä¸­ï¼Œä¼Šæ¬§å¤«çš„ç¬¬ä¸€ç¾å¥³è•¾è‰äºšè¢«æ¢…è¨è’‚å¸¦èµ°ï¼Œè€Œç›å¥‡äºšæš—æ‹çš„å°‘å¹´å…‹é‡Œå§†ä¹Ÿå¤±è¸ªäº†ã€‚ç›å¥‡äºšè™½ç„¶æ€»ç®—é€ƒè„±äº†ï¼Œå´å¤±å»äº†ä¼™ä¼´å’Œå½’å»ä¹‹åœ°â€¦â€¦ã€‚' } ] .should-ellipsis{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:95%;}.should-ellipsis-full{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;width:100%;}.should-ellipsis i{position:absolute;right:24px;}.grey-text{color:#9e9e9e !important}.grey-text.text-darken-4{color:#212121 !important}html{line-height:1.15;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}img{border-style:none}progress{display:inline-block;vertical-align:baseline}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}html{-webkit-box-sizing:border-box;box-sizing:border-box}*,*:before,*:after{-webkit-box-sizing:inherit;box-sizing:inherit}ul:not(.browser-default){padding-left:0;list-style-type:none}ul:not(.browser-default)>li{list-style-type:none}.card{-webkit-box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2);box-shadow:0 2px 2px 0 rgba(0,0,0,0.14),0 3px 1px -2px rgba(0,0,0,0.12),0 1px 5px 0 rgba(0,0,0,0.2)}.hoverable{-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s}.hoverable:hover{-webkit-box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19);box-shadow:0 8px 17px 0 rgba(0,0,0,0.2),0 6px 20px 0 rgba(0,0,0,0.19)}i{line-height:inherit}i.right{float:right;margin-left:15px}.bangumi .right{float:right !important}.material-icons{text-rendering:optimizeLegibility;-webkit-font-feature-settings:'liga';-moz-font-feature-settings:'liga';font-feature-settings:'liga'}.row{margin-left:auto;margin-right:auto;margin-bottom:20px}.row:after{content:\"\";display:table;clear:both}.row .col{float:left;-webkit-box-sizing:border-box;box-sizing:border-box;padding:0 .75rem;min-height:1px}.row .col.s12{width:100%;margin-left:auto;left:auto;right:auto}@media only screen and (min-width:601px){.row .col.m6{width:50%;margin-left:auto;left:auto;right:auto}}html{line-height:1.5;font-family:-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,Oxygen-Sans,Ubuntu,Cantarell,\"Helvetica Neue\",sans-serif;font-weight:normal;color:rgba(0,0,0,0.87)}@media only screen and (min-width:0){html{font-size:14px}}@media only screen and (min-width:992px){html{font-size:14.5px}}@media only screen and (min-width:1200px){html{font-size:15px}}.card{position:relative;margin:.5rem 0 1rem 0;background-color:#fff;-webkit-transition:-webkit-box-shadow .25s;transition:-webkit-box-shadow .25s;transition:box-shadow .25s;transition:box-shadow .25s,-webkit-box-shadow .25s;border-radius:2px}.card .card-title{font-size:24px;font-weight:300}.card .card-title.activator{cursor:pointer}.card .card-image{position:relative}.card .card-image img{display:block;border-radius:2px 2px 0 0;position:relative;left:0;right:0;top:0;bottom:0;width:100%}.card .card-content{padding:24px;border-radius:0 0 2px 2px}.card .card-content p{margin:0}.card .card-content .card-title{display:block;line-height:32px;margin-bottom:8px}.card .card-content .card-title i{line-height:32px}.card .card-reveal{padding:24px;position:absolute;background-color:#fff;width:100%;overflow-y:auto;left:0;top:100%;height:100%;z-index:3;display:none}.card .card-reveal .card-title{cursor:pointer;display:block}.waves-effect{position:relative;cursor:pointer;display:inline-block;overflow:hidden;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;-webkit-tap-highlight-color:transparent;vertical-align:middle;z-index:1;-webkit-transition:.3s ease-out;transition:.3s ease-out}.waves-effect img{position:relative;z-index:-1}.waves-block{display:block}::-webkit-input-placeholder{color:#d1d1d1}::-moz-placeholder{color:#d1d1d1}:-ms-input-placeholder{color:#d1d1d1}::-ms-input-placeholder{color:#d1d1d1}[type=\"radio\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"radio\"]:not(:checked)+span{position:relative;padding-left:35px;cursor:pointer;display:inline-block;height:25px;line-height:25px;font-size:1rem;-webkit-transition:.28s ease;transition:.28s ease;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border-radius:50%}[type=\"radio\"]:not(:checked)+span:before,[type=\"radio\"]:not(:checked)+span:after{border:2px solid #5a5a5a}[type=\"radio\"]:not(:checked)+span:after{-webkit-transform:scale(0);transform:scale(0)}[type=\"checkbox\"]:not(:checked){position:absolute;opacity:0;pointer-events:none}[type=\"checkbox\"]:not(:checked):disabled+span:not(.lever):before{border:none;background-color:rgba(0,0,0,0.42)}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):before{width:0;height:0;border:3px solid transparent;left:6px;top:10px;-webkit-transform:rotateZ(37deg);transform:rotateZ(37deg);-webkit-transform-origin:100% 100%;transform-origin:100% 100%}[type=\"checkbox\"].filled-in:not(:checked)+span:not(.lever):after{height:20px;width:20px;background-color:transparent;border:2px solid #5a5a5a;top:0px;z-index:0}input[type=checkbox]:not(:disabled) ~ .lever:active:before,input[type=checkbox]:not(:disabled).tabbed:focus ~ .lever::before{-webkit-transform:scale(2.4);transform:scale(2.4);background-color:rgba(0,0,0,0.08)}input[type=range].focused:focus:not(.active)::-webkit-slider-thumb{-webkit-box-shadow:0 0 0 10px rgba(38,166,154,0.26);box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-moz-range-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)}input[type=range].focused:focus:not(.active)::-ms-thumb{box-shadow:0 0 0 10px rgba(38,166,154,0.26)} ç•ªç»„è®¡åˆ’ è¿™é‡Œå°†æ˜¯æ°¸è¿œçš„å›å¿† window.onload = function(){ videos.forEach(function(video, i){ $('#rootRow').append(` ${video.title} ${video.jp} ${video.status} ${video.title} ${video.jp} æ”¾é€æ—¶é—´: ${video.time} ${video.desc} ${video.status} `) }) }","keywords":"Bç«™"}],"posts":[{"title":"ç½‘ç›˜æºç è§£æ","slug":"æŠ€æœ¯/YukinoCloudæºç è§£æ","date":"2021-01-31T08:00:00.000Z","updated":"2022-10-09T15:19:10.433Z","comments":true,"path":"2021/01/31/æŠ€æœ¯/YukinoCloudæºç è§£æ/","link":"","permalink":"/2021/01/31/æŠ€æœ¯/YukinoCloudæºç è§£æ/","excerpt":"","text":"0. æ•°æ®åº“CREATE TABLE `file_folder` ( `file_folder_id` int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;æ–‡ä»¶å¤¹ID&#39;, `file_folder_name` varchar(255) DEFAULT NULL COMMENT &#39;æ–‡ä»¶å¤¹åç§°&#39;, `parent_folder_id` int(11) DEFAULT &#39;0&#39; COMMENT &#39;çˆ¶æ–‡ä»¶å¤¹ID&#39;, `file_store_id` int(11) DEFAULT NULL COMMENT &#39;æ‰€å±æ–‡ä»¶ä»“åº“ID&#39;, `time` datetime DEFAULT NULL COMMENT &#39;åˆ›å»ºæ—¶é—´&#39;, PRIMARY KEY (`file_folder_id`) ) ENGINE=InnoDB AUTO_INCREMENT=0 DEFAULT CHARSET=utf8; @AllArgsConstructor @Data @Builder public class FileFolder implements Serializable { /** * æ–‡ä»¶å¤¹ID */ private Integer fileFolderId; /** * æ–‡ä»¶å¤¹åç§° */ private String fileFolderName; /** * çˆ¶æ–‡ä»¶å¤¹ID */ private Integer parentFolderId; /** * æ‰€å±æ–‡ä»¶ä»“åº“ID */ private Integer fileStoreId; /** * åˆ›å»ºæ—¶é—´ */ private Date time; } CREATE TABLE `file_store` ( `file_store_id` int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;æ–‡ä»¶ä»“åº“ID&#39;, `user_id` int(11) DEFAULT NULL COMMENT &#39;ä¸»äººID&#39;, `current_size` int(11) DEFAULT &#39;0&#39; COMMENT &#39;å½“å‰å®¹é‡ï¼ˆå•ä½KBï¼‰&#39;, `max_size` int(11) DEFAULT &#39;1048576&#39; COMMENT &#39;æœ€å¤§å®¹é‡ï¼ˆå•ä½KBï¼‰&#39;, `permission` int(11) DEFAULT &#39;0&#39; COMMENT &#39;ä»“åº“æƒé™ï¼Œ0å¯ä¸Šä¼ ä¸‹è½½ã€1ä¸å…è®¸ä¸Šä¼ å¯ä»¥ä¸‹è½½ã€2ä¸å¯ä»¥ä¸Šä¼ ä¸‹è½½&#39;, PRIMARY KEY (`file_store_id`) ) ENGINE=InnoDB AUTO_INCREMENT=0 DEFAULT CHARSET=utf8; @AllArgsConstructor @Data @Builder public class FileStore implements Serializable { /** * æ–‡ä»¶ä»“åº“ID */ private Integer fileStoreId; /** * ä¸»äººID */ private Integer userId; /** * å½“å‰å®¹é‡ï¼ˆå•ä½KBï¼‰ */ private Integer currentSize; /** * æœ€å¤§å®¹é‡ï¼ˆå•ä½KBï¼‰ */ private Integer maxSize; /** * ä»“åº“æƒé™ï¼š0å¯ä¸Šä¼ ä¸‹è½½ã€1åªå…è®¸ä¸‹è½½ã€2ç¦æ­¢ä¸Šä¼ ä¸‹è½½ */ private Integer permission; } CREATE TABLE `my_file` ( `my_file_id` int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;æ–‡ä»¶ID&#39;, `my_file_name` varchar(255) DEFAULT NULL COMMENT &#39;æ–‡ä»¶å&#39;, `file_store_id` int(11) DEFAULT NULL COMMENT &#39;æ–‡ä»¶ä»“åº“ID&#39;, `my_file_path` varchar(255) DEFAULT &#39;/&#39; COMMENT &#39;æ–‡ä»¶å­˜å‚¨è·¯å¾„&#39;, `download_time` int(11) DEFAULT &#39;0&#39; COMMENT &#39;ä¸‹è½½æ¬¡æ•°&#39;, `upload_time` datetime DEFAULT NULL COMMENT &#39;ä¸Šä¼ æ—¶é—´&#39;, `parent_folder_id` int(11) DEFAULT NULL COMMENT &#39;çˆ¶æ–‡ä»¶å¤¹ID&#39;, `size` int(11) DEFAULT NULL COMMENT &#39;æ–‡ä»¶å¤§å°&#39;, `type` int(11) DEFAULT NULL COMMENT &#39;æ–‡ä»¶ç±»å‹&#39;, `postfix` varchar(255) DEFAULT NULL COMMENT &#39;æ–‡ä»¶åç¼€&#39;, PRIMARY KEY (`my_file_id`) ) ENGINE=InnoDB AUTO_INCREMENT=0 DEFAULT CHARSET=utf8; @AllArgsConstructor @Data @Builder public class MyFile implements Serializable { /** * æ–‡ä»¶ID */ private Integer myFileId; /** * æ–‡ä»¶å */ private String myFileName; /** * æ–‡ä»¶ä»“åº“ID */ private Integer fileStoreId; /** * æ–‡ä»¶å­˜å‚¨è·¯å¾„ */ private String myFilePath; /** * ä¸‹è½½æ¬¡æ•° */ private Integer downloadTime; /** * ä¸Šä¼ æ—¶é—´ */ private Date uploadTime; /** * çˆ¶æ–‡ä»¶å¤¹ID */ private Integer parentFolderId; /** * æ–‡ä»¶å¤§å° */ private Integer size; /** * æ–‡ä»¶ç±»å‹ */ private Integer type; /** * æ–‡ä»¶åç¼€ */ private String postfix; } CREATE TABLE `temp_file` ( `file_id` int(11) NOT NULL AUTO_INCREMENT COMMENT &#39;ä¸´æ—¶æ–‡ä»¶ID&#39;, `file_name` varchar(255) DEFAULT NULL COMMENT &#39;æ–‡ä»¶å&#39;, `size` varchar(255) DEFAULT NULL COMMENT &#39;æ–‡ä»¶å¤§å°&#39;, `upload_time` datetime DEFAULT NULL COMMENT &#39;ä¸Šä¼ æ—¶é—´ï¼š4å°æ—¶ååˆ é™¤&#39;, `file_path` varchar(255) DEFAULT NULL COMMENT &#39;æ–‡ä»¶åœ¨FTPä¸Šçš„å­˜æ”¾è·¯å¾„&#39;, PRIMARY KEY (`file_id`) ) ENGINE=InnoDB AUTO_INCREMENT=0 DEFAULT CHARSET=utf8; @AllArgsConstructor @Data @Builder public class TempFile implements Serializable { private static final long serialVersionUID = -90736141035866360L; /** * ä¸´æ—¶æ–‡ä»¶ID */ private Integer fileId; /** * æ–‡ä»¶å */ private String fileName; /** * æ–‡ä»¶å¤§å° */ private String size; /** * ä¸Šä¼ æ—¶é—´ï¼š4å°æ—¶ååˆ é™¤ */ private Date uploadTime; /** * æ–‡ä»¶åœ¨FTPä¸Šçš„å­˜æ”¾è·¯å¾„ */ private String filePath; } CREATE TABLE `user` ( `user_id` int(10) unsigned NOT NULL AUTO_INCREMENT COMMENT &#39;ç”¨æˆ·ID&#39;, `open_id` varchar(255) DEFAULT NULL COMMENT &#39;ç”¨æˆ·çš„openid&#39;, `file_store_id` int(11) DEFAULT NULL COMMENT &#39;æ–‡ä»¶ä»“åº“ID&#39;, `user_name` varchar(50) DEFAULT NULL COMMENT &#39;ç”¨æˆ·å&#39;, `email` varchar(50) DEFAULT &#39; 0000@qq.com&#39; COMMENT &#39;ç”¨æˆ·é‚®ç®±&#39;, `password` varchar(20) DEFAULT NULL COMMENT &#39;å¯†ç &#39;, `register_time` datetime DEFAULT NULL COMMENT &#39;æ³¨å†Œæ—¶é—´&#39;, `image_path` varchar(255) DEFAULT &#39;&#39; COMMENT &#39;å¤´åƒåœ°å€&#39;, `role` int(11) DEFAULT &#39;1&#39; COMMENT &#39;ç”¨æˆ·è§’è‰²,0ç®¡ç†å‘˜ï¼Œ1æ™®é€šç”¨æˆ·&#39;, PRIMARY KEY (`user_id`) ) ENGINE=InnoDB AUTO_INCREMENT=0 DEFAULT CHARSET=utf8; @AllArgsConstructor @Data @Builder public class User implements Serializable { /** * ç”¨æˆ·ID */ private Integer userId; /** * ç”¨æˆ·çš„openid */ private String openId; /** * æ–‡ä»¶ä»“åº“ID */ private Integer fileStoreId; /** * ç”¨æˆ·å */ private String userName; /** * ç”¨æˆ·é‚®ç®± */ private String email; /** * ç”¨æˆ·å¯†ç  */ private String password; /** * æ³¨å†Œæ—¶é—´ */ private Date registerTime; /** * å¤´åƒåœ°å€ */ private String imagePath; /** * ç”¨æˆ·è§’è‰²ï¼Œ0ç®¡ç†å‘˜ï¼Œ1æ™®é€šç”¨æˆ· */ private Integer role; } 1.æ³¨å†Œä¸ç™»å½•1.1 é‚®ç®±æ³¨å†Œè·å–éªŒè¯ç  @ResponseBody @RequestMapping(&quot;/sendCode&quot;) public String sendCode(String userName, String email, String password) { User userByEmail = userService.getUserByEmail(email); if (userByEmail != null) { logger.error(&quot;å‘é€éªŒè¯ç å¤±è´¥ï¼é‚®ç®±å·²è¢«æ³¨å†Œï¼&quot;); return &quot;exitEmail&quot;; } logger.info(&quot;å¼€å§‹å‘é€é‚®ä»¶.../n&quot; + &quot;è·å–çš„åˆ°é‚®ä»¶å‘é€å¯¹è±¡ä¸º:&quot; + mailSender); mailUtils = new MailUtils(mailSender); String code = mailUtils.sendCode(email, userName, password); session.setAttribute(email + &quot;_code&quot;, code); return &quot;success&quot;; } public String sendCode(String email,String userName,String password){ int code = (int) ((Math.random() * 9 + 1) * 100000); logger.info(&quot;å¼€å§‹å‘é€å¤æ‚é‚®ä»¶...&quot;); logger.info(&quot;mailSenderå¯¹è±¡ä¸º:&quot;+mailSender); MimeMessage mimeMessage = mailSender.createMimeMessage(); MimeMessageHelper helper = new MimeMessageHelper(mimeMessage); try { helper.setSubject(&quot;è«æç½‘ç›˜-é‚®ç®±éªŒè¯&quot;); helper.setText(&quot;&lt;h2 &gt;è«æç½‘ç›˜-ç®€æ´ã€ä¼˜é›…ã€å…è´¹&lt;/h2&gt;&quot; + &quot;&lt;h3&gt;ç”¨æˆ·æ³¨å†Œ-é‚®ç®±éªŒè¯&lt;h3/&gt;&quot; + &quot;æ‚¨ç°åœ¨æ­£åœ¨æ³¨å†Œè«æç½‘ç›˜è´¦å·&lt;br&gt;&quot; + &quot;éªŒè¯ç : &lt;span style=&#39;color : red&#39;&gt;&quot;+code+&quot;&lt;/span&gt;&lt;br&gt;&quot; + &quot;ç”¨æˆ·å :&quot;+userName+ &quot;&lt;br&gt;å¯†ç  :&quot;+password+ &quot;&lt;hr&gt;&quot;+ &quot;&lt;h5 style=&#39;color : red&#39;&gt;å¦‚æœå¹¶éæœ¬äººæ“ä½œ,è¯·å¿½ç•¥æœ¬é‚®ä»¶&lt;/h5&gt;&quot;,true); //helper.setFrom(&quot;ä½ éœ€è¦ä¿®æ”¹æ­¤å¤„ä¸ºä½ çš„QQé‚®ç®±&quot;); helper.setFrom(&quot;707772743@qq.com&quot;); helper.setTo(email); } catch (MessagingException e) { e.printStackTrace(); } logger.info(&quot;mimeMessageå¯¹è±¡ä¸º:&quot;+mimeMessage); mailSender.send(mimeMessage); return String.valueOf(code); } åç«¯ç”ŸæˆéªŒè¯ç ï¼Œç”Ÿæˆçš„éªŒè¯ç ï¼Œé€šè¿‡sessionå±æ€§è¿”å›ç»™é¡µé¢ï¼Œé€šè¿‡é‚®ä»¶æœåŠ¡å‘é€ç»™æ³¨å†Œé‚®ç®±ï¼Œå‰ç«¯è¿›è¡ŒéªŒè¯ç æ¯”å¯¹. æ³¨å†Œ @PostMapping(&quot;/register&quot;) public String register(User user, String code, Map&lt;String, Object&gt; map) { String uCode = (String) session.getAttribute(user.getEmail() + &quot;_code&quot;); if (!code.equals(uCode)) { map.put(&quot;errorMsg&quot;, &quot;éªŒè¯ç é”™è¯¯&quot;); return &quot;index&quot;; } // ç”¨æˆ·åå»ç©ºæ ¼ user.setUserName(user.getUserName().trim()); user.setImagePath(&quot;https://p.qpic.cn/qqconnect/0/app_101851241_1582451550/100?max-age=2592000&amp;t=0&quot;); user.setRegisterTime(new Date()); user.setRole(1); if (userService.insert(user)) { FileStore store = FileStore.builder().userId(user.getUserId()).currentSize(0).build(); fileStoreService.addFileStore(store); user.setFileStoreId(store.getFileStoreId()); userService.update(user); logger.info(&quot;æ³¨å†Œç”¨æˆ·æˆåŠŸï¼å½“å‰æ³¨å†Œç”¨æˆ·&quot; + user); logger.info(&quot;æ³¨å†Œä»“åº“æˆåŠŸï¼å½“å‰æ³¨å†Œä»“åº“&quot; + store); } else { map.put(&quot;errorMsg&quot;, &quot;æœåŠ¡å™¨å‘ç”Ÿé”™è¯¯ï¼Œæ³¨å†Œå¤±è´¥&quot;); return &quot;index&quot;; } session.removeAttribute(user.getEmail() + &quot;_code&quot;); session.setAttribute(&quot;loginUser&quot;, user); return &quot;redirect:/index&quot;; } åˆ›å»ºç”¨æˆ·ç”¨æˆ·ä¿¡æ¯ åˆ›å»ºè¯¥ç”¨æˆ·å¯¹åº”çš„ä»“åº“ä¿¡æ¯ï¼Œå¹¶å°†ç”¨æˆ·ä¿¡æ¯ä¸ä»“åº“ä¿¡æ¯å…³è”èµ·æ¥ã€‚ 1.2 ç™»å½• @PostMapping(&quot;/login&quot;) public String login(User user, Map&lt;String, Object&gt; map) { User userByEmail = userService.getUserByEmail(user.getEmail()); if (userByEmail != null &amp;&amp; userByEmail.getPassword().equals(user.getPassword())) { session.setAttribute(&quot;loginUser&quot;, userByEmail); logger.info(&quot;ç™»å½•æˆåŠŸï¼&quot;+userByEmail); return &quot;redirect:/index&quot;; }else{ User user1 = userService.getUserByEmail(user.getEmail()); String errorMsg = user1 == null ? &quot;è¯¥é‚®ç®±å°šæœªæ³¨å†Œ&quot; : &quot;å¯†ç é”™è¯¯&quot;; logger.info(&quot;ç™»å½•å¤±è´¥ï¼è¯·ç¡®è®¤é‚®ç®±å’Œå¯†ç æ˜¯å¦æ­£ç¡®ï¼&quot;); //ç™»å½•å¤±è´¥ï¼Œå°†å¤±è´¥ä¿¡æ¯è¿”å›å‰ç«¯æ¸²æŸ“ map.put(&quot;errorMsg&quot;, errorMsg); return &quot;index&quot;; } 2. æ–‡ä»¶æ“ä½œ2.1 æ–‡ä»¶ä¸Šä¼ 2.1.1 easyUploader.js å·¥å…·GitHub åœ°å€ https://github.com/funnyque/easyUpload.js ç”¨æ³• å‚ç…§GitHub ä»“åº“README.md &lt;!DOCTYPE html&gt; &lt;html lang=&quot;en&quot; xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt; &lt;meta http-equiv=&quot;X-UA-Compatible&quot; content=&quot;ie=edge&quot;&gt; &lt;title&gt;ç¤ºä¾‹&lt;/title&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;css/upload-file.css&quot;&gt; &lt;style&gt; html * { margin: 0; padding: 0; } &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=&quot;uploader&quot;&gt;&lt;/div&gt; &lt;script src=&quot;js/easyUploader.jq.js&quot;&gt;&lt;/script&gt; &lt;script&gt; var uploader = easyUploader({ id: &quot;uploader&quot;, accept: &#39;&#39;,//ä»»ä½•æ ¼å¼æ–‡ä»¶éƒ½æ”¯æŒ action: &#39;uploadFile&#39;, dataFormat: &#39;formData&#39;, headers:{ id:0 //è¿™é‡Œæ˜¯å†™çš„requestçš„headerså‚æ•°ï¼Œåç«¯å¯ä»¥è·å–è¿™ä¸ªæ•°æ® }, maxCount: 10, maxSize: 1024, multiple: true, data: null, beforeUpload: function(file, data, args) { /* dataFormatä¸ºformDataæ—¶é…ç½®å‘é€æ•°æ®çš„æ–¹å¼ */ data.append(&#39;token&#39;, &#39;387126b0-7b3e-4a2a-86ad-ae5c5edd0ae6TT&#39;); data.append(&#39;otherKey&#39;, &#39;otherValue&#39;); /* dataFormatä¸ºbase64æ—¶é…ç½®å‘é€æ•°æ®çš„æ–¹å¼ */ // data.base = file.base; // data.token = &#39;387126b0-7b3e-4a2a-86ad-ae5c5edd0ae6TT&#39;; // data.otherKey = &#39;otherValue&#39;; }, onChange: function(fileList) { /* inputé€‰ä¸­æ—¶è§¦å‘ */ document.body.onbeforeunload = function() { window.event.returnValue = &quot;ç¡®è®¤ç¦»å¼€ï¼Ÿ&quot;; } }, onRemove: function(removedFiles, files) { console.log(&#39;onRemove&#39;, removedFiles); }, onSuccess: function(res) { var code = res[&quot;code&quot;]; console.log(code); if (code == 499){ alert(&quot;å¯èƒ½å› ä¸ºä½ çš„è¿è§„æ“ä½œï¼Œæ‚¨æš‚æ—¶æ— æ³•ä¸Šä¼ æ–‡ä»¶ï¼&quot;); } if (code == 501){ alert(&quot;å½“å‰ç›®å½•å­˜åœ¨åŒåæ–‡ä»¶ï¼Œè¯·åˆ é™¤åå†è¯•ï¼&quot;); } if (code == 502){ alert(&quot;æ–‡ä»¶åä¸ç¬¦åˆè§„èŒƒï¼Œæ”¯æŒã€æ±‰å­—,å­—ç¬¦,æ•°å­—,ä¸‹åˆ’çº¿,è‹±æ–‡å¥å·,æ¨ªçº¿ã€‘&quot;); } if (code == 503){ alert(&quot;ä»“åº“å®¹é‡ä¸è¶³ï¼Œä¸Šä¼ å¤±è´¥ï¼&quot;); } if (code == 504){ alert(&quot;æœåŠ¡å™¨å‡ºé”™äº†ï¼&quot;); } document.body.onbeforeunload = function () { window.event.returnValue = &quot;ç¡®è®¤ç¦»å¼€ï¼Ÿ&quot;; } }, onError: function(err) { console.log(&#39;onError&#39;, err); }, }); &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; 2.1.2 åç«¯æ¥æ”¶æ•°æ® @PostMapping(&quot;/uploadFile&quot;) @ResponseBody public Map&lt;String, Object&gt; uploadFile(@RequestParam(&quot;file&quot;) MultipartFile files) { //1. åˆ¤æ–­å½“å‰ç”¨æˆ·çš„æ–‡ä»¶ä»“åº“æƒé™æ˜¯å¦æ»¡è¶³ Map&lt;String, Object&gt; map = new HashMap&lt;&gt;(); if (fileStoreService.getFileStoreByUserId(loginUser.getUserId()).getPermission() != 0){ logger.error(&quot;ç”¨æˆ·æ²¡æœ‰ä¸Šä¼ æ–‡ä»¶çš„æƒé™!ä¸Šä¼ å¤±è´¥...&quot;); map.put(&quot;code&quot;, 499); return map; } //2. åˆ¤æ–­å½“å‰ä¸Šä¼ æ–‡ä»¶å¤¹æ˜¯å¦æœ‰åŒåæ–‡ä»¶ FileStore store = fileStoreService.getFileStoreByUserId(loginUser.getUserId()); //å‰ç«¯ä¼ è¿‡æ¥çš„folderId Integer folderId = Integer.valueOf(request.getHeader(&quot;id&quot;)); //file.getOriginalFilename()æ˜¯ä¸Šä¼ æ—¶çš„æ–‡ä»¶å String name = files.getOriginalFilename().replaceAll(&quot; &quot;,&quot;&quot;); //è·å–å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œç”¨æ¥åˆ¤æ–­æ˜¯å¦å·²ç»å­˜åœ¨ List&lt;MyFile&gt; myFiles = null; if (folderId == 0){ //å½“å‰ç›®å½•ä¸ºæ ¹ç›®å½• myFiles = myFileService.getRootFilesByFileStoreId(loginUser.getFileStoreId()); }else { //å½“å‰ç›®å½•ä¸ºå…¶ä»–ç›®å½• myFiles = myFileService.getFilesByParentFolderId(folderId); } for (int i = 0; i &lt; myFiles.size(); i++) { if ((myFiles.get(i).getMyFileName()+myFiles.get(i).getPostfix()).equals(name)){ logger.error(&quot;å½“å‰æ–‡ä»¶å·²å­˜åœ¨!ä¸Šä¼ å¤±è´¥...&quot;); map.put(&quot;code&quot;, 501); return map; } } //3. æ£€æŸ¥æ–‡ä»¶åå¹¶å®šä¹‰å­˜å‚¨è·¯å¾„ SimpleDateFormat format = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;); String dateStr = format.format(new Date()); // userId/date/folderId String path = loginUser.getUserId()+&quot;/&quot;+dateStr +&quot;/&quot;+folderId; if (!checkTarget(name)){ logger.error(&quot;ä¸Šä¼ å¤±è´¥!æ–‡ä»¶åä¸ç¬¦åˆè§„èŒƒ...&quot;); map.put(&quot;code&quot;, 502); return map; } //4. æ£€æŸ¥ä»“åº“size //toIntExact()æ–¹æ³•ä»æŒ‡å®šçš„longå‚æ•°è¿”å›intå€¼ Integer sizeInt = Math.toIntExact(files.getSize() / 1024); //æ˜¯å¦ä»“åº“æ”¾ä¸ä¸‹è¯¥æ–‡ä»¶ if(store.getCurrentSize()+sizeInt &gt; store.getMaxSize()){ logger.error(&quot;ä¸Šä¼ å¤±è´¥!ä»“åº“å·²æ»¡ã€‚&quot;); map.put(&quot;code&quot;, 503); return map; } //5. æ–‡ä»¶ä¿¡æ¯æ•´ç†(åå­—ï¼Œç±»å‹ï¼Œå¤§å°) //å¤„ç†æ–‡ä»¶å¤§å° String size = String.valueOf(files.getSize()/1024.0); int indexDot = size.lastIndexOf(&quot;.&quot;); size = size.substring(0,indexDot); int index = name.lastIndexOf(&quot;.&quot;); String tempName = name; String postfix = &quot;&quot;; int type = 4; if (index!=-1){ tempName = name.substring(index); name = name.substring(0,index); //è·å¾—æ–‡ä»¶ç±»å‹ type = getType(tempName.toLowerCase()); postfix = tempName.toLowerCase(); } //6. æäº¤åˆ°æ–‡ä»¶FTPæœåŠ¡å™¨ try { //æäº¤åˆ°FTPæœåŠ¡å™¨ boolean b = FtpUtil.uploadFile(&quot;/&quot;+path, name + postfix, files.getInputStream()); if (b){ //ä¸Šä¼ æˆåŠŸ logger.info(&quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸ!&quot;+files.getOriginalFilename()); //å‘æ•°æ®åº“æ–‡ä»¶è¡¨å†™å…¥æ•°æ® myFileService.addFileByFileStoreId( MyFile.builder() .myFileName(name).fileStoreId(loginUser.getFileStoreId()).myFilePath(path) .downloadTime(0).uploadTime(new Date()).parentFolderId(folderId). size(Integer.valueOf(size)).type(type).postfix(postfix).build()); //æ›´æ–°ä»“åº“è¡¨çš„å½“å‰å¤§å° fileStoreService.addSize(store.getFileStoreId(),Integer.valueOf(size)); try { //ä¸æ‡‚ä¸ºä½•è¦ç¡5s Thread.sleep(5000); map.put(&quot;code&quot;, 200); } catch (InterruptedException e) { e.printStackTrace(); } }else{ logger.error(&quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥!&quot;+files.getOriginalFilename()); map.put(&quot;code&quot;, 504); } } catch (IOException e) { e.printStackTrace(); } return map; } 2.2 æ–‡ä»¶ä¸‹è½½é€šè¿‡å‰ç«¯ä¼ è¿‡æ¥çš„æ–‡ä»¶idå»æŸ¥è¯¢æ–‡ä»¶ä¿¡æ¯ï¼Œå†é€šè¿‡ftpä¸‹è½½ @GetMapping(&quot;/downloadFile&quot;) public String downloadFile(@RequestParam Integer fId){ if (fileStoreService.getFileStoreByUserId(loginUser.getUserId()).getPermission() == 2){ logger.error(&quot;ç”¨æˆ·æ²¡æœ‰ä¸‹è½½æ–‡ä»¶çš„æƒé™!ä¸‹è½½å¤±è´¥...&quot;); return &quot;redirect:/error401Page&quot;; } //è·å–æ–‡ä»¶ä¿¡æ¯ MyFile myFile = myFileService.getFileByFileId(fId); String remotePath = myFile.getMyFilePath(); String fileName = myFile.getMyFileName()+myFile.getPostfix(); try { //å»FTPä¸Šæ‹‰å– OutputStream os = new BufferedOutputStream(response.getOutputStream()); response.setCharacterEncoding(&quot;utf-8&quot;); // è®¾ç½®è¿”å›ç±»å‹ response.setContentType(&quot;multipart/form-data&quot;); // æ–‡ä»¶åè½¬ç ä¸€ä¸‹ï¼Œä¸ç„¶ä¼šå‡ºç°ä¸­æ–‡ä¹±ç //Content-Dispositionå®¢æˆ·ç«¯çš„å¼¹å‡ºå¯¹è¯æ¡†ï¼Œå¯¹åº”çš„æ–‡ä»¶å (ä¸­æ–‡å­—ç¬¦éœ€è¦è½¬ä¸€ä¸‹ç¼–ç ) response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment;fileName=&quot; + URLEncoder.encode(fileName, &quot;UTF-8&quot;)); boolean flag = FtpUtil.downloadFile(&quot;/&quot; + remotePath, fileName, os); if (flag) { myFileService.updateFile( MyFile.builder().myFileId(myFile.getMyFileId()).downloadTime(myFile.getDownloadTime() + 1).build()); os.flush(); os.close(); logger.info(&quot;æ–‡ä»¶ä¸‹è½½æˆåŠŸ!&quot; + myFile); } } catch (Exception e) { logger.info(&quot;yukinoæ–‡ä»¶ä¸‹è½½å¤±è´¥!&quot; + myFile); e.printStackTrace(); } return &quot;success&quot;; } public static boolean downloadFile(String remotePath, String fileName, OutputStream outputStream) { boolean result = false; //add by yukino remotePath = BASEPATH + remotePath; try { remotePath = new String(remotePath.getBytes(&quot;GBK&quot;),&quot;iso-8859-1&quot;); fileName = new String(fileName.getBytes(&quot;GBK&quot;),&quot;iso-8859-1&quot;); //åˆå§‹åŒ–FTPå®¢æˆ·ç«¯ if (!initFtpClient()){ return result; }; // è½¬ç§»åˆ°FTPæœåŠ¡å™¨ç›®å½• //ftp.changeWorkingDirectory(remotePath); ftp.changeWorkingDirectory(remotePath); ftp.enterLocalPassiveMode(); FTPFile[] fs = ftp.listFiles(); for (FTPFile ff : fs) { if (ff.getName().equals(fileName)) { ftp.enterLocalPassiveMode(); ftp.retrieveFile(remotePath+&quot;/&quot;+fileName,outputStream); result = true; } } ftp.logout(); } catch (IOException e) { e.printStackTrace(); } finally { if (ftp.isConnected()) { try { ftp.disconnect(); } catch (IOException ioe) { } } } return result; } 2.3 åˆ é™¤æ–‡ä»¶ @GetMapping(&quot;/deleteFile&quot;) public String deleteFile(@RequestParam Integer fId,Integer folder){ //è·å¾—æ–‡ä»¶ä¿¡æ¯ MyFile myFile = myFileService.getFileByFileId(fId); String remotePath = myFile.getMyFilePath(); String fileName = myFile.getMyFileName()+myFile.getPostfix(); //ä»FTPæ–‡ä»¶æœåŠ¡å™¨ä¸Šåˆ é™¤æ–‡ä»¶ boolean b = FtpUtil.deleteFile(&quot;/&quot;+remotePath, fileName); if (b){ //åˆ é™¤æˆåŠŸ,è¿”å›ç©ºé—´ fileStoreService.subSize(myFile.getFileStoreId(),Integer.valueOf(myFile.getSize())); //åˆ é™¤æ–‡ä»¶è¡¨å¯¹åº”çš„æ•°æ® myFileService.deleteByFileId(fId); } logger.info(&quot;åˆ é™¤æ–‡ä»¶æˆåŠŸ!&quot;+myFile); return &quot;redirect:/files?fId=&quot;+folder; } public static boolean deleteFile( String remotePath,String fileName){ boolean flag = false; remotePath = BASEPATH + remotePath; try { remotePath = new String(remotePath.getBytes(&quot;GBK&quot;),&quot;iso-8859-1&quot;); fileName = new String(fileName.getBytes(&quot;GBK&quot;),&quot;iso-8859-1&quot;); if (!initFtpClient()){ return flag; }; // è½¬ç§»åˆ°FTPæœåŠ¡å™¨ç›®å½• ftp.changeWorkingDirectory(remotePath); ftp.enterLocalPassiveMode(); FTPFile[] fs = ftp.listFiles(); for (FTPFile ff : fs) { if (&quot;&quot;.equals(fileName)){ return flag; } if (ff.getName().equals(fileName)){ String filePath = remotePath + &quot;/&quot; +fileName; ftp.deleteFile(filePath); flag = true; } } ftp.logout(); } catch (IOException e) { e.printStackTrace(); } finally { if (ftp.isConnected()) { try { ftp.disconnect(); } catch (IOException ioe) { } } } return flag; } 2.4 é‡å‘½åæ–‡ä»¶ @PostMapping(&quot;/updateFileName&quot;) public String updateFileName(MyFile file,Map&lt;String, Object&gt; map) { MyFile myFile = myFileService.getFileByFileId(file.getMyFileId()); if (myFile != null){ String oldName = myFile.getMyFileName(); String newName = file.getMyFileName(); if (!oldName.equals(newName)){ boolean b = FtpUtil.reNameFile(myFile.getMyFilePath() + &quot;/&quot; + oldName+myFile.getPostfix(), myFile.getMyFilePath() + &quot;/&quot; + newName+myFile.getPostfix()); if (b){ Integer integer = myFileService.updateFile( MyFile.builder().myFileId(myFile.getMyFileId()).myFileName(newName).build()); if (integer == 1){ logger.info(&quot;ä¿®æ”¹æ–‡ä»¶åæˆåŠŸ!åŸæ–‡ä»¶å:&quot;+oldName+&quot; æ–°æ–‡ä»¶å:&quot;+newName); }else{ logger.error(&quot;ä¿®æ”¹æ–‡ä»¶åå¤±è´¥!åŸæ–‡ä»¶å:&quot;+oldName+&quot; æ–°æ–‡ä»¶å:&quot;+newName); } } } } return &quot;redirect:/files?fId=&quot;+myFile.getParentFolderId(); } public static boolean reNameFile( String oldAllName,String newAllName){ boolean flag = false; try { oldAllName = new String(oldAllName.getBytes(&quot;GBK&quot;),&quot;iso-8859-1&quot;); newAllName = new String(newAllName.getBytes(&quot;GBK&quot;),&quot;iso-8859-1&quot;); if (!initFtpClient()){ return flag; }; ftp.enterLocalPassiveMode(); ftp.rename(oldAllName,newAllName); flag = true; ftp.logout(); } catch (IOException e) { e.printStackTrace(); } finally { if (ftp.isConnected()) { try { ftp.disconnect(); } catch (IOException ioe) { } } } return flag; } } 2.5 ç”ŸæˆäºŒç»´ç  @GetMapping(&quot;getQrCode&quot;) @ResponseBody public Map&lt;String,Object&gt; getQrCode(@RequestParam Integer id,@RequestParam String url){ Map&lt;String,Object&gt; map = new HashMap&lt;&gt;(); map.put(&quot;imgPath&quot;,&quot;https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=2654852821,3851565636&amp;fm=26&amp;gp=0.jpg&quot;); if (id != null){ MyFile file = myFileService.getFileByFileId(id); if (file != null){ try { //getRealPathæ˜¯éƒ¨ç½²åˆ°TomcatæœåŠ¡å™¨ä¸Šçš„é¡¹ç›®æ–‡ä»¶å¤¹ä¸‹çš„è·¯å¾„ï¼Œä¸æ˜¯æºä»£ç çš„è·¯å¾„,æ˜¯è™šæ‹Ÿè·¯å¾„ï¼Œä½†æ˜¯ä¾ç„¶å¯ä»¥è®¿é—® //private/var/folders/6p/73llqwqx1_xg39j8pm5fjd9m0000gn/T/tomcat-docbase.145091729584971266.8080/user_img/ String path = request.getSession().getServletContext().getRealPath(&quot;/user_img/&quot;); url = url+&quot;/file/share?t=&quot;+ UUID.randomUUID().toString().substring(0,10) +&quot;&amp;f=&quot;+file.getMyFileId()+&quot;&amp;p=&quot;+file.getUploadTime().getTime()+&quot;&quot;+file.getSize()+&quot;&amp;flag=1&quot;; File targetFile = new File(path, &quot;&quot;); if (!targetFile.exists()) { targetFile.mkdirs(); } File f = new File(path, id + &quot;.jpg&quot;); if (!f.exists()){ //æ–‡ä»¶ä¸å­˜åœ¨,å¼€å§‹ç”ŸæˆäºŒç»´ç å¹¶ä¿å­˜æ–‡ä»¶ OutputStream os = new FileOutputStream(f); QRCodeUtil.encode(url, &quot;/static/img/logo.png&quot;, os, true); os.close(); } map.put(&quot;imgPath&quot;,&quot;user_img/&quot;+id+&quot;.jpg&quot;); map.put(&quot;url&quot;,url); } catch (Exception e) { e.printStackTrace(); } } } return map; } 2.6 åˆ†äº«æ–‡ä»¶ @GetMapping(&quot;/file/share&quot;) public String shareFile(Integer f,String p,String t,Integer flag){ String fileNameTemp = &quot;&quot;; String remotePath = &quot;&quot;; String fileName = &quot;&quot;; Integer times = 0; if (flag == null || f == null || p == null || t == null){ logger.info(&quot;ä¸‹è½½åˆ†äº«æ–‡ä»¶å¤±è´¥ï¼Œå‚æ•°é”™è¯¯&quot;); return &quot;redirect:/error400Page&quot;; } if(flag == 1){ //è·å–æ–‡ä»¶ä¿¡æ¯ MyFile myFile = myFileService.getFileByFileId(f); if (myFile == null){ return &quot;redirect:/error404Page&quot;; } String pwd = myFile.getUploadTime().getTime()+&quot;&quot;+myFile.getSize(); if (!pwd.equals(p)){ return &quot;redirect:/error400Page&quot;; } remotePath = myFile.getMyFilePath(); fileName = myFile.getMyFileName()+myFile.getPostfix(); }else if(flag == 2){ TempFile tempFile = tempFileService.queryById(f); if (tempFile == null){ return &quot;redirect:/error404Page&quot;; } Long test = tempFile.getUploadTime().getTime(); String pwd = tempFile.getSize(); if (!pwd.equals(p)){ return &quot;redirect:/error400Page&quot;; } remotePath = tempFile.getFilePath(); fileName = tempFile.getFileName(); }else { return &quot;redirect:/error400Page&quot;; } fileNameTemp = fileName; try { //è§£å†³ä¸‹è½½æ–‡ä»¶æ—¶ ä¸­æ–‡æ–‡ä»¶åä¹±ç é—®é¢˜ boolean isMSIE = isMSBrowser(request); if (isMSIE) { //IEæµè§ˆå™¨çš„ä¹±ç é—®é¢˜è§£å†³ fileNameTemp = URLEncoder.encode(fileNameTemp, &quot;UTF-8&quot;); } else { //ä¸‡èƒ½ä¹±ç é—®é¢˜è§£å†³ fileNameTemp = new String(fileNameTemp.getBytes(&quot;UTF-8&quot;), &quot;ISO-8859-1&quot;); } //å»FTPä¸Šæ‹‰å– OutputStream os = new BufferedOutputStream(response.getOutputStream()); response.setCharacterEncoding(&quot;utf-8&quot;); // è®¾ç½®è¿”å›ç±»å‹ response.setContentType(&quot;multipart/form-data&quot;); // æ–‡ä»¶åè½¬ç ä¸€ä¸‹ï¼Œä¸ç„¶ä¼šå‡ºç°ä¸­æ–‡ä¹±ç  response.setHeader(&quot;Content-Disposition&quot;, &quot;attachment;fileName=&quot; + fileNameTemp); if (FtpUtil.downloadFile(&quot;/&quot; + remotePath, fileName, os)) { myFileService.updateFile( MyFile.builder().myFileId(f).downloadTime(times + 1).build()); os.flush(); os.close(); logger.info(&quot;æ–‡ä»¶ä¸‹è½½æˆåŠŸ!&quot;); } } catch (Exception e) { e.printStackTrace(); } return &quot;success&quot;; } 3. æ–‡ä»¶å¤¹æ“ä½œ3.1 æ–‡ä»¶å¤¹é‡å‘½å @PostMapping(&quot;/updateFolder&quot;) public String updateFolder(FileFolder folder,Map&lt;String, Object&gt; map) { //è·å¾—æ–‡ä»¶å¤¹çš„æ•°æ®åº“ä¿¡æ¯ FileFolder fileFolder = fileFolderService.getFileFolderByFileFolderId(folder.getFileFolderId()); fileFolder.setFileFolderName(folder.getFileFolderName()); //è·å¾—å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å¤¹,ç”¨äºæ£€æŸ¥æ–‡ä»¶å¤¹æ˜¯å¦å·²ç»å­˜åœ¨ List&lt;FileFolder&gt; fileFolders = fileFolderService.getFileFolderByParentFolderId(fileFolder.getParentFolderId()); for (int i = 0; i &lt; fileFolders.size(); i++) { FileFolder folder1 = fileFolders.get(i); if (folder1.getFileFolderName().equals(folder.getFileFolderName()) &amp;&amp; folder1.getFileFolderId() != folder.getFileFolderId()){ logger.info(&quot;é‡å‘½åæ–‡ä»¶å¤¹å¤±è´¥!æ–‡ä»¶å¤¹å·²å­˜åœ¨...&quot;); return &quot;redirect:/files?error=2&amp;fId=&quot;+fileFolder.getParentFolderId(); } } //å‘æ•°æ®åº“å†™å…¥æ•°æ® Integer integer = fileFolderService.updateFileFolderById(fileFolder); logger.info(&quot;é‡å‘½åæ–‡ä»¶å¤¹æˆåŠŸ!&quot;+folder); return &quot;redirect:/files?fId=&quot;+fileFolder.getParentFolderId(); } 3.2 æ¸…ç©ºå¹¶åˆ é™¤æ–‡ä»¶å¤¹ public void deleteFolderF(FileFolder folder){ //è·å¾—å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰å­æ–‡ä»¶å¤¹ List&lt;FileFolder&gt; folders = fileFolderService.getFileFolderByParentFolderId(folder.getFileFolderId()); //åˆ é™¤å½“å‰æ–‡ä»¶å¤¹çš„æ‰€æœ‰çš„æ–‡ä»¶ List&lt;MyFile&gt; files = myFileService.getFilesByParentFolderId(folder.getFileFolderId()); if (files.size()!=0){ for (int i = 0; i &lt; files.size(); i++) { Integer fileId = files.get(i).getMyFileId(); boolean b = FtpUtil.deleteFile(&quot;/&quot;+files.get(i).getMyFilePath(), files.get(i).getMyFileName() + files.get(i).getPostfix()); if (b){ myFileService.deleteByFileId(fileId); fileStoreService.subSize(folder.getFileStoreId(),Integer.valueOf(files.get(i).getSize())); } } } if (folders.size()!=0){ for (int i = 0; i &lt; folders.size(); i++) { deleteFolderF(folders.get(i)); } } fileFolderService.deleteFileFolderById(folder.getFileFolderId()); } 3.3 æ·»åŠ æ–‡ä»¶å¤¹ @PostMapping(&quot;/addFolder&quot;) public String addFolder(FileFolder folder,Map&lt;String, Object&gt; map) { //è®¾ç½®æ–‡ä»¶å¤¹ä¿¡æ¯ folder.setFileStoreId(loginUser.getFileStoreId()); folder.setTime(new Date()); //è·å¾—å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å¤¹,æ£€æŸ¥å½“å‰æ–‡ä»¶å¤¹æ˜¯å¦å·²ç»å­˜åœ¨ List&lt;FileFolder&gt; fileFolders = null; if (folder.getParentFolderId() == 0){ //å‘ç”¨æˆ·æ ¹ç›®å½•æ·»åŠ æ–‡ä»¶å¤¹ fileFolders = fileFolderService.getRootFoldersByFileStoreId(loginUser.getFileStoreId()); }else{ //å‘ç”¨æˆ·çš„å…¶ä»–ç›®å½•æ·»åŠ æ–‡ä»¶å¤¹ fileFolders = fileFolderService.getFileFolderByParentFolderId(folder.getParentFolderId()); } for (int i = 0; i &lt; fileFolders.size(); i++) { FileFolder fileFolder = fileFolders.get(i); if (fileFolder.getFileFolderName().equals(folder.getFileFolderName())){ logger.info(&quot;æ·»åŠ æ–‡ä»¶å¤¹å¤±è´¥!æ–‡ä»¶å¤¹å·²å­˜åœ¨...&quot;); return &quot;redirect:/files?error=1&amp;fId=&quot;+folder.getParentFolderId(); } } //å‘æ•°æ®åº“å†™å…¥æ•°æ® Integer integer = fileFolderService.addFileFolder(folder); logger.info(&quot;æ·»åŠ æ–‡ä»¶å¤¹æˆåŠŸ!&quot;+folder); return &quot;redirect:/files?fId=&quot;+folder.getParentFolderId(); } 4. ç®¡ç†å‘˜æ“ä½œ4.1 å‰å¾€ç”¨æˆ·ç®¡ç†ç•Œé¢ @GetMapping(&quot;/manages-users&quot;) public String manageUsers(Map&lt;String,Object&gt; map,Integer cur){ if (loginUser.getRole() == 1){ //ç”¨äºæ— è®¿é—®æƒé™ logger.error(&quot;å½“å‰ç™»å½•ç”¨æˆ·ï¼š&quot;+loginUser.getUserName()+&quot;æ— ç®¡ç†å‘˜æƒé™ï¼&quot;); return &quot;redirect:/error401Page&quot;; } //è·å–å…¨éƒ¨çš„ç”¨æˆ· Integer usersCount = userService.getUsersCount(); //è·å–å½“å‰æŸ¥è¯¢çš„é¡µæ•°ï¼Œå¦‚æœä¸ºç©ºï¼Œé»˜è®¤ä¸º0 cur = (cur == null || cur&lt;0)?0:cur; //è·å¾—ç»Ÿè®¡ä¿¡æ¯ FileStoreStatistics statistics = myFileService.getCountStatistics(loginUser.getFileStoreId()); //åˆ†é¡µè·å¾—20ä¸ªç”¨æˆ·ä¿¡æ¯ Page&lt;Object&gt; page = PageHelper.startPage(cur, 20); List&lt;UserToShow&gt; users = userService.getUsers(); map.put(&quot;statistics&quot;, statistics); map.put(&quot;users&quot;, users); map.put(&quot;page&quot;, page); map.put(&quot;usersCount&quot;, usersCount); logger.info(&quot;ç”¨æˆ·ç®¡ç†åŸŸçš„å†…å®¹ï¼š&quot;+map); return &quot;admin/manage-users&quot;; } 4.2 ä¿®æ”¹ç”¨æˆ·çš„æƒé™å’Œæœ€å¤§å®¹é‡ @GetMapping(&quot;/updateStoreInfo&quot;) @ResponseBody public String updateStoreInfo(Integer uId,Integer pre,Integer size){ Integer integer = fileStoreService.updatePermission(uId, pre, size*1024); if (integer == 1) { //æ›´æ–°æˆåŠŸï¼Œè¿”å›200çŠ¶æ€ç  logger.info(&quot;ä¿®æ”¹ç”¨æˆ·&quot;+userService.queryById(uId).getUserName()+&quot;ï¼šçš„æƒé™å’Œä»“åº“å¤§å°æˆåŠŸï¼&quot;); return &quot;200&quot;; }else { //æ›´æ–°å¤±è´¥ï¼Œè¿”å›500çŠ¶æ€ç  logger.error(&quot;ä¿®æ”¹ç”¨æˆ·&quot;+userService.queryById(uId).getUserName()+&quot;ï¼šçš„æƒé™å’Œä»“åº“å¤§å°å¤±è´¥ï¼&quot;); return &quot;500&quot;; } } 4.3 åˆ é™¤ç”¨æˆ· @GetMapping(&quot;/deleteUser&quot;) public String deleteUser(Integer uId,Integer cur){ cur = (cur == null || cur &lt; 0)?1:cur; User user = userService.queryById(uId); FileStore fileStore = fileStoreService.getFileStoreByUserId(uId); List&lt;FileFolder&gt; folders = fileFolderService.getRootFoldersByFileStoreId(fileStore.getFileStoreId()); //è¿­ä»£åˆ é™¤æ–‡ä»¶å¤¹ for (FileFolder f:folders) { deleteFolderF(f); } List&lt;MyFile&gt; files = myFileService.getRootFilesByFileStoreId(fileStore.getFileStoreId()); //åˆ é™¤è¯¥ç”¨æˆ·ä»“åº“æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ for (MyFile f:files) { String remotePath = f.getMyFilePath(); String fileName = f.getMyFileName()+f.getPostfix(); //ä»FTPæ–‡ä»¶æœåŠ¡å™¨ä¸Šåˆ é™¤æ–‡ä»¶ boolean b = FtpUtil.deleteFile(&quot;/&quot;+remotePath, fileName); if (b){ //åˆ é™¤æˆåŠŸ,è¿”å›ç©ºé—´ fileStoreService.subSize(f.getFileStoreId(),Integer.valueOf(f.getSize())); //åˆ é™¤æ–‡ä»¶è¡¨å¯¹åº”çš„æ•°æ® myFileService.deleteByFileId(f.getMyFileId()); } logger.info(&quot;åˆ é™¤æ–‡ä»¶æˆåŠŸ!&quot;+f); } if (FtpUtil.deleteFolder(&quot;/&quot; + uId)){ logger.info(&quot;æ¸…ç©ºFTPä¸Šè¯¥ç”¨æˆ·çš„æ–‡ä»¶æˆåŠŸ&quot;); }else { logger.error(&quot;æ¸…ç©ºFTPä¸Šè¯¥ç”¨æˆ·çš„æ–‡ä»¶å¤±è´¥&quot;); } userService.deleteById(uId); fileStoreService.deleteById(fileStore.getFileStoreId()); return &quot;redirect:/manages-users?cur=&quot;+cur; } public void deleteFolderF(FileFolder folder){ //è·å¾—å½“å‰æ–‡ä»¶å¤¹ä¸‹çš„æ‰€æœ‰å­æ–‡ä»¶å¤¹ List&lt;FileFolder&gt; folders = fileFolderService.getFileFolderByParentFolderId(folder.getFileFolderId()); //åˆ é™¤å½“å‰æ–‡ä»¶å¤¹çš„æ‰€æœ‰çš„æ–‡ä»¶ List&lt;MyFile&gt; files = myFileService.getFilesByParentFolderId(folder.getFileFolderId()); if (files.size()!=0){ for (int i = 0; i &lt; files.size(); i++) { Integer fileId = files.get(i).getMyFileId(); boolean b = FtpUtil.deleteFile(&quot;/&quot;+files.get(i).getMyFilePath(), files.get(i).getMyFileName() + files.get(i).getPostfix()); if (b){ myFileService.deleteByFileId(fileId); fileStoreService.subSize(folder.getFileStoreId(),Integer.valueOf(files.get(i).getSize())); } } } if (folders.size()!=0){ for (int i = 0; i &lt; folders.size(); i++) { deleteFolderF(folders.get(i)); } } fileFolderService.deleteFileFolderById(folder.getFileFolderId()); } } 6. å…¶ä»–é€šç”¨é…ç½®6.1 æ³¨å†Œè§†å›¾æ§åˆ¶å™¨@Configuration public class MvcConfig implements WebMvcConfigurer { @Override public void addViewControllers(ViewControllerRegistry registry) { registry.addViewController(&quot;/&quot;).setViewName(&quot;index&quot;); registry.addViewController(&quot;/temp-file&quot;).setViewName(&quot;temp-file&quot;); registry.addViewController(&quot;/error400Page&quot;).setViewName(&quot;error/400&quot;); registry.addViewController(&quot;/error401Page&quot;).setViewName(&quot;error/401&quot;); registry.addViewController(&quot;/error404Page&quot;).setViewName(&quot;error/404&quot;); registry.addViewController(&quot;/error500Page&quot;).setViewName(&quot;error/500&quot;); } } 6.2 æ³¨å†Œç™»å½•æ‹¦æˆªå™¨public class LoginHandlerInterceptor implements HandlerInterceptor { /** * åœ¨ç›®æ ‡æ–¹å¼æ‰§è¡Œä¹‹å‰æ‰§è¡Œ * @param request * @param response * @param handler * @return * @throws Exception */ @Override public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { Object loginUser = request.getSession().getAttribute(&quot;loginUser&quot;); if (loginUser==null){ //æœªç™»å½•,è¿”å›ç™»å½•é¡µé¢ response.sendRedirect(&quot;/moti-cloud/&quot;); return false; }else { //å·²ç™»å½•,æ”¾è¡Œ return true; } } } @Configuration public class MvcConfig implements WebMvcConfigurer { @Override public void addInterceptors(InterceptorRegistry registry) { registry.addInterceptor(new LoginHandlerInterceptor()).addPathPatterns(&quot;/**&quot;) .excludePathPatterns( &quot;/&quot;,&quot;/temp-file&quot;,&quot;/error400Page&quot;,&quot;/error401Page&quot;,&quot;/error404Page&quot;,&quot;/error500Page&quot;,&quot;/uploadTempFile&quot;,&quot;/admin&quot;,&quot;/sendCode&quot;,&quot;/loginByQQ&quot;,&quot;/login&quot;,&quot;/register&quot;,&quot;/file/share&quot;,&quot;/connection&quot;, &quot;/asserts/**&quot;,&quot;/**/*.css&quot;, &quot;/**/*.js&quot;, &quot;/**/*.png &quot;, &quot;/**/*.jpg&quot; ,&quot;/**/*.jpeg&quot;,&quot;/**/*.gif&quot;, &quot;/**/fonts/*&quot;, &quot;/**/*.svg&quot;); } } 6.3 é…ç½®é”™è¯¯ç•Œé¢@Configuration public class MvcConfig implements ErrorPageRegistrar{ @Override public void registerErrorPages(ErrorPageRegistry registry) { ErrorPage error400Page = new ErrorPage(HttpStatus.BAD_REQUEST, &quot;/error400Page&quot;); ErrorPage error401Page = new ErrorPage(HttpStatus.UNAUTHORIZED, &quot;/error401Page&quot;); ErrorPage error404Page = new ErrorPage(HttpStatus.NOT_FOUND, &quot;/error404Page&quot;); ErrorPage error500Page = new ErrorPage(HttpStatus.INTERNAL_SERVER_ERROR, &quot;/error500Page&quot;); registry.addErrorPages(error400Page,error401Page,error404Page,error500Page); } } 6.4 é…ç½®ä¸Šä¼ æœ€å¤§æ–‡ä»¶@Configuration public class MvcConfig implements WebMvcConfigurer, ErrorPageRegistrar { @Bean public MultipartConfigElement multipartConfigElement() { MultipartConfigFactory factory = new MultipartConfigFactory(); //æ–‡ä»¶æœ€å¤§ factory.setMaxFileSize(DataSize.parse(&quot;1024000KB&quot;)); /// è®¾ç½®æ€»ä¸Šä¼ æ•°æ®æ€»å¤§å° factory.setMaxRequestSize(DataSize.parse(&quot;1024000KB&quot;)); return factory.createMultipartConfig(); } } //åº”è¯¥ä¸Šé¢çš„è®¾ç½®å¯¹MultipartFileç”Ÿæ•ˆ public Map&lt;String, Object&gt; uploadFile(@RequestParam(&quot;file&quot;) MultipartFile files)","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"cloud","slug":"cloud","permalink":"/tags/cloud/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"ubuntuæ­å»ºFTPæœåŠ¡å™¨","slug":"æŠ€æœ¯/FTPæœåŠ¡å™¨","date":"2021-01-18T17:20:00.000Z","updated":"2022-10-09T15:19:10.433Z","comments":true,"path":"2021/01/19/æŠ€æœ¯/FTPæœåŠ¡å™¨/","link":"","permalink":"/2021/01/19/æŠ€æœ¯/FTPæœåŠ¡å™¨/","excerpt":"","text":"Ubuntu å®‰è£… VSFTPD å®ç° FTPåŠŸèƒ½ å®‰è£…VSFTPD sudo apt-get install vsftpd service vsftpd start # å¯åŠ¨vsftpdæœåŠ¡ æ–°å»ºç”¨æˆ·uftpï¼Œå¹¶è®¾ç½®å¯†ç  sudo adduser userftp #ä¹‹åçš„ç™»å½•ç”¨æˆ·å°±æ˜¯è¿™ä¸ªäº† # è¾“å…¥å¯¹åº”å†…å®¹ Retype new UNIX password: passwd: password updated successfully Changing the user information for userftp Enter the new value, or press ENTER for the default Full Name []: userftp Room Number []: 1 Work Phone []: 1 Home Phone []: 1 Other []: 1 Is the information correct? [Y/n] y yukino@yukino:/home$ æ³¨æ„ï¼šä¹‹åuserftpä½œä¸ºè´¦æˆ·ï¼Œè¾“å…¥çš„å¯†ç ä½œä¸ºç™»å½•å¯†ç ã€‚/home/userftp å·²åˆ›å»ºå¥½ ä¿®æ”¹é…ç½®æ–‡ä»¶ sudo vim /etc/vsftpd.conf # åŠ å…¥ä»¥ä¸‹ä»£ç  userlist_deny=NO userlist_enable=YES userlist_file=/etc/allowed_users seccomp_sandbox=NO local_root=/home/userftp/ local_enable=YES write_enable=YES utf8_filesystem=YES åˆ›å»ºå…è®¸è®¿é—®çš„ç”¨æˆ·åˆ—è¡¨ sudo vim /etc/allowed_users # åŠ å…¥ä»¥ä¸‹ä»£ç  userftp æ£€æŸ¥ç¦æ­¢è®¿é—®åå• sudo vim /etc/ftpusers é‡å¯æœåŠ¡å™¨ sudo /etc/init.d/vsftpd restart è®¿é—®ftp ftp://192.168.245.130 æ³¨: ftp é»˜è®¤ç«¯å£ 21","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"FTP","slug":"FTP","permalink":"/tags/FTP/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"ç é—®ç¤¾åŒºçŸ¥è¯†ç‚¹æ‹†è§£(2)","slug":"æŠ€æœ¯/ç é—®ç¤¾åŒºçŸ¥è¯†ç‚¹æ‹†è§£ - 2","date":"2021-01-17T17:00:00.000Z","updated":"2022-10-09T15:19:10.437Z","comments":true,"path":"2021/01/18/æŠ€æœ¯/ç é—®ç¤¾åŒºçŸ¥è¯†ç‚¹æ‹†è§£ - 2/","link":"","permalink":"/2021/01/18/æŠ€æœ¯/ç é—®ç¤¾åŒºçŸ¥è¯†ç‚¹æ‹†è§£ - 2/","excerpt":"","text":"1.Bootstrap èµ·æ­¥ Site: https://v3.bootcss.com/getting-started/ ä¸‹è½½é™æ€èµ„æºæ–‡ä»¶ å¯¼å…¥åˆ°ideaé¡¹ç›® htmlå¯¼å…¥é™æ€èµ„æº &lt;!DOCTYPE HTML&gt; &lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt; &lt;head&gt; &lt;title&gt;ç åŒ ç¤¾åŒº&lt;/title&gt; &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;css/bootstrap.min.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;css/bootstrap-theme.min.css&quot;&gt; &lt;script src=&quot;js/bootstrap.min.js&quot; type=&quot;application/javascript&quot;&gt;&lt;/script&gt; &lt;/head&gt; å¼•å…¥å¯¼èˆªæ ä»£ç  https://v3.bootcss.com/components/#navbar-default &lt;body&gt; &lt;nav class=&quot;navbar navbar-default&quot;&gt; &lt;div class=&quot;container-fluid&quot;&gt; &lt;!-- Brand and toggle get grouped for better mobile display --&gt; &lt;div class=&quot;navbar-header&quot;&gt; &lt;button type=&quot;button&quot; class=&quot;navbar-toggle collapsed&quot; data-toggle=&quot;collapse&quot; data-target=&quot;#bs-example-navbar-collapse-1&quot; aria-expanded=&quot;false&quot;&gt; &lt;span class=&quot;sr-only&quot;&gt;ç åŒ ç¤¾åŒº&lt;/span&gt; &lt;/button&gt; &lt;a class=&quot;navbar-brand&quot; href=&quot;#&quot;&gt;ç åŒ ç¤¾åŒº&lt;/a&gt; &lt;/div&gt; &lt;!-- Collect the nav links, forms, and other content for toggling --&gt; &lt;div class=&quot;collapse navbar-collapse&quot; id=&quot;bs-example-navbar-collapse-1&quot;&gt; &lt;form class=&quot;navbar-form navbar-left&quot;&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;input type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;æœç´¢é—®é¢˜&quot;&gt; &lt;/div&gt; &lt;button type=&quot;submit&quot; class=&quot;btn btn-default&quot;&gt;Submit&lt;/button&gt; &lt;/form&gt; &lt;ul class=&quot;nav navbar-nav navbar-right&quot;&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;ç™»å½•&lt;/a&gt;&lt;/li&gt; &lt;li class=&quot;dropdown&quot;&gt; &lt;a href=&quot;#&quot; class=&quot;dropdown-toggle&quot; data-toggle=&quot;dropdown&quot; role=&quot;button&quot; aria-haspopup=&quot;true&quot; aria-expanded=&quot;false&quot;&gt;æˆ‘ &lt;span class=&quot;caret&quot;&gt;&lt;/span&gt;&lt;/a&gt; &lt;ul class=&quot;dropdown-menu&quot;&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;æ¶ˆæ¯ä¸­å¿ƒ&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;ä¸ªäººèµ„æ–™&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;é€€å‡ºç™»ç™»å½•&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;!-- /.navbar-collapse --&gt; &lt;/div&gt;&lt;!-- /.container-fluid --&gt; &lt;/nav&gt; &lt;/body&gt; 2. GitHub ä¸‰æ–¹ç™»å½•2.0 åŸç† 2.1 è¿›å…¥Githubå¼€å‘è€… githubé¦–é¡µ å¤´åƒ Setting Developer settings OAnth Apps New OAuth App Authorization callback URL æ æ˜¯æœ€é‡è¦çš„ï¼Œè¿™æ˜¯githubä¹‹åï¼Œé€šè¿‡æ­¤åœ°å€æ¥æ”¶githubè¿”å›çš„ä¿¡æ¯ åˆ›å»ºå®Œæˆ åœ¨OAuth Appåˆ›å»ºå®Œæˆåï¼Œéœ€è¦è®°ä½Client IDå’ŒClient secrets, è¿™æ˜¯ä¸github äº¤äº’çš„ä¾æ® 2.2 æ ¹æ®github api æ¥å£è·å–æ•°æ®Github OAuth Document 2.2.1 Users are redirected to request their GitHub identity&lt;a href=&quot;https://github.com/login/oauth/authorize?client_id=bffae17dcea7490afcb6&amp;redirect_uri=http://localhost:8887/callback&amp;scope=user&amp;state=1&quot;&gt;ç™»å½•&lt;/a&gt; 2.2.2 Users are redirected back to your site by GitHub é€šè¿‡OkHttpå‘é€POST GETè¯·æ±‚ okHttp &lt;!--okhttp--&gt; &lt;dependency&gt; &lt;groupId&gt;com.squareup.okhttp3&lt;/groupId&gt; &lt;artifactId&gt;okhttp&lt;/artifactId&gt; &lt;version&gt;4.5.0&lt;/version&gt; &lt;/dependency&gt; &lt;!--fastjson--&gt; &lt;dependency&gt; &lt;groupId&gt;com.alibaba&lt;/groupId&gt; &lt;artifactId&gt;fastjson&lt;/artifactId&gt; &lt;version&gt;1.2.75&lt;/version&gt; &lt;/dependency&gt; ä¾‹å­ å‘é€POSTè¯·æ±‚åˆ°github api public String getAccessToken(AccessTokenDTO accessTokenDTO) { MediaType mediaType = MediaType.get(&quot;application/json; charset=utf-8&quot;); OkHttpClient client = new OkHttpClient(); RequestBody body = RequestBody.create(JSON.toJSONString(accessTokenDTO), mediaType); Request request = new Request.Builder() .url(&quot;https://github.com/login/oauth/access_token&quot;) .post(body) .build(); try (Response response = client.newCall(request).execute()) { String string = response.body().string(); String token = string.split(&quot;&amp;&quot;)[0].split(&quot;=&quot;)[1]; return token; } catch (Exception e) { log.error(&quot;getAccessToken error,{}&quot;, accessTokenDTO, e); } return null; } 2.2.3 Use the access token to access the API public GithubUser getUser(String accessToken) { OkHttpClient client = new OkHttpClient(); // Request request = new Request.Builder() // .url(&quot;https://api.github.com/user?access_token=&quot; + accessToken) // .build(); Request request = new Request.Builder() .url(&quot;https://api.github.com/user&quot;) .header(&quot;Authorization&quot;,&quot;token &quot;+accessToken) .build(); try { Response response = client.newCall(request).execute(); String string = response.body().string(); System.out.println(string); GithubUser githubUser = JSON.parseObject(string, GithubUser.class); return githubUser; } catch (Exception e) { log.error(&quot;getUser error,{}&quot;, accessToken, e); } return null; } æ³¨æ„!!!! ä»£ç ä¸­æ³¨é‡Šæ‰çš„ä¸‰è¡Œï¼Œæ˜¯ä»¥å‰(2019å¹´ä¸Š)å°†Tokenä½œä¸ºåœ°å€å‚æ•°å¸¦å…¥çš„ã€‚ç°åœ¨å·²ç»ä¸é‡‡ç”¨ï¼Œè€Œæ˜¯å°†å‚æ•°ä½œä¸ºè¯·æ±‚å¤´å‚æ•°å¸¦å…¥ã€‚æˆ‘æŠ˜è…¾äº†å¾ˆä¹…æ‰å‘ç° 2.2.4 å®Œæˆè·å–userä¿¡æ¯@Controller public class AuthorizeController { @Resource private GithubProvider githubProvider; @Value(&quot;${github.client.id}&quot;) private String clientId; @Value(&quot;${github.client.secret}&quot;) private String clientSecret; @Value(&quot;${github.redirect.uri}&quot;) private String redirectUri; @GetMapping(&quot;/callback&quot;) public String callback(@RequestParam(name = &quot;code&quot;) String code, @RequestParam(name = &quot;state&quot;) String state, HttpServletResponse response) { AccessTokenDTO accessTokenDTO = new AccessTokenDTO(); accessTokenDTO.setClient_id(clientId); accessTokenDTO.setClient_secret(clientSecret); accessTokenDTO.setCode(code); accessTokenDTO.setRedirect_uri(redirectUri); accessTokenDTO.setState(state); String accessToken = githubProvider.getAccessToken(accessTokenDTO); GithubUser githubUser = githubProvider.getUser(accessToken); System.out.println(&quot;yukino===&quot; + githubUser); return &quot;index&quot;; } } 3. æ•´åˆmybatis3.1 ä¾èµ– &lt;!-- mybatis --&gt; &lt;dependency&gt; &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt; &lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;2.1.4&lt;/version&gt; &lt;/dependency&gt; &lt;!--jdbc--&gt; &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt; &lt;/dependency&gt; &lt;!--mysql--&gt; &lt;dependency&gt; &lt;groupId&gt;mysql&lt;/groupId&gt; &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt; &lt;scope&gt;runtime&lt;/scope&gt; &lt;/dependency&gt; 3.2 model(entity)@Data public class User { private Integer id; private String name; private String accountId; private String token; private Long gmtCreate; private Long gmtModified; } 3.3 mapper@Mapper public interface UserMapper { @Insert(&quot;insert into user(name, account_id, token, gmt_create, gmt_modified) values(#{name}, #{accountId}, #{token}, #{gmtCreate}, #{gmtModified}) &quot;) public void insert(User user); @Select(&quot;select * from user where token=#{token}&quot;) User findByToken(@Param(&quot;token&quot;) String token); } 3.4 controller@Controller public class IndexController { @Resource private UserMapper userMapper; @GetMapping(&quot;/&quot;) public String index(HttpServletRequest request) { Cookie[] cookies = request.getCookies(); if (cookies == null ) { return &quot;index&quot;; } for (Cookie cookie : cookies) { if (cookie.getName().equals(&quot;token&quot;)) { String token = cookie.getValue(); User user = userMapper.findByToken(token); if (user != null) { request.getSession().setAttribute(&quot;user&quot;, user); } break; } } return &quot;index&quot;; } } @Controller public class AuthorizeController { @Resource private GithubProvider githubProvider; @Value(&quot;${github.client.id}&quot;) private String clientId; @Value(&quot;${github.client.secret}&quot;) private String clientSecret; @Value(&quot;${github.redirect.uri}&quot;) private String redirectUri; @Resource UserMapper userMapper; @GetMapping(&quot;/callback&quot;) public String callback(@RequestParam(name = &quot;code&quot;) String code, @RequestParam(name = &quot;state&quot;) String state, HttpServletRequest request, HttpServletResponse response) { AccessTokenDTO accessTokenDTO = new AccessTokenDTO(); accessTokenDTO.setClient_id(clientId); accessTokenDTO.setClient_secret(clientSecret); accessTokenDTO.setCode(code); accessTokenDTO.setRedirect_uri(redirectUri); accessTokenDTO.setState(state); String accessToken = githubProvider.getAccessToken(accessTokenDTO); GithubUser githubUser = githubProvider.getUser(accessToken); if (githubUser != null) { User user = new User(); String token = UUID.randomUUID().toString(); user.setToken(token); user.setName(githubUser.getName()); user.setAccountId(String.valueOf(githubUser.getId())); user.setGmtCreate(System.currentTimeMillis()); user.setGmtModified(user.getGmtCreate()); userMapper.insert(user); response.addCookie(new Cookie(&quot;token&quot;, token)); request.getSession().setAttribute(&quot;user&quot;, githubUser); return &quot;redirect:/&quot;; } else { return &quot;redirect:/&quot;; } } } 4. åˆ©ç”¨BootStrap æ­å»ºå‰ç«¯ç•Œé¢4.1 æ …æ ¼ç³»ç»Ÿæ …æ ¼ç³»ç»Ÿ Bootstrap æä¾›äº†ä¸€å¥—å“åº”å¼ã€ç§»åŠ¨è®¾å¤‡ä¼˜å…ˆçš„æµå¼æ …æ ¼ç³»ç»Ÿï¼Œéšç€å±å¹•æˆ–è§†å£ï¼ˆviewportï¼‰å°ºå¯¸çš„å¢åŠ ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åˆ†ä¸ºæœ€å¤š12åˆ—ã€‚ è¶…å°å±å¹• æ‰‹æœº (&lt;768px) å°å±å¹• å¹³æ¿ (â‰¥768px) ä¸­ç­‰å±å¹• æ¡Œé¢æ˜¾ç¤ºå™¨ (â‰¥992px) å¤§å±å¹• å¤§æ¡Œé¢æ˜¾ç¤ºå™¨ (â‰¥1200px) æ …æ ¼ç³»ç»Ÿè¡Œä¸º æ€»æ˜¯æ°´å¹³æ’åˆ— å¼€å§‹æ˜¯å †å åœ¨ä¸€èµ·çš„ï¼Œå½“å¤§äºè¿™äº›é˜ˆå€¼æ—¶å°†å˜ä¸ºæ°´å¹³æ’åˆ—C .container æœ€å¤§å®½åº¦ None ï¼ˆè‡ªåŠ¨ï¼‰ 750px 970px 1170px ç±»å‰ç¼€ .col-xs- .col-sm- .col-md- .col-lg- åˆ—ï¼ˆcolumnï¼‰æ•° 12 æœ€å¤§åˆ—ï¼ˆcolumnï¼‰å®½ è‡ªåŠ¨ ~62px ~81px ~97px æ§½ï¼ˆgutterï¼‰å®½ 30px ï¼ˆæ¯åˆ—å·¦å³å‡æœ‰ 15pxï¼‰ å¯åµŒå¥— æ˜¯ åç§»ï¼ˆOffsetsï¼‰ æ˜¯ åˆ—æ’åº æ˜¯ &lt;div class=&quot;col-lg-9 col-md-12 col-sm-12 col-xs-12&quot;&gt; &lt;/div&gt; å¤§å±å¹• å¤§æ¡Œé¢æ˜¾ç¤ºå™¨ (â‰¥1200px) : col-lg-9 å ç”¨çª—å£9æ ¼ ä¸­ç­‰å±å¹• æ¡Œé¢æ˜¾ç¤ºå™¨ (â‰¥992px) : col-md-12 å ç”¨çª—å£12æ ¼ (å³å…¨éƒ¨) å°å±å¹• å¹³æ¿ (â‰¥768px) : col-md-12 å ç”¨çª—å£12æ ¼ (å³å…¨éƒ¨) è¶…å°å±å¹• æ‰‹æœº (&lt;768px) : col-md-12 å ç”¨çª—å£12æ ¼ (å³å…¨éƒ¨) 4.2 ç»„ä»¶ç»„ä»¶ 4.3 å…¨å±€æ ·å¼å…¨å±€æ ·å¼ 4.4 ä¸¾ä¾‹&lt;!DOCTYPE HTML&gt; &lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt; &lt;head&gt; &lt;title&gt;ç åŒ ç¤¾åŒº&lt;/title&gt; &lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;css/bootstrap.min.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;css/bootstrap-theme.min.css&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;css/community.css&quot;&gt; &lt;script src=&quot;js/bootstrap.min.js&quot; type=&quot;application/javascript&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;nav class=&quot;navbar navbar-default&quot;&gt; &lt;div class=&quot;container-fluid&quot;&gt; &lt;!-- Brand and toggle get grouped for better mobile display --&gt; &lt;div class=&quot;navbar-header&quot;&gt; &lt;button type=&quot;button&quot; class=&quot;navbar-toggle collapsed&quot; data-toggle=&quot;collapse&quot; data-target=&quot;#bs-example-navbar-collapse-1&quot; aria-expanded=&quot;false&quot;&gt; &lt;span class=&quot;sr-only&quot;&gt;ç åŒ ç¤¾åŒº&lt;/span&gt; &lt;/button&gt; &lt;a class=&quot;navbar-brand&quot; href=&quot;#&quot;&gt;ç åŒ ç¤¾åŒº&lt;/a&gt; &lt;/div&gt; &lt;!-- Collect the nav links, forms, and other content for toggling --&gt; &lt;div class=&quot;collapse navbar-collapse&quot; id=&quot;bs-example-navbar-collapse-1&quot;&gt; &lt;form class=&quot;navbar-form navbar-left&quot;&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;input type=&quot;text&quot; class=&quot;form-control&quot; placeholder=&quot;æœç´¢é—®é¢˜&quot;&gt; &lt;/div&gt; &lt;button type=&quot;submit&quot; class=&quot;btn btn-default&quot;&gt;Submit&lt;/button&gt; &lt;/form&gt; &lt;ul class=&quot;nav navbar-nav navbar-right&quot;&gt; &lt;li th:if=&quot;${session.user == null}&quot;&gt; &lt;a href=&quot;https://github.com/login/oauth/authorize?client_id=bffae17dcea7490afcb6&amp;redirect_uri=http://localhost:8887/callback&amp;scope=user&amp;state=1&quot;&gt;ç™»å½•&lt;/a&gt; &lt;/li&gt; &lt;li class=&quot;dropdown&quot; th:if=&quot;${session.user != null}&quot;&gt; &lt;a href=&quot;#&quot; class=&quot;dropdown-toggle&quot; data-toggle=&quot;dropdown&quot; role=&quot;button&quot; aria-haspopup=&quot;true&quot; aria-expanded=&quot;false&quot;&gt; &lt;span th:text=&quot;${session.user.getName()}&quot;&gt;&lt;/span&gt; &lt;span class=&quot;caret&quot;&gt;&lt;/span&gt; &lt;/a&gt; &lt;ul class=&quot;dropdown-menu&quot;&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;æ¶ˆæ¯ä¸­å¿ƒ&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;ä¸ªäººèµ„æ–™&lt;/a&gt;&lt;/li&gt; &lt;li&gt;&lt;a href=&quot;#&quot;&gt;é€€å‡ºç™»ç™»å½•&lt;/a&gt;&lt;/li&gt; &lt;/ul&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt;&lt;!-- /.navbar-collapse --&gt; &lt;/div&gt;&lt;!-- /.container-fluid --&gt; &lt;/nav&gt; &lt;div class=&quot;container-fluid main&quot;&gt; &lt;div class=&quot;row&quot;&gt; &lt;div class=&quot;col-lg-9 col-md-12 col-sm-12 col-xs-12&quot;&gt; &lt;h2&gt;&lt;span class=&quot;glyphicon glyphicon-align-left&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt;å‘èµ·&lt;/h2&gt; &lt;hr&gt; &lt;form action=&quot;&quot;&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label for=&quot;title&quot;&gt;é—®é¢˜æ ‡é¢˜(ç®€æ˜æ‰¼è¦)ï¼š&lt;/label&gt; &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;title&quot; name=&quot;title&quot; placeholder=&quot;é—®é¢˜æ ‡é¢˜.....&quot;&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label for=&quot;description&quot;&gt;é—®é¢˜è¡¥å…… (å¿…å¡«ï¼Œè¯·å‚ç…§å³ä¾§æç¤º):&lt;/label&gt; &lt;textarea name=&quot;description&quot; id=&quot;description&quot; class=&quot;form-control&quot; cols=&quot;30&quot; rows=&quot;10&quot;&gt;&lt;/textarea&gt; &lt;/div&gt; &lt;div class=&quot;form-group&quot;&gt; &lt;label for=&quot;title&quot;&gt;æ·»åŠ æ ‡ç­¾ï¼š&lt;/label&gt; &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;tag&quot; name=&quot;tag&quot; placeholder=&quot;è¾“å…¥æ ‡ç­¾ï¼Œä»¥ï¼Œå·éš”å¼€&quot;&gt; &lt;/div&gt; &lt;button type=&quot;submit&quot; class=&quot;btn btn-success btn-publish&quot;&gt;å‘å¸ƒ&lt;/button&gt; &lt;/form&gt; &lt;/div&gt; &lt;div class=&quot;col-lg-3 col-md-12 col-sm-12 col-xs-12&quot;&gt; &lt;h3&gt;é—®é¢˜å‘èµ·æŒ‡å—&lt;/h3&gt; â€¢ é—®é¢˜æ ‡é¢˜: è¯·ç”¨ç²¾ç®€çš„è¯­è¨€æè¿°æ‚¨å‘å¸ƒçš„é—®é¢˜ï¼Œä¸è¶…è¿‡25å­— &lt;br&gt; â€¢ é—®é¢˜è¡¥å……: è¯¦ç»†è¡¥å……æ‚¨çš„é—®é¢˜å†…å®¹ï¼Œå¹¶ç¡®ä¿é—®é¢˜æè¿°æ¸…æ™°ç›´è§‚, å¹¶æä¾›ä¸€äº›ç›¸å…³çš„èµ„æ–™&lt;br&gt; â€¢ é€‰æ‹©æ ‡ç­¾: é€‰æ‹©ä¸€ä¸ªæˆ–è€…å¤šä¸ªåˆé€‚çš„æ ‡ç­¾ï¼Œç”¨é€—å·éš”å¼€ï¼Œæ¯ä¸ªæ ‡ç­¾ä¸è¶…è¿‡10ä¸ªå­—&lt;br&gt; &lt;/div&gt; &lt;/div&gt; &lt;/div&gt; &lt;/body&gt; &lt;/html&gt; 5. åˆ†é¡µ5.1 ç›´æ¥å®ç°åˆ†é¡µ5.1.1 å®ä½“ç±»@Data public class PaginationDTO { private List&lt;QuestionDTO&gt; questions;//æ–‡ç«  private boolean showPrevious;//ä¸Šä¸€é¡µ private boolean showFirstPage;//é¦–é¡µ private boolean showNext;//ä¸‹ä¸€é¡µ private boolean showEndPage;//å°¾é¡µ private Integer page;//å½“å‰é¡µ private List&lt;Integer&gt; pages = new ArrayList&lt;&gt;();//å½“å‰åˆ†é¡µæ æ˜¾ç¤ºçš„é¡µç é›†åˆ private Integer totalPage;// /** * * @param totalCount é—®é¢˜æ€»æ•° * @param page åœ°å€æ çš„å½“å‰é¡µæ•° * @param size æ¯ä¸€é¡µçš„é—®é¢˜æ•°é‡ */ public void setPagination(Integer totalCount, Integer page, Integer size) { totalPage = (totalCount % size == 0) ? (totalCount / size) : (totalCount / size + 1); if (page &lt; 1) { page = 1; } if (page &gt; totalPage) { page = totalPage; } this.page = page; //è®¡ç®—å½“å‰é¡µçš„åˆ†é¡µæ æ˜¾ç¤ºçš„é¡µç é›†åˆ pages.add(page); for (int i = 1;i &lt;= 3; i++) { if (page - i &gt; 0) { pages.add(0, page - i); } if (page + i &lt;= totalPage) { pages.add(page + i); } } //æ˜¯å¦å±•ç¤ºä¸Šä¸€é¡µæ ‡ç­¾ if (page == 1) { showFirstPage = false; } else { showFirstPage = true; } //æ˜¯å¦å±•ç¤ºä¸‹ä¸€é¡µæ ‡ç­¾ if (page == totalPage) { showEndPage = false; } else { showEndPage = true; } //æ˜¯å¦å±•ç¤ºé¦–é¡µç®­å¤´ï¼Œåªè¦æ²¡åŒ…å«ç¬¬ä¸€é¡µï¼Œå°±æ˜¾ç¤ºé¦–é¡µæ ‡ç­¾ if (pages.contains(1)) { showFirstPage = false; } else { showFirstPage = true; } //æ˜¯å¦å±•ç¤ºå°¾é¡µç®­å¤´ if (pages.contains(totalPage)) { showEndPage = false; } else { showEndPage = true; } } } 5.1.2 mapperç±»@Mapper public interface QuestionMapper { @Insert(&quot;insert into question(title, description, gmt_create, gmt_modified, creator, tag) values (#{title}, #{description},#{gmtCreate}, #{gmtModified}, #{creator}, #{tag})&quot;) public void create(Question question); //åˆ†é¡µæŸ¥è¯¢ @Select(&quot;select * from question limit #{offset}, #{size}&quot;) List&lt;Question&gt; list(@Param(&quot;offset&quot;) Integer offset, @Param(&quot;size&quot;) Integer size); //questionæŸ¥è¯¢ @Select(&quot;select count(1) from question&quot;) Integer count(); } 5.1.3 Serviceç±»@Service public class QuestionService { @Resource QuestionMapper questionMapper; @Resource UserMapper userMapper; public PaginationDTO list(Integer page, Integer size) { PaginationDTO paginationDTO = new PaginationDTO(); Integer totalCount = questionMapper.count();//é—®é¢˜æ€»æ•° paginationDTO.setPagination(totalCount, page, size); if (page &lt; 1) { page = 1; } if (page &gt; paginationDTO.getTotalPage()) { page = paginationDTO.getTotalPage(); } //offset = size * (page - 1) Integer offset = size * (page - 1); List&lt;Question&gt; questions = questionMapper.list(offset, size); List&lt;QuestionDTO&gt; questionDTOS = new ArrayList&lt;&gt;(); for (Question question : questions ) { User user = userMapper.findById(question.getCreator()); QuestionDTO questionDTO = new QuestionDTO(); //æ‹·è´å±æ€§ //å·§å¦™ä¸ä½¿ç”¨å¤–é”®çš„æ–¹æ³• BeanUtils.copyProperties(question, questionDTO); questionDTO.setUser(user); questionDTOS.add(questionDTO); } paginationDTO.setQuestions(questionDTOS); return paginationDTO; } } @Data public class QuestionDTO { private Integer id; private String title; private String description; private String tag; private Long gmtCreate; private Long gmtModified; private Integer creator; private Integer viewCount; private Integer commentCount; private Integer likeCount; private User user; } 5.1.4 Controller @Resource private QuestionService questionService; @GetMapping(&quot;/&quot;) public String index(HttpServletRequest request, Model model, @RequestParam(name = &quot;page&quot;, defaultValue = &quot;1&quot;) Integer page, @RequestParam(name = &quot;size&quot;, defaultValue = &quot;2&quot;) Integer size) { Cookie[] cookies = request.getCookies(); if (cookies == null ) { return &quot;index&quot;; } for (Cookie cookie : cookies) { if (cookie.getName().equals(&quot;token&quot;)) { String token = cookie.getValue(); User user = userMapper.findByToken(token); if (user != null) { request.getSession().setAttribute(&quot;user&quot;, user); } break; } } PaginationDTO pagination = questionService.list(page, size); System.out.println(pagination.toString()); //model.addAttribute(&quot;questions&quot;, questionList); model.addAttribute(&quot;pagination&quot;, pagination); return &quot;index&quot;; } } 5.1.5 html &lt;div class=&quot;col-lg-9 col-md-12 col-sm-12 col-xs-12&quot;&gt; &lt;h2&gt;&lt;span class=&quot;glyphicon glyphicon-list-alt&quot; aria-hidden=&quot;true&quot;&gt;&lt;/span&gt;å‘èµ·&lt;/h2&gt; &lt;hr&gt; &lt;div class=&quot;media&quot; th:each=&quot;question : ${pagination.getQuestions()}&quot;}&gt; &lt;div class=&quot;media-left&quot;&gt; &lt;a href=&quot;#&quot;&gt; &lt;img class=&quot;media-object img-rounded&quot; src=&quot;/img/2.jpg&quot; width=&quot;43px&quot; height=&quot;43px&quot; alt=&quot;...&quot;&gt; &lt;/a&gt; &lt;/div&gt; &lt;div class=&quot;media-body&quot;&gt; &lt;h4 class=&quot;media-heading&quot; th:text=&quot;${question.getTitle()}&quot;&gt;&lt;/h4&gt; &lt;span th:text=&quot;${question.getDescription()}&quot;&gt;&lt;/span&gt; &lt;br&gt; &lt;span text-desc&gt;&lt;span th:text=&quot;${question.getCommentCount()}&quot;&gt;&lt;/span&gt;ä¸ªå›å¤ &lt;span th:text=&quot;${question.getViewCount()}&quot;&gt;&lt;/span&gt;31 æ¬¡æµè§ˆ &lt;span th:text=&quot;${#dates.format(question.getGmtCreate(), &#39;dd MMM yyyy&#39;)}&quot;&gt;&lt;/span&gt;&lt;/span&gt; &lt;/div&gt; &lt;/div&gt; &lt;nav aria-label=&quot;Page navigation&quot;&gt; &lt;ul class=&quot;pagination&quot;&gt; &lt;div th:text=&quot;yukino+${pagination.isShowFirstPage()}&quot;&gt;&lt;/div&gt; &lt;li th:if=&quot;${pagination.isShowFirstPage()}&quot;&gt; &lt;a href=&quot;/?page=1&quot; aria-label=&quot;Previous&quot;&gt; &lt;span aria-hidden=&quot;true&quot;&gt;&amp;lt;&amp;lt;&lt;/span&gt; &lt;/a&gt; &lt;/li&gt; &lt;li th:if=&quot;${pagination.isShowPrevious()}&quot;&gt; &lt;a href=&quot;@{/(page=${pagination.page - 1})}&quot; aria-label=&quot;Previous&quot;&gt; &lt;span aria-hidden=&quot;true&quot;&gt;&amp;lt;&lt;/span&gt; &lt;/a&gt; &lt;/li&gt; &lt;li th:each=&quot;page : ${pagination.getPages()}&quot; th:class=&quot;${pagination.getPage() == page} ? &#39;active&#39; : &#39;&#39;&quot;&gt; &lt;a th:href=&quot;@{/(page=${page})}&quot; th:text=&quot;${page}&quot; &gt; &lt;/a&gt; &lt;/li&gt; &lt;li th:if=&quot;${pagination.isShowNext()}&quot;&gt; &lt;a href=&quot;@{/(page=${pagination.page + 1})}&quot; aria-label=&quot;Previous&quot;&gt; &lt;span aria-hidden=&quot;true&quot;&gt;&amp;gt;&amp;gt;&lt;/span&gt; &lt;/a&gt; &lt;/li&gt; &lt;li th:if=&quot;${pagination.isShowEndPage()}&quot;&gt; &lt;a href=&quot;@{/(page=${pagination.getTotalPage()})}&quot; aria-label=&quot;Previous&quot;&gt; &lt;span aria-hidden=&quot;true&quot;&gt;&amp;gt;&lt;/span&gt; &lt;/a&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/nav&gt; &lt;/div&gt; 5.2 pageHelper åˆ†é¡µ5.2.1 åˆ†é¡µå¤±æ•ˆ1pageHelperç‰ˆæœ¬ä½å¯¼è‡´ pageInfo æ•°æ®ä¸å‡†ç¡® &lt;!--pageHelper--&gt; &lt;dependency&gt; &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt; &lt;artifactId&gt;pagehelper-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.3.0&lt;/version&gt; &lt;/dependency&gt; å½“æ—¶ 1.2.0 ä¼šå¤±æ•ˆï¼Œ1.3.0 æ­£å¸¸ 5.2.2 åˆ†é¡µå¤±æ•ˆ2pageHelperé€»è¾‘å¤æ‚å¯¼è‡´ pageInfo æ•°æ®ä¸å‡†ç¡® @GetMapping(&quot;/&quot;) public String index(HttpServletRequest request, Model model, @RequestParam(name = &quot;pageNum&quot;, defaultValue = &quot;1&quot;) Integer pageNum, @RequestParam(name = &quot;pageSize&quot;, defaultValue = &quot;5&quot;) Integer pageSize) { Cookie[] cookies = request.getCookies(); if (cookies == null ) { return &quot;index&quot;; } for (Cookie cookie : cookies) { if (cookie.getName().equals(&quot;token&quot;)) { String token = cookie.getValue(); User user = userMapper.findByToken(token); if (user != null) { request.getSession().setAttribute(&quot;user&quot;, user); } break; } } PageHelper.startPage(1,5); /*è¿™ç§å†™æ³•æœ‰é—®é¢˜*/ List&lt;QuestionDTO&gt; list = questionService.selectQuestions(); PageInfo pageInfo = PageInfo.of(list); model.addAttribute(&quot;pagination&quot;, pageInfo); return &quot;index&quot;; } @Service public class QuestionService { @Resource QuestionMapper questionMapper; @Resource UserMapper userMapper; //è·å–æ‰€æœ‰çš„é—®é¢˜ï¼Œæ·»åŠ äº†Userç±»å¯¹è±¡ public List&lt;QuestionDTO&gt; selectQuestions() { List&lt;QuestionDTO&gt; questionDTOS = new ArrayList&lt;&gt;(); List&lt;Question&gt; questions = questionMapper.selectAllQuestions(); for (Question question : questions) { QuestionDTO questionDTO = new QuestionDTO(); BeanUtils.copyProperties(question, questionDTO); User user = userMapper.findById(question.getCreator()); questionDTO.setUser(user); questionDTOS.add(questionDTO); } return questionDTOS; } } ä»¥ä¸Šè¿™ç§å†™æ³•ï¼ŒæŠŠpageInfoæ”¾åœ¨äº†controllerå±‚ï¼Œserviceå†…æ•°æ®å¤æ‚ï¼Œä½¿sqlæ•°æ®æ²¡æœ‰ç´§æ¥ç€PageHelper.startPage(1,5); è§£å†³æ–¹æ¡ˆæ˜¯ï¼Œå°†pageInfoæ”¾åœ¨serviceå±‚ï¼ŒæŸ¥è¯¢æ•°æ®ç›´æ¥æ¥è‡ªmapperå±‚ï¼Œåœ¨PageHelper.startPage(1,5);å’Œsql`é—´æ— å¤šä½™çš„é€»è¾‘ï¼Œç„¶åå°†pageInfoå°è£…åï¼Œä¼ ç»™controller 5.2.3 ä¸‹æ‹‰èœå•åˆ†é¡µ &lt;!--pageHelper--&gt; &lt;dependency&gt; &lt;groupId&gt;com.github.pagehelper&lt;/groupId&gt; &lt;artifactId&gt;pagehelper-spring-boot-starter&lt;/artifactId&gt; &lt;version&gt;1.3.0&lt;/version&gt; &lt;/dependency&gt; #åˆ†é¡µæ’ä»¶ #pagehelperåˆ†é¡µæ’ä»¶é…ç½® pagehelper.helperDialect=mysql pagehelper.reasonable=true pagehelper.supportMethodsArguments=true pagehelper.params=count=countSql @Service public class QuestionService { @Resource QuestionMapper questionMapper; @Resource UserMapper userMapper; //è·å–æ‰€æœ‰çš„é—®é¢˜ï¼Œæ·»åŠ äº†Userç±»å¯¹è±¡ public Map&lt;String, Object&gt; selectQuestions(Integer pageNum, Integer pageSize) { Map&lt;String, Object&gt; allData = new HashMap(); List&lt;QuestionDTO&gt; questionDTOS = new ArrayList&lt;&gt;(); //è·å–pageInfo PageHelper.startPage(pageNum,pageSize); List&lt;Question&gt; questions = questionMapper.selectAllQuestions(); PageInfo pageInfo = PageInfo.of(questions); //è·å–questionDTO for (Question question : questions) { QuestionDTO questionDTO = new QuestionDTO(); BeanUtils.copyProperties(question, questionDTO); questionDTOS.add(questionDTO); } allData.put(&quot;questionDTOS&quot;, questionDTOS); allData.put(&quot;pageInfo&quot;, pageInfo); return allData; } } @RequestMapping(&quot;/&quot;) public String index(HttpServletRequest request, Model model, @RequestParam(name = &quot;page&quot;, defaultValue = &quot;1&quot;) Integer pageNum, @RequestParam(name = &quot;pageSize&quot;, defaultValue = &quot;5&quot;) Integer pageSize) { Cookie[] cookies = request.getCookies(); if (cookies == null ) { return &quot;index&quot;; } for (Cookie cookie : cookies) { if (cookie.getName().equals(&quot;token&quot;)) { String token = cookie.getValue(); User user = userMapper.findByToken(token); if (user != null) { request.getSession().setAttribute(&quot;user&quot;, user); } break; } } Map&lt;String, Object&gt; allData = questionService.selectQuestions(pageNum, pageSize); List&lt;QuestionDTO&gt; questionDTOS = (List&lt;QuestionDTO&gt;) allData.get(&quot;questionDTOS&quot;); PageInfo pageInfo = (PageInfo) allData.get(&quot;pageInfo&quot;); model.addAttribute(&quot;questionDTOS&quot;, questionDTOS); model.addAttribute(&quot;pageInfo&quot;, pageInfo); return &quot;index1&quot;; } &lt;div class=&quot;media&quot; th:each=&quot;questionDTO : ${questionDTOS}&quot;}&gt; &lt;div class=&quot;media-left&quot;&gt; &lt;a href=&quot;#&quot;&gt; &lt;img class=&quot;media-object img-rounded&quot; src=&quot;/img/2.jpg&quot; width=&quot;43px&quot; height=&quot;43px&quot; alt=&quot;...&quot;&gt; &lt;/a&gt; &lt;/div&gt; &lt;div class=&quot;media-body&quot;&gt; &lt;h4 class=&quot;media-heading&quot; th:text=&quot;${questionDTO.getTitle()}&quot;&gt;&lt;/h4&gt; &lt;span th:text=&quot;${questionDTO.getDescription()}&quot;&gt;&lt;/span&gt; &lt;br&gt; &lt;span text-desc&gt;&lt;span th:text=&quot;${questionDTO.getCommentCount()}&quot;&gt;&lt;/span&gt;ä¸ªå›å¤ &lt;span th:text=&quot;${questionDTO.getViewCount()}&quot;&gt;&lt;/span&gt;31 æ¬¡æµè§ˆ &lt;span th:text=&quot;${#dates.format(questionDTO.getGmtCreate(), &#39;dd MMM yyyy&#39;)}&quot;&gt;&lt;/span&gt;&lt;/span&gt; &lt;/div&gt; &lt;/div&gt; &lt;select class=&quot;poi-pager__item_middle_select poi-form__control form-control&quot; onchange=&quot;location.href=this.value&quot;&gt; &lt;option selected=&quot;&quot; th:selected=&quot;${pageInfo.getPageNum() == index}&quot; th:each=&quot;index : ${#numbers.sequence(1,pageInfo.pages)}&quot; th:value=&quot;@{/(page=${index})}&quot;&gt; ç¬¬ [(${index})] é¡µ &lt;/option&gt; &lt;/select&gt; æ³¨æ„ onchange=&quot;location.href=this.value&quot;æ˜¯è¯»å–optionçš„valueï¼Œç„¶åè·³è½¬ï¼Œåœ¨é‡æ–°åŠ è½½æ•´ä¸ªé¡µé¢ 6. é›†æˆ markdown editor å®˜ç½‘ http://editor.md.ipandao.com/ ç”¨æ³• ä¸‹è½½github æºç  å°†æºç å¯¼å…¥é¡¹ç›® å¦‚å›¾ï¼Œå°†æºç å¯¼å…¥editormdæ–‡ä»¶å¤¹ é¡µé¢å¼•å…¥ &lt;!DOCTYPE html&gt; &lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;link rel=&quot;stylesheet&quot; href=&quot;editormd/css/editormd.css&quot; /&gt; &lt;title&gt;Title&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;div id=&quot;test-editor&quot;&gt; &lt;textarea style=&quot;display:none;&quot;&gt;&lt;/textarea&gt; &lt;/div&gt; &lt;script src=&quot;https://cdn.bootcss.com/jquery/1.11.3/jquery.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;editormd/editormd.min.js&quot;&gt;&lt;/script&gt; &lt;script type=&quot;text/javascript&quot;&gt; $(function() { var editor = editormd(&quot;test-editor&quot;, { width : &quot;100%&quot;, height : &quot;1500px&quot;, path : &quot;editormd/lib/&quot; }); }); &lt;/script&gt; &lt;/body&gt; &lt;/html&gt; æ•ˆæœå›¾","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"å¼€æº","slug":"å¼€æº","permalink":"/tags/å¼€æº/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"ç é—®ç¤¾åŒºæºç è§£æ(1)","slug":"æŠ€æœ¯/ç é—®ç¤¾åŒºæºç è§£æ - 1","date":"2021-01-17T16:00:00.000Z","updated":"2022-10-09T15:19:10.433Z","comments":true,"path":"2021/01/18/æŠ€æœ¯/ç é—®ç¤¾åŒºæºç è§£æ - 1/","link":"","permalink":"/2021/01/18/æŠ€æœ¯/ç é—®ç¤¾åŒºæºç è§£æ - 1/","excerpt":"","text":"1.é—®é¢˜å‘å¸ƒ1.1 å‰ç«¯ç•Œé¢ 1.2 æ–‡ç« å‘å¸ƒ @PostMapping(&quot;/publish&quot;) public String doPublish( @RequestParam(value = &quot;title&quot;, required = false) String title, @RequestParam(value = &quot;description&quot;, required = false) String description, @RequestParam(value = &quot;tag&quot;, required = false) String tag, @RequestParam(value = &quot;id&quot;, required = false) Long id, HttpServletRequest request, Model model) { //ç”¨äºä¸‹é¢&quot;æ ‡é¢˜ä¸èƒ½ä¸ºç©º&quot;ç­‰å¼‚å¸¸çŠ¶æ€æ—¶ï¼Œæ­£å¸¸å†…å®¹çš„å›æ˜¾ model.addAttribute(&quot;title&quot;, title); model.addAttribute(&quot;description&quot;, description); model.addAttribute(&quot;tag&quot;, tag); model.addAttribute(&quot;tags&quot;, TagCache.get()); if (StringUtils.isBlank(title)) { model.addAttribute(&quot;error&quot;, &quot;æ ‡é¢˜ä¸èƒ½ä¸ºç©º&quot;); return &quot;publish&quot;; } if (StringUtils.isBlank(description)) { model.addAttribute(&quot;error&quot;, &quot;é—®é¢˜è¡¥å……ä¸èƒ½ä¸ºç©º&quot;); return &quot;publish&quot;; } if (StringUtils.isBlank(tag)) { model.addAttribute(&quot;error&quot;, &quot;æ ‡ç­¾ä¸èƒ½ä¸ºç©º&quot;); return &quot;publish&quot;; } //è·å–æ— æ•ˆæ ‡ç­¾ String invalid = TagCache.filterInvalid(tag); if (StringUtils.isNotBlank(invalid)) { model.addAttribute(&quot;error&quot;, &quot;è¾“å…¥éæ³•æ ‡ç­¾:&quot; + invalid); return &quot;publish&quot;; } User user = (User) request.getSession().getAttribute(&quot;user&quot;); if (user == null) { model.addAttribute(&quot;error&quot;, &quot;ç”¨æˆ·æœªç™»å½•&quot;); return &quot;publish&quot;; } Question question = new Question(); question.setTitle(title); question.setDescription(description); question.setTag(tag); question.setCreator(user.getId()); question.setId(id); questionService.createOrUpdate(question); return &quot;redirect:/&quot;; } æ³¨æ„ æ–‡ç« æ–°å»ºæ—¶ï¼Œæ¥æ”¶çš„å‚æ•°idä¸ºç©º(tag:mashiro) éœ€è¦å¯¹â€æ ‡é¢˜â€(null)ï¼Œâ€å†…å®¹â€(null)ï¼Œâ€æ ‡ç­¾â€(null or invalid)ï¼Œâ€ç”¨æˆ·â€(login)çš„å¼‚å¸¸çŠ¶æ€è¿›è¡Œå¤„ç†(tag:mashiro) 1.2.1 æ ‡ç­¾ç®¡ç†public class TagCache { public static List&lt;TagDTO&gt; get() { List&lt;TagDTO&gt; tagDTOS = new ArrayList&lt;&gt;(); TagDTO program = new TagDTO(); program.setCategoryName(&quot;å¼€å‘è¯­è¨€&quot;); program.setTags(Arrays.asList(&quot;javascript&quot;, &quot;php&quot;, &quot;css&quot;, &quot;html&quot;, &quot;html5&quot;, &quot;java&quot;, &quot;node.js&quot;, &quot;python&quot;, &quot;c++&quot;, &quot;c&quot;, &quot;golang&quot;, &quot;objective-c&quot;, &quot;typescript&quot;, &quot;shell&quot;, &quot;swift&quot;, &quot;c#&quot;, &quot;sass&quot;, &quot;ruby&quot;, &quot;bash&quot;, &quot;less&quot;, &quot;asp.net&quot;, &quot;lua&quot;, &quot;scala&quot;, &quot;coffeescript&quot;, &quot;actionscript&quot;, &quot;rust&quot;, &quot;erlang&quot;, &quot;perl&quot;)); tagDTOS.add(program); TagDTO framework = new TagDTO(); framework.setCategoryName(&quot;å¹³å°æ¡†æ¶&quot;); framework.setTags(Arrays.asList(&quot;laravel&quot;, &quot;spring&quot;, &quot;express&quot;, &quot;django&quot;, &quot;flask&quot;, &quot;yii&quot;, &quot;ruby-on-rails&quot;, &quot;tornado&quot;, &quot;koa&quot;, &quot;struts&quot;)); tagDTOS.add(framework); TagDTO server = new TagDTO(); server.setCategoryName(&quot;æœåŠ¡å™¨&quot;); server.setTags(Arrays.asList(&quot;linux&quot;, &quot;nginx&quot;, &quot;docker&quot;, &quot;apache&quot;, &quot;ubuntu&quot;, &quot;centos&quot;, &quot;ç¼“å­˜ tomcat&quot;, &quot;è´Ÿè½½å‡è¡¡&quot;, &quot;unix&quot;, &quot;hadoop&quot;, &quot;windows-server&quot;)); tagDTOS.add(server); TagDTO db = new TagDTO(); db.setCategoryName(&quot;æ•°æ®åº“&quot;); db.setTags(Arrays.asList(&quot;mysql&quot;, &quot;redis&quot;, &quot;mongodb&quot;, &quot;sql&quot;, &quot;oracle&quot;, &quot;nosql memcached&quot;, &quot;sqlserver&quot;, &quot;postgresql&quot;, &quot;sqlite&quot;)); tagDTOS.add(db); TagDTO tool = new TagDTO(); tool.setCategoryName(&quot;å¼€å‘å·¥å…·&quot;); tool.setTags(Arrays.asList(&quot;git&quot;, &quot;github&quot;, &quot;visual-studio-code&quot;, &quot;vim&quot;, &quot;sublime-text&quot;, &quot;xcode intellij-idea&quot;, &quot;eclipse&quot;, &quot;maven&quot;, &quot;ide&quot;, &quot;svn&quot;, &quot;visual-studio&quot;, &quot;atom emacs&quot;, &quot;textmate&quot;, &quot;hg&quot;)); tagDTOS.add(tool); return tagDTOS; } public static String filterInvalid(String tags) { String[] split = StringUtils.split(tags, &quot;,&quot;); List&lt;TagDTO&gt; tagDTOS = get(); //è·å–æ‰€æœ‰æ ‡ç­¾ 72ä¸ª List&lt;String&gt; tagList = tagDTOS.stream().flatMap(tag -&gt; tag.getTags().stream()).collect(Collectors.toList()); String invalid = Arrays.stream(split).filter(t -&gt; StringUtils.isBlank(t) || !tagList.contains(t)).collect(Collectors.joining(&quot;,&quot;)); return invalid; } public static void main(String[] args) { int i = (5 - 1) &gt;&gt;&gt; 1; System.out.println(i); } } æ³¨æ„ filterInvalidå‡½æ•°çš„è¡¨è¾¾æ–¹å¼å¯ä»¥é‡ç‚¹æŒæ¡(tag:mashiro) 1.3 æ–‡ç« ä¿®æ”¹æ–‡ç« ä¿®æ”¹ä¸æ–‡ç« æ–°å»ºåŒºåˆ«åœ¨äºï¼Œå‰è€…ä¼šåœ¨formæ ‡ç­¾ä¸­å¢åŠ éšè—åŸŸæ ‡ç­¾ï¼Œåç«¯æ¥å—å‡½æ•°æ˜¯ç›¸åŒçš„ &lt;input type=&quot;hidden&quot; name=&quot;id&quot; value=&quot;6&quot;&gt; public void createOrUpdate(Question question) { if (question.getId() == null) { // åˆ›å»º question.setGmtCreate(System.currentTimeMillis()); question.setGmtModified(question.getGmtCreate()); question.setViewCount(0); question.setLikeCount(0); question.setCommentCount(0); questionMapper.insert(question); } else { // æ›´æ–° Question dbQuestion = questionMapper.selectByPrimaryKey(question.getId()); //åˆ¤æ–­æ˜¯å¦ä¿®æ”¹æ–‡ç« æ˜¯å¦åœ¨æ•°æ®åº“å¯¹åº” if (dbQuestion == null) { throw new CustomizeException(CustomizeErrorCode.QUESTION_NOT_FOUND); } //åˆ¤æ–­ä¿®æ”¹æ“ä½œäººä¸æ–‡ç« åˆ›å»ºäººæ˜¯å¦ä¸€è‡´ if (dbQuestion.getCreator().longValue() != question.getCreator().longValue()) { throw new CustomizeException(CustomizeErrorCode.INVALID_OPERATION); } Question updateQuestion = new Question(); updateQuestion.setGmtModified(System.currentTimeMillis()); updateQuestion.setTitle(question.getTitle()); updateQuestion.setDescription(question.getDescription()); updateQuestion.setTag(question.getTag()); // é€šè¿‡ example è‡ªå®šä¹‰ sqlæ“ä½œ QuestionExample example = new QuestionExample(); example.createCriteria() .andIdEqualTo(question.getId()); int updated = questionMapper.updateByExampleSelective(updateQuestion, example); if (updated != 1) { throw new CustomizeException(CustomizeErrorCode.QUESTION_NOT_FOUND); } } } æ³¨æ„ å¿…é¡»åˆ¤æ–­ä¿®æ”¹æ–‡ç« æ˜¯å¦åœ¨æ•°æ®åº“å†…(tag:mashiro) å¿…é¡»åˆ¤æ–­æ–‡ç« ä¿®æ”¹è€…ä¸æ–‡ç« åˆ›å»ºè€…æ˜¯å¦æ˜¯åŒä¸€äºº(tag:mashiro) 2. å›å¤åŠŸèƒ½2.1 å‰ç«¯ç•Œé¢æ–‡ç« å›å¤(1çº§è¯„è®º) è¯„è®ºå›å¤(2çº§è¯„è®º) 2.2 controller æ¥å— ajaxæ•°æ®ä¼ è¾“ç±»å‹ @Data public class CommentCreateDTO { private Long parentId; private String content; private Integer type; } æ¥å—ajaxæ•°æ®ï¼Œå¹¶å­˜å…¥æ•°æ®åº“ @ResponseBody @RequestMapping(value = &quot;/comment&quot;, method = RequestMethod.POST) //@RequestBodyä¸»è¦ç”¨æ¥æ¥æ”¶å‰ç«¯ä¼ é€’ç»™åç«¯çš„jsonå­—ç¬¦ä¸²ä¸­çš„æ•°æ®çš„(è¯·æ±‚ä½“ä¸­çš„æ•°æ®çš„)ï¼› public Object post(@RequestBody CommentCreateDTO commentCreateDTO, HttpServletRequest request) { User user = (User) request.getSession().getAttribute(&quot;user&quot;); if (user == null) { return ResultDTO.errorOf(CustomizeErrorCode.NO_LOGIN); } //StringUtils.isBlank //1.æ˜¯å¦ä¸ºnull //2.æ˜¯å¦ä¸º&quot;&quot; //3.&quot; &quot;,å­—ç¬¦ä¸²ä¸­é—´æœ‰ç©ºæ ¼ï¼Œåˆ¶è¡¨ç¬¦ã€æ¢è¡Œç¬¦ã€æ¢é¡µç¬¦å’Œå›è½¦ if (commentCreateDTO == null || StringUtils.isBlank(commentCreateDTO.getContent())) { return ResultDTO.errorOf(CustomizeErrorCode.CONTENT_IS_EMPTY); } Comment comment = new Comment(); //æ³¨æ„ï¼š1çº§è¯„è®ºæ—¶ï¼ŒParentIdä¸º question idï¼Œå½“2çº§è¯„è®ºæ—¶ï¼ŒParentId ä¸º ä¸Šä¸€çº§è¯„è®ºId comment.setParentId(commentCreateDTO.getParentId()); comment.setContent(commentCreateDTO.getContent()); comment.setType(commentCreateDTO.getType()); comment.setGmtModified(System.currentTimeMillis()); comment.setGmtCreate(System.currentTimeMillis()); comment.setCommentator(user.getId()); comment.setLikeCount(0L); commentService.insert(comment, user); return ResultDTO.okOf(); } æ³¨æ„ å¼‚å¸¸å¤„ç† : ç”¨æˆ·(login)ã€å†…å®¹(null) (tag:mashiro) ParentId å¯ä»¥ä¸ºé—®é¢˜ idï¼Œä¹Ÿå¯ä»¥ä¸º è¯„è®ºidã€‚è¿™å–å†³äº type çš„å€¼(tag:mashiro) è¯„è®ºinsertè¯¦æƒ…ï¼Œéœ€è¦åˆ¤æ–­æ˜¯1çº§è¯„è®ºè¿˜æ˜¯2çº§è¯„è®º @Service public class CommentService { //@Transactional //https://zhuanlan.zhihu.com/p/47362056 //1. ä¸€èˆ¬æ ‡è®°åœ¨public æ–¹æ³• //2. @Transactional(rollbackFor=Exception.class)ï¼Œå¦‚æœæ–¹æ³•æŠ›å‡ºå¼‚å¸¸ï¼Œå°±ä¼šå›æ»šï¼Œæ•°æ®åº“é‡Œé¢çš„æ•°æ®ä¹Ÿä¼šå›æ»šã€‚ //3. åœ¨@Transactionalæ³¨è§£ä¸­å¦‚æœä¸é…ç½®rollbackForå±æ€§,é‚£ä¹ˆäº‹ç‰©åªä¼šåœ¨é‡åˆ°RuntimeExceptionçš„æ—¶å€™æ‰ä¼šå›æ»š,åŠ ä¸ŠrollbackFor=Exception.class,å¯ä»¥è®©äº‹ç‰©åœ¨é‡åˆ°éè¿è¡Œæ—¶å¼‚å¸¸æ—¶ä¹Ÿå›æ»š @Transactional public void insert(Comment comment, User commentator) { //è¯„è®ºéœ€è¦åœ¨æŸä¸ªé—®é¢˜æˆ–è€…æŸä¸ªè¯„è®ºä¸‹è¿›è¡Œ if (comment.getParentId() == null || comment.getParentId() == 0) { throw new CustomizeException(CustomizeErrorCode.TARGET_PARAM_NOT_FOUND); } // type == 1 : 1çº§è¯„è®º(å¯¹é—®é¢˜è¯„è®º) type == 2 : 2çº§è¯„è®º(å¯¹è¯„è®ºè¿›è¡Œè¯„è®º) if (comment.getType() == null || !CommentTypeEnum.isExist(comment.getType())) { throw new CustomizeException(CustomizeErrorCode.TYPE_PARAM_WRONG); } if (comment.getType() == CommentTypeEnum.COMMENT.getType()) { // 2çº§è¯„è®ºï¼Œå›å¤è¯„è®º //æŸ¥æ‰¾çˆ¶è¯„è®º Comment dbComment = commentMapper.selectByPrimaryKey(comment.getParentId()); if (dbComment == null) { throw new CustomizeException(CustomizeErrorCode.COMMENT_NOT_FOUND); } // æŸ¥æ‰¾çˆ¶è¯„è®ºå¯¹åº”çš„é—®é¢˜ Question question = questionMapper.selectByPrimaryKey(dbComment.getParentId()); if (question == null) { throw new CustomizeException(CustomizeErrorCode.QUESTION_NOT_FOUND); } commentMapper.insert(comment); // å¢åŠ è¯„è®ºæ•° Comment parentComment = new Comment(); parentComment.setId(comment.getParentId()); parentComment.setCommentCount(1); commentExtMapper.incCommentCount(parentComment); // åˆ›å»ºé€šçŸ¥ createNotify(comment, dbComment.getCommentator(), commentator.getName(), question.getTitle(), NotificationTypeEnum.REPLY_COMMENT, question.getId()); } else { // 1çº§è¯„è®ºï¼Œå›å¤é—®é¢˜ Question question = questionMapper.selectByPrimaryKey(comment.getParentId()); if (question == null) { throw new CustomizeException(CustomizeErrorCode.QUESTION_NOT_FOUND); } //æ­¤è¯„è®ºçš„è¯„è®ºæ•°åˆå§‹åŒ–ä¸º0 comment.setCommentCount(0); commentMapper.insert(comment); question.setCommentCount(1); //questionè¯„è®ºæ•°è‡ªå¢ questionExtMapper.incCommentCount(question); // åˆ›å»ºé€šçŸ¥ createNotify(comment, question.getCreator(), commentator.getName(), question.getTitle(), NotificationTypeEnum.REPLY_QUESTION, question.getId()); } } } æ³¨æ„ å…³æ³¨@Transactionalçš„ç”¨æ³•(tag:mashiro) æ³¨æ„å¼‚å¸¸å¤„ç†æ„è¯† public enum CommentTypeEnum { //æšä¸¾äº†QUESTIONå’ŒCOMMENTï¼Œtypeç±»å‹æ˜¯å…¬æœ‰çš„ã€‚1,2ä½œä¸ºæ„é€ å‚æ•°ï¼Œèµ‹å€¼ç»™type QUESTION(1), COMMENT(2); private Integer type; public Integer getType() { return type; } CommentTypeEnum(Integer type) { this.type = type; } public static boolean isExist(Integer type) { //CommentTypeEnum.values() ä»£è¡¨å…¨éƒ¨æšä¸¾å˜é‡ //1. type = 1 name = &quot;QUESTION&quot; ordinal = 0 //2. type = 2 name = &quot;COMMENT&quot; ordinal = 1 for (CommentTypeEnum commentTypeEnum : CommentTypeEnum.values()) { if (commentTypeEnum.getType() == type) { return true; } } return false; } } questionè¯„è®ºæ•°è‡ªå¢ &lt;update id=&quot;incCommentCount&quot; parameterType=&quot;life.majiang.community.model.Question&quot;&gt; update QUESTION set COMMENT_COUNT = COMMENT_COUNT + #{commentCount,jdbcType=INTEGER} where id = #{id} &lt;/update&gt; 3. é¦–é¡µé—®é¢˜æ’åº3.1 å‰ç«¯é¡µé¢ 3.2 controller @GetMapping(&quot;/&quot;) public String index(Model model, @RequestParam(name = &quot;page&quot;, defaultValue = &quot;1&quot;) Integer page, @RequestParam(name = &quot;size&quot;, defaultValue = &quot;10&quot;) Integer size, @RequestParam(name = &quot;search&quot;, required = false) String search, @RequestParam(name = &quot;tag&quot;, required = false) String tag, @RequestParam(name = &quot;sort&quot;, required = false) String sort) { //å¯¹çƒ­è¯è¿›è¡Œæ£€ç´¢ï¼Œå¯¹ç»“æœè¿›è¡Œæ’åºåçš„ç»“æœ PaginationDTO pagination = questionService.list(search, tag, sort, page, size); //è·å–çƒ­é—¨æ ‡ç­¾ List&lt;String&gt; tags = hotTagCache.getHots(); model.addAttribute(&quot;pagination&quot;, pagination); model.addAttribute(&quot;search&quot;, search); model.addAttribute(&quot;tag&quot;, tag); model.addAttribute(&quot;tags&quot;, tags); model.addAttribute(&quot;sort&quot;, sort); return &quot;index&quot;; } 3.3 service /** * * @param search æœç´¢æ å†…å®¹ * @param tag é¦–é¡µçƒ­é—¨æ ‡ç­¾ * @param sort é—®é¢˜æ’åºæœ€æ–°ã€30å¤©æœ€çƒ­ã€7å¤©æœ€çƒ­ã€æœ€çƒ­ã€æ¶ˆç­é›¶å›å¤(sort = new sort = hot30 sort = hot7 sort = hot sort = no) * @param page * @param size * @return */ public PaginationDTO list(String search, String tag, String sort, Integer page, Integer size) { //æœç´¢å†…å®¹é¢„å¤„ç† if (StringUtils.isNotBlank(search)) { String[] tags = StringUtils.split(search, &quot; &quot;); search = Arrays .stream(tags) .filter(StringUtils::isNotBlank) .map(t -&gt; t.replace(&quot;+&quot;, &quot;&quot;).replace(&quot;*&quot;, &quot;&quot;).replace(&quot;?&quot;, &quot;&quot;)) .filter(StringUtils::isNotBlank) .collect(Collectors.joining(&quot;|&quot;)); } PaginationDTO paginationDTO = new PaginationDTO(); Integer totalPage; QuestionQueryDTO questionQueryDTO = new QuestionQueryDTO(); //search=mashiro|hanserï¼Œ| æ–¹ä¾¿ sql æ­£åˆ™æŸ¥è¯¢ questionQueryDTO.setSearch(search); if (StringUtils.isNotBlank(tag)) { tag = tag.replace(&quot;+&quot;, &quot;&quot;).replace(&quot;*&quot;, &quot;&quot;).replace(&quot;?&quot;, &quot;&quot;); questionQueryDTO.setTag(tag); } //è®¾ç½® sort for (SortEnum sortEnum : SortEnum.values()) { if (sortEnum.name().toLowerCase().equals(sort)) { questionQueryDTO.setSort(sort); if (sortEnum == SortEnum.HOT7) { //7å¤©å‰çš„æ—¶é—´æˆ³ questionQueryDTO.setTime(System.currentTimeMillis() - 1000L * 60 * 60 * 24 * 7); } if (sortEnum == SortEnum.HOT30) { //30å¤©å‰çš„æ—¶é—´æˆ³ questionQueryDTO.setTime(System.currentTimeMillis() - 1000L * 60 * 60 * 24 * 30); } break; } } //è®¾ç½®æŸ¥è¯¢åˆ†é¡µæ•°æ® Integer totalCount = questionExtMapper.countBySearch(questionQueryDTO); if (totalCount % size == 0) { totalPage = totalCount / size; } else { totalPage = totalCount / size + 1; } if (page &lt; 1) { page = 1; } if (page &gt; totalPage) { page = totalPage; } paginationDTO.setPagination(totalPage, page); Integer offset = page &lt; 1 ? 0 : size * (page - 1); questionQueryDTO.setSize(size); questionQueryDTO.setPage(offset); //questionQueryDTO æ•°æ®å‡†å¤‡å®Œæˆï¼Œè¿›è¡ŒæŸ¥è¯¢ List&lt;Question&gt; questions = questionExtMapper.selectBySearch(questionQueryDTO); List&lt;QuestionDTO&gt; questionDTOList = new ArrayList&lt;&gt;(); for (Question question : questions) { User user = userMapper.selectByPrimaryKey(question.getCreator()); QuestionDTO questionDTO = new QuestionDTO(); BeanUtils.copyProperties(question, questionDTO); questionDTO.setUser(user); questionDTOList.add(questionDTO); } paginationDTO.setData(questionDTOList); return paginationDTO; } 3.4 Dao &lt;select id=&quot;selectBySearch&quot; parameterType=&quot;life.majiang.community.dto.QuestionQueryDTO&quot; resultMap=&quot;BaseResultMap&quot;&gt; select * from QUESTION &lt;where&gt; &lt;if test=&quot;search != null and search != &#39;&#39;&quot;&gt; and title regexp #{search} &lt;/if&gt; &lt;if test=&quot;tag != null and tag != &#39;&#39;&quot;&gt; and tag regexp #{tag} &lt;/if&gt; &lt;if test=&quot;sort != null and sort != &#39;&#39; and sort == &#39;no&#39;&quot;&gt; and comment_count = 0 &lt;/if&gt; &lt;if test=&quot;time != null and time != &#39;&#39;&quot;&gt; and gmt_create &gt; #{time} &lt;/if&gt; &lt;/where&gt; &lt;if test=&quot;sort == null or sort == &#39;&#39;&quot;&gt; order by gmt_create desc &lt;/if&gt; &lt;if test=&quot;sort != null and sort != &#39;&#39; and sort == &#39;new&#39;&quot;&gt; order by gmt_create desc &lt;/if&gt; &lt;if test=&quot;sort != null and sort != &#39;&#39; and sort == &#39;no&#39;&quot;&gt; order by gmt_create desc &lt;/if&gt; &lt;if test=&quot;sort != null and sort != &#39;&#39; and (sort == &#39;hot&#39; || sort == &#39;hot7&#39; || sort == &#39;hot30&#39;)&quot;&gt; order by comment_count desc &lt;/if&gt; limit #{page},#{size} &lt;/select&gt; 4. çƒ­ç‚¹tag(å®šæ—¶ä»»åŠ¡)@Component @Slf4j public class HotTagTasks { @Autowired private QuestionMapper questionMapper; @Autowired private HotTagCache hotTagCache; //å®šæ—¶ä»»åŠ¡ //fixedRate å›ºå®šæ—¶é—´æ‰§è¡Œ å•ä½ ms @Scheduled(fixedRate = 1000 * 60 * 60 * 3) public void hotTagSchedule() { int offset = 0; int limit = 20; log.info(&quot;hotTagSchedule start {}&quot;, new Date()); List&lt;Question&gt; list = new ArrayList&lt;&gt;(); Map&lt;String, Integer&gt; priorities = new HashMap&lt;&gt;(); //æ ¹æ®è¯„è®ºæ•°ï¼Œè®¡ç®—æ¯ä¸ªtagçš„çƒ­åº¦ while (offset == 0 || list.size() == limit) { list = questionMapper.selectByExampleWithRowbounds(new QuestionExample(), new RowBounds(offset, limit)); for (Question question : list) { //æ¯ä¸ªé—®é¢˜çš„tagæ˜¯ä»¥é€—å·åˆ†å‰²çš„ String[] tags = StringUtils.split(question.getTag(), &quot;,&quot;); for (String tag : tags) { Integer priority = priorities.get(tag); if (priority != null) { priorities.put(tag, priority + 5 + question.getCommentCount()); } else { priorities.put(tag, 5 + question.getCommentCount()); } } } offset += limit; } hotTagCache.updateTags(priorities); log.info(&quot;hotTagSchedule stop {}&quot;, new Date()); } } æ³¨æ„ æµ‹å‡ºä¸ªäººè®¤ä¸ºåº”è¯¥å…ˆæŸ¥è¯¢æ‰€æœ‰çš„æ•°æ®ï¼Œå°†æ‰€æœ‰çš„tag è®¡ç®—å‡º priority ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶é—´å¯èƒ½ä¼šå¾ˆé•¿(tag:mashiro) @Component @Data public class HotTagCache { private List&lt;String&gt; hots = new ArrayList&lt;&gt;(); public void updateTags(Map&lt;String, Integer&gt; tags) { int max = 10; //PriorityQueue ä¼˜å…ˆé˜Ÿåˆ—(å°é¡¶å †äºŒå‰æ ‘ç»“æ„)ä¿è¯æ¯æ¬¡å–å‡ºçš„å…ƒç´  PriorityQueue&lt;HotTagDTO&gt; priorityQueue = new PriorityQueue&lt;&gt;(max); tags.forEach((name, priority) -&gt; { HotTagDTO hotTagDTO = new HotTagDTO(); hotTagDTO.setName(name); hotTagDTO.setPriority(priority); if (priorityQueue.size() &lt; max) { //å‘å°é¡¶å †æ·»åŠ å…ƒç´  priorityQueue.add(hotTagDTO); } else { //è·å–å †é¡¶å…ƒç´ ï¼Œå…ƒç´ å€¼æœ€å° HotTagDTO minHot = priorityQueue.peek(); if (hotTagDTO.compareTo(minHot) &gt; 0) { //åˆ é™¤å †é¡¶å…ƒç´ ,æ­¤å¤„æ–°å…ƒç´ å¤§äºå †é¡¶å…ƒç´ ï¼Œåˆ é™¤å †é¡¶å…ƒç´  priorityQueue.poll(); priorityQueue.add(hotTagDTO); } } }); List&lt;String&gt; sortedTags = new ArrayList&lt;&gt;(); HotTagDTO poll = priorityQueue.poll(); while (poll != null) { sortedTags.add(0, poll.getName()); poll = priorityQueue.poll(); } hots = sortedTags; } } æ³¨æ„ ä¿æŒPriorityQueueé˜Ÿåˆ—ä¸­ï¼Œæœ€å¤šå­˜åœ¨10ä¸ªå…ƒç´ ï¼Œä¸”å…ƒç´ å€¼æ—¶æœ€å¤§çš„10ä¸ªï¼Œå³çƒ­åº¦æœ€é«˜çš„10ä¸ªtagï¼Œä½¿ç”¨PriorityQueueçš„åŸå› æ˜¯ï¼Œç”±äºæ˜¯å°é¡¶å †çš„ç»“æ„ï¼Œä¸€ä¸ªæ–°æ¥çš„å…ƒç´ å¾ˆå¿«å°±èƒ½æ‰¾åˆ°æ‰€å±ä½ç½®ï¼Œå¦‚æœä½¿ç”¨Listçš„è¯ï¼Œæ¯æ¬¡éƒ½æ˜¯éå†ï¼Œæ—¶é—´å¤æ‚å¤ªé«˜ã€‚(tag:mashiro) 5. å¼‚å¸¸å¤„ç†5.1 å¼‚å¸¸å¤„ç†æ ‡å‡†å®šä¹‰public interface ICustomizeErrorCode { String getMessage() ; Integer getCode(); } public enum CustomizeErrorCode implements ICustomizeErrorCode { //æšä¸¾ç±»å‹ QUESTION_NOT_FOUND(2001, &quot;ä½ æ‰¾åˆ°é—®é¢˜ä¸åœ¨äº†ï¼Œè¦ä¸è¦æ¢ä¸ªè¯•è¯•ï¼Ÿ&quot;), TARGET_PARAM_NOT_FOUND(2002, &quot;æœªé€‰ä¸­ä»»ä½•é—®é¢˜æˆ–è¯„è®ºè¿›è¡Œå›å¤&quot;), NO_LOGIN(2003, &quot;å½“å‰æ“ä½œéœ€è¦ç™»å½•ï¼Œè¯·ç™»é™†åé‡è¯•&quot;), SYS_ERROR(2004, &quot;æœåŠ¡å†’çƒŸäº†ï¼Œè¦ä¸ç„¶ä½ ç¨åå†è¯•è¯•ï¼ï¼ï¼&quot;), TYPE_PARAM_WRONG(2005, &quot;è¯„è®ºç±»å‹é”™è¯¯æˆ–ä¸å­˜åœ¨&quot;), COMMENT_NOT_FOUND(2006, &quot;å›å¤çš„è¯„è®ºä¸å­˜åœ¨äº†ï¼Œè¦ä¸è¦æ¢ä¸ªè¯•è¯•ï¼Ÿ&quot;), CONTENT_IS_EMPTY(2007, &quot;è¾“å…¥å†…å®¹ä¸èƒ½ä¸ºç©º&quot;), READ_NOTIFICATION_FAIL(2008, &quot;å…„å¼Ÿä½ è¿™æ˜¯è¯»åˆ«äººçš„ä¿¡æ¯å‘¢ï¼Ÿ&quot;), NOTIFICATION_NOT_FOUND(2009, &quot;æ¶ˆæ¯è«éæ˜¯ä¸ç¿¼è€Œé£äº†ï¼Ÿ&quot;), FILE_UPLOAD_FAIL(2010, &quot;å›¾ç‰‡ä¸Šä¼ å¤±è´¥&quot;), INVALID_INPUT(2011, &quot;éæ³•è¾“å…¥&quot;), INVALID_OPERATION(2012, &quot;å…„å¼Ÿï¼Œæ˜¯ä¸æ˜¯èµ°é”™æˆ¿é—´äº†ï¼Ÿ&quot;), ; @Override public String getMessage() { return message; } @Override public Integer getCode() { return code; } //æˆå‘˜å˜é‡ private Integer code; private String message; //æšä¸¾å†…çš„æ„é€ å‡½æ•° CustomizeErrorCode(Integer code, String message) { this.message = message; this.code = code; } } public class CustomizeException extends RuntimeException {//ç»§æ‰¿è¿è¡Œæ—¶å¼‚å¸¸ï¼Œå¯ä»¥æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸ private String message; private Integer code; // æ„é€ å‡½æ•°å‚æ•°ä¸ºICustomizeErrorCode public CustomizeException(ICustomizeErrorCode errorCode) { this.code = errorCode.getCode(); this.message = errorCode.getMessage(); } @Override public String getMessage() { return message; } public Integer getCode() { return code; } } throw new CustomizeException(CustomizeErrorCode.INVALID_INPUT);//æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸ 5.2 @ControllerAdvice @ExceptionHandler@ControllerAdvice//æ³¨è§£å®šä¹‰å…¨å±€å¼‚å¸¸å¤„ç†ç±» @Slf4j public class CustomizeExceptionHandler { @ExceptionHandler(Exception.class)//æ•è·Exceptionç±»åŠå…¶å­ç±»å¼‚å¸¸ ModelAndView handle(Throwable e, Model model, HttpServletRequest request, HttpServletResponse response) { String contentType = request.getContentType(); if (&quot;application/json&quot;.equals(contentType)) { ResultDTO resultDTO; // è¿”å› JSON if (e instanceof CustomizeException) { //å¼‚å¸¸æ˜¯new CustomizeException æŠ›å‡ºæ¥çš„ resultDTO = ResultDTO.errorOf((CustomizeException) e); } else { log.error(&quot;handle error&quot;, e); resultDTO = ResultDTO.errorOf(CustomizeErrorCode.SYS_ERROR); } try { response.setContentType(&quot;application/json&quot;); response.setStatus(200); response.setCharacterEncoding(&quot;utf-8&quot;); PrintWriter writer = response.getWriter(); writer.write(JSON.toJSONString(resultDTO)); writer.close(); } catch (IOException ioe) { } return null; } else { // é”™è¯¯é¡µé¢è·³è½¬ if (e instanceof CustomizeException) { model.addAttribute(&quot;message&quot;, e.getMessage()); } else { log.error(&quot;handle error&quot;, e); model.addAttribute(&quot;message&quot;, CustomizeErrorCode.SYS_ERROR.getMessage()); } return new ModelAndView(&quot;error&quot;);//è·³è½¬åˆ°error.html } } } @ControllerAdvice + @ExceptionHandleræ•è·å…¨å±€å¼‚å¸¸ throw new CustomizeException(CustomizeErrorCode.INVALID_INPUT);å¯ä»¥æ•è·ç±»ä¼¼æŠ›å‡ºå¼‚å¸¸ @Data public class ResultDTO&lt;T&gt; { private Integer code; private String message; private T data; public static ResultDTO errorOf(Integer code, String message) { ResultDTO resultDTO = new ResultDTO(); resultDTO.setCode(code); resultDTO.setMessage(message); return resultDTO; } public static ResultDTO errorOf(CustomizeErrorCode errorCode) { return errorOf(errorCode.getCode(), errorCode.getMessage()); } public static ResultDTO errorOf(CustomizeException e) { return errorOf(e.getCode(), e.getMessage()); } public static ResultDTO okOf() { ResultDTO resultDTO = new ResultDTO(); resultDTO.setCode(200); resultDTO.setMessage(&quot;è¯·æ±‚æˆåŠŸ&quot;); return resultDTO; } public static &lt;T&gt; ResultDTO okOf(T t) { ResultDTO resultDTO = new ResultDTO(); resultDTO.setCode(200); resultDTO.setMessage(&quot;è¯·æ±‚æˆåŠŸ&quot;); resultDTO.setData(t); return resultDTO; } } 5.3 controller/* ${server.error.path:${error.path:/error}} å¦‚æœ server.error.path æœªé…ç½®,åˆ™ä½¿ç”¨ ${error.path:/error} å¦‚æœ error.path æœªé…ç½®,åˆ™ä½¿ç”¨ &quot;/error&quot; */ @Controller @RequestMapping(&quot;${server.error.path:${error.path:/error}}&quot;) public class CustomizeErrorController implements ErrorController { @Override public String getErrorPath() { return &quot;error&quot;; } @RequestMapping(produces = MediaType.TEXT_HTML_VALUE)//è®¾ç½®è¿”å›çš„æ•°æ®ç±»å‹ public ModelAndView errorHtml(HttpServletRequest request, Model model) { HttpStatus status = getStatus(request); if (status.is4xxClientError()) { model.addAttribute(&quot;message&quot;, &quot;ä½ è¿™ä¸ªè¯·æ±‚é”™äº†å§ï¼Œè¦ä¸ç„¶æ¢ä¸ªå§¿åŠ¿ï¼Ÿ&quot;); } if (status.is5xxServerError()) { model.addAttribute(&quot;message&quot;, &quot;æœåŠ¡å†’çƒŸäº†ï¼Œè¦ä¸ç„¶ä½ ç¨åå†è¯•è¯•ï¼ï¼ï¼&quot;); } return new ModelAndView(&quot;error&quot;); } private HttpStatus getStatus(HttpServletRequest request) { Integer statusCode = (Integer) request .getAttribute(&quot;javax.servlet.error.status_code&quot;); if (statusCode == null) { return HttpStatus.INTERNAL_SERVER_ERROR; } try { return HttpStatus.valueOf(statusCode); } catch (Exception ex) { return HttpStatus.INTERNAL_SERVER_ERROR; } } }","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"å¼€æº","slug":"å¼€æº","permalink":"/tags/å¼€æº/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Javaè¯­æ³•","slug":"æŠ€æœ¯/Java è¯­æ³•","date":"2021-01-17T12:00:00.000Z","updated":"2022-10-09T15:19:10.433Z","comments":true,"path":"2021/01/17/æŠ€æœ¯/Java è¯­æ³•/","link":"","permalink":"/2021/01/17/æŠ€æœ¯/Java è¯­æ³•/","excerpt":"","text":"1. stream() ä½¿ç”¨ stream().map List&lt;Integer&gt; list = Arrays.asList(1,2,3,4); List&lt;Integer&gt; list2 = list.stream().map(l1 -&gt; l1 * 2).collect(Collectors.toList()); List&lt;String&gt; list3 = Arrays.asList(&quot;a&quot;,&quot;b&quot;,&quot;cc&quot;,&quot;dd&quot;); List&lt;String&gt; list4 = list3.stream().map(String::toUpperCase).collect(Collectors.toList()); List&lt;String&gt; list3 = Arrays.asList(&quot;a&quot;,&quot;b&quot;,&quot;cc&quot;,&quot;dd&quot;); //æ˜ å°„è§„åˆ™å¯ä»¥æ˜¯ä¸€ä¸ªå‡½æ•° List&lt;String&gt; list4 = list3.stream().map(l1 -&gt; {return l1.toUpperCase();}).collect(Collectors.toList()); stream().map è¡¨ç¤ºå°†æ•°ç»„ã€åˆ—è¡¨ç­‰çš„å…ƒç´ æŒ‰ç…§ä¸€å®šè§„åˆ™è¿›è¡Œæ˜ å°„ collect(Collectors.toList());è¡¨ç¤ºå°†æ˜ å°„ç»“æœè½¬æ¢æˆåˆ—è¡¨ collect(Collectors.toSet());è¡¨è¿°è½¬æ¢æˆé›†åˆï¼Œå¯ä»¥è¾¾åˆ°å»é‡ç›®çš„ stream().filter List&lt;Integer&gt; list = Arrays.asList(1,2,3,4); List&lt;Integer&gt; list1 = list.stream().filter(l1 -&gt; l1.intValue() &gt; 3).collect(Collectors.toList()); stream().filter è¡¨ç¤ºå°†æ•°ç»„ã€åˆ—è¡¨ç­‰çš„å…ƒç´ æŒ‰ç…§ä¸€å®šè§„åˆ™è¿›è¡Œç­›é€‰,ä¿ç•™çš„æ˜¯æ»¡è¶³ä¸Šé¢æ¡ä»¶çš„ Collectors.toMap å®ç°list è½¬ map @Data @AllArgsConstructor class User { private Integer id; private String name; } List&lt;User&gt; list5 = Arrays.asList( new User(1, &quot;yukino&quot;), new User(2, &quot;mashiro&quot;), new User(3, &quot;yui&quot;) ); Map&lt;Integer, String&gt; collect = list5.stream().collect(Collectors.toMap(User::getId, User::getName)); Collectors.joining å®ç°å­—ç¬¦ä¸²æ‹¼æ¥ String[] name = {&quot;yukino*&quot;, &quot;mash?iro&quot;, &quot;yu+i&quot;}; Stream&lt;String&gt; stringStream = Stream.of(name); String collect = stringStream .map(t -&gt; t.replace(&quot;*&quot;, &quot;&quot;).replace(&quot;+&quot;, &quot;&quot;).replace(&quot;?&quot;, &quot;&quot;)) .collect(Collectors.joining(&quot;,&quot;, &quot;[&quot;, &quot;]&quot;)); System.out.println(collect); [yukino,mashiro,yui] stream().flatMap ä½œç”¨ åˆ—è¡¨ä¸­çš„å…ƒç´ å«æœ‰åˆ—è¡¨æˆå‘˜ï¼Œå–å‡ºå…ƒç´ ï¼Œå†å°†å…ƒç´ æˆå‘˜åˆ—è¡¨çš„å…ƒç´ å–å‡ºæ¥ï¼Œè¿›è¡Œåˆå¹¶ @Data @AllArgsConstructor class TagDTO { private String categoryName; private List&lt;String&gt; tags; } public static void main(String[] args) { TagDTO tagDTO1 = new TagDTO(&quot;å¼€å‘è¯­è¨€&quot;, Arrays.asList(&quot;Java&quot;, &quot;Python&quot;, &quot;C&quot;)); TagDTO tagDTO2 = new TagDTO(&quot;å¼€å‘å·¥å…·&quot;, Arrays.asList(&quot;IDEA&quot;, &quot;Tomcat&quot;)); List&lt;TagDTO&gt; tagDTOS = Arrays.asList(tagDTO1, tagDTO2); List&lt;String&gt; collect = tagDTOS.stream().flatMap(tag -&gt; tag.getTags().stream()).collect(Collectors.toList()); System.out.println(collect); } [Java, Python, C, IDEA, Tomcat] 2. Map foreachçš„ä½¿ç”¨Map&lt;String, String&gt; infoMap = new HashMap&lt;&gt;(); infoMap.put(&quot;name&quot;,&quot;yukino&quot;); infoMap.put(&quot;site&quot;,&quot;www.yukino.tech&quot;); infoMap.put(&quot;email&quot;, &quot;xxxx&quot;); infoMap.forEach((key,value) -&gt; { System.out.println(key + &quot;:&quot; + value); }); 3. PriorityQueuePriorityQueueï¼Œå³ä¼˜å…ˆé˜Ÿåˆ—ï¼Œç”±å°é¡¶å †ç»„æˆ @Data @AllArgsConstructor class HotTagDTO implements Comparable { private String name; private Integer priority; //æ­¤æ–¹æ³•æ˜¯å…ƒç´ æ¯”è¾ƒå¤§å°çš„ä¾æ® @Override public int compareTo(Object o) { return this.getPriority() - ((HotTagDTO) o).getPriority(); } } public static void main(String[] args) { PriorityQueue&lt;HotTagDTO&gt; priorityQueue = new PriorityQueue&lt;&gt;(10); priorityQueue.add(new HotTagDTO(&quot;yukino&quot;, 1)); priorityQueue.add(new HotTagDTO(&quot;mashiro&quot;,2)); System.out.println(priorityQueue.peek().getName()); } add(E e)å’Œoffer(E e)çš„è¯­ä¹‰ç›¸åŒï¼Œéƒ½æ˜¯å‘ä¼˜å…ˆé˜Ÿåˆ—ä¸­æ’å…¥å…ƒç´ ï¼Œåªæ˜¯Queueæ¥å£è§„å®šäºŒè€…å¯¹æ’å…¥å¤±è´¥æ—¶çš„å¤„ç†ä¸åŒï¼Œå‰è€…åœ¨æ’å…¥å¤±è´¥æ—¶æŠ›å‡ºå¼‚å¸¸ï¼Œååˆ™åˆ™ä¼šè¿”å›falseã€‚ element()å’Œpeek()çš„è¯­ä¹‰å®Œå…¨ç›¸åŒï¼Œéƒ½æ˜¯è·å–ä½†ä¸åˆ é™¤é˜Ÿé¦–å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯é˜Ÿåˆ—ä¸­æƒå€¼æœ€å°çš„é‚£ä¸ªå…ƒç´ ï¼ŒäºŒè€…å”¯ä¸€çš„åŒºåˆ«æ˜¯å½“æ–¹æ³•å¤±è´¥æ—¶å‰è€…æŠ›å‡ºå¼‚å¸¸ï¼Œåè€…è¿”å›nullã€‚æ ¹æ®å°é¡¶å †çš„æ€§è´¨ï¼Œå †é¡¶é‚£ä¸ªå…ƒç´ å°±æ˜¯å…¨å±€æœ€å°çš„é‚£ä¸ª remove()å’Œpoll()æ–¹æ³•çš„è¯­ä¹‰ä¹Ÿå®Œå…¨ç›¸åŒï¼Œéƒ½æ˜¯è·å–å¹¶åˆ é™¤é˜Ÿé¦–å…ƒç´ ï¼ŒåŒºåˆ«æ˜¯å½“æ–¹æ³•å¤±è´¥æ—¶å‰è€…æŠ›å‡ºå¼‚å¸¸ï¼Œåè€…è¿”å›nullã€‚ remove(Object o)æ–¹æ³•ç”¨äºåˆ é™¤é˜Ÿåˆ—ä¸­è·Ÿoç›¸ç­‰çš„æŸä¸€ä¸ªå…ƒç´ ï¼ˆå¦‚æœæœ‰å¤šä¸ªç›¸ç­‰ï¼Œåªåˆ é™¤ä¸€ä¸ªï¼‰","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"æ—¥ç§¯è·¬æ­¥","slug":"æ—¥ç§¯è·¬æ­¥","permalink":"/tags/æ—¥ç§¯è·¬æ­¥/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Docker","slug":"æŠ€æœ¯/Docker","date":"2021-01-17T11:00:00.000Z","updated":"2022-10-09T15:19:10.433Z","comments":true,"path":"2021/01/17/æŠ€æœ¯/Docker/","link":"","permalink":"/2021/01/17/æŠ€æœ¯/Docker/","excerpt":"","text":"1. Docker å®‰è£…2. Docker ä½¿ç”¨2.1 ä»‹ç» docker hello world docker run hello-world æŸ¥çœ‹é•œåƒ docker images run æµç¨‹ Dockerå…ˆåœ¨æœ¬åœ°å¯»æ‰¾é•œåƒï¼Œå¦‚æœæœ¬åœ°æœ‰ï¼Œåˆ™ç›´æ¥æ‰§è¡Œã€‚è‹¥æœ¬åœ°æ²¡æœ‰ï¼Œåˆ™ç›´æ¥å»runã€‚è‹¥æ²¡æœ‰ï¼Œåˆ™å»Docker Hubä¸Šå»ä¸‹è½½åˆ°æœ¬åœ° 2.2 docker å‘½ä»¤2.2.1 å¸®åŠ©å‘½ä»¤docker version #æ˜¾ç¤º dockerçš„ç‰ˆæœ¬ä¿¡æ¯ docker info #æ˜¾ç¤ºdockerçš„ç³»ç»Ÿä¿¡æ¯,åŒ…æ‹¬é•œåƒå’Œå®¹å™¨çš„æ•°é‡ docker å‘½ä»¤ --help 2.2.2 æ–‡æ¡£2.2.3 é•œåƒå‘½ä»¤docker images æŸ¥çœ‹æœ¬åœ°ä¸»æœºæ‰€æœ‰é•œåƒ yukino@Yukinos-Mac-mini î‚° ~ î‚° docker images REPOSITORY TAG IMAGE ID CREATED SIZE hello-world latest bf756fb1ae65 12 months ago 13.3kB # è§£é‡Š REPOSITORY é•œåƒçš„ä»“åº“æº TAG é•œåƒçš„æ ‡ç­¾ IMAGE ID é•œåƒ id CREATED åˆ›å»ºæ—¶é—´ SIZE å¤§å° # å¯é€‰é¡¹ -a, --all Show all images (default hides intermediate images) --digests Show digests -f, --filter filter Filter output based on conditions provided --format string Pretty-print images using a Go template --no-trunc Don&#39;t truncate output -q, --quiet Only show image IDs docker search æœç´¢ yukino@Yukinos-Mac-mini î‚° ~ î‚° docker search mysql NAME DESCRIPTION STARS OFFICIAL AUTOMATED mysql MySQL is a widely used, open-source relationâ€¦ 10369 [OK] mariadb MariaDB is a community-developed fork of MySâ€¦ 3842 [OK] mysql/mysql-server Optimized MySQL Server Docker images. Createâ€¦ 757 [OK] percona Percona Server is a fork of the MySQL relatiâ€¦ 519 [OK] # å¯é€‰é¡¹ -f, --filter filter Filter output based on conditions provided --format string Pretty-print search using a Go template --limit int Max number of search results (default 25) --no-trunc Don&#39;t truncate output # é€šè¿‡ start è¿›è¡Œè¿‡æ»¤ --filter=STARS=3000 # ä¸å°äº3000 # docker search mysql --filter=STARS=3000 docker pull ä¸‹è½½ yukino@Yukinos-Mac-mini î‚° ~ î‚° docker pull mysql Using default tag: latest #å¦‚æœä¸å†™tagï¼Œé»˜è®¤å°±æ˜¯ latest latest: Pulling from library/mysql 6ec7b7d162b2: Pull complete # åˆ†å±‚ä¸‹è½½ï¼Œdocker imageçš„æ ¸å¿ƒ è”åˆæ–‡ä»¶ç³»ç»Ÿ fedd960d3481: Pull complete 7ab947313861: Pull complete 64f92f19e638: Pull complete 3e80b17bff96: Pull complete 014e976799f9: Pull complete 59ae84fee1b3: Pull complete ffe10de703ea: Pull complete 657af6d90c83: Pull complete 98bfb480322c: Pull complete 6aa3859c4789: Pull complete 1ed875d851ef: Pull complete Digest: sha256:78800e6d3f1b230e35275145e657b82c3fb02a27b2d8e76aac2f5e90c1c30873 #ç­¾å Status: Downloaded newer image for mysql:latest docker.io/library/mysql:latest #çœŸå®åœ°å€ # ç­‰ä»· docker pull mysql docker pull docker.io/library/mysql:latest #æŒ‡å®šç‰ˆæœ¬ docker pull mysql:5.7 yukino@Yukinos-Mac-mini î‚° ~ î‚° docker pull mysql:5.7 5.7: Pulling from library/mysql 6ec7b7d162b2: Already exists fedd960d3481: Already exists 7ab947313861: Already exists 64f92f19e638: Already exists 3e80b17bff96: Already exists 014e976799f9: Already exists 59ae84fee1b3: Already exists 7d1da2a18e2e: Pull complete 301a28b700b9: Pull complete 529dc8dbeaf3: Pull complete bc9d021dc13f: Pull complete Digest: sha256:c3a567d3e3ad8b05dfce401ed08f0f6bf3f3b64cc17694979d5f2e5d78e10173 Status: Downloaded newer image for mysql:5.7 docker.io/library/mysql:5.7 yukino@Yukinos-Mac-mini î‚° ~ î‚° docker images REPOSITORY TAG IMAGE ID CREATED SIZE mysql 5.7 f07dfa83b528 2 weeks ago 448MB mysql latest a347a5928046 2 weeks ago 545MB hello-world latest bf756fb1ae65 12 months ago 13.3kB docker rmiåˆ é™¤ yukino@Yukinos-Mac-mini î‚° ~ î‚° docker rmi -f f07dfa83b #åˆ é™¤ä¸€ä¸ªé•œåƒ Untagged: mysql:5.7 Untagged: mysql@sha256:c3a567d3e3ad8b05dfce401ed08f0f6bf3f3b64cc17694979d5f2e5d78e10173 Deleted: sha256:f07dfa83b5283f486f1fa1628cb8b4a18a4d071a486708acc5c06243ca7f592a Deleted: sha256:1137660d239dd339c83697d1d5cc93542333aaf35c1fd90418f9c0d166c23487 Deleted: sha256:20c29fc0161bc3cc0addc48ab1aeb70f605a5529590fd32d01502d58d1c6dc10 Deleted: sha256:8615ae1ee613441540ee54a2c517eb0600a6c83667a79f7ca74acc9ffec4c9a4 Deleted: sha256:252efab3ecb7891820c5a340645044850d6edc7815c6588450d74b0a743424f4 yukino@Yukinos-Mac-mini î‚° ~ î‚° docker rmi -f $(docker images -aq) #åˆ é™¤æ‰€æœ‰é•œåƒ Untagged: mysql:latest Untagged: mysql@sha256:78800e6d3f1b230e35275145e657b82c3fb02a27b2d8e76aac2f5e90c1c30873 Deleted: sha256:a347a59280467629ae4d70ce555e3f96faca8ff2ff8c57cacc8184bebb681f66 Deleted: sha256:8c4db4ce0f63c9eec74a2e555bb7e2fa5e2de08389cbc747793aa30bc3ac04e1 Deleted: sha256:6179be2adc547662cd0ef2cb032b85809ac68923b7ab9c71e5a21b88bbe7f542 Deleted: sha256:17d702350e6aa7f240ca23090d24b059f5c324e292a77b5069225e76e0b51dd6 Deleted: sha256:5c5f95733957fd96300b5265d6b2df728415ed62e7b4b30eadd7d836d48187bf Deleted: sha256:fbf118fadaf5230c8df9a3b51c608393a8f3adb99c089ea2db253438efab1a0e Deleted: sha256:43b82d704a10e6d022fa3f31a5f827a00e339ee21dd2849a9b120ab82be9af71 Deleted: sha256:a4994702421d2b9a74c4f3810aa7ac09990e849905f23a1d8f358c826d58501f Deleted: sha256:36c598c7a6f90abf6d67cde4a58b0747bfbcc7441d3b782bdeea7cda8c9ad7b6 Deleted: sha256:86f598b4f8200bdd4ae752f916154e4e29d5b4c211bb124eb150b9957a3e0141 Deleted: sha256:9e979d97f92bf78a225c77c6b4ba74eb2e03efb95b19b69206cd17cee15a4b26 Deleted: sha256:aff48ce4678f78d83d7e9bfb9e88cd951c3da52da08779e99b6082edd1cc66f3 Deleted: sha256:87c8a1d8f54f3aa4e05569e8919397b65056aa71cdf48b7f061432c98475eee9 Untagged: hello-world:latest Untagged: hello-world@sha256:1a523af650137b8accdaed439c17d684df61ee4d74feac151b5b337bd29e7eec Deleted: sha256:bf756fb1ae65adf866bd8c456593cd24beb6a0a061dedf42b26a993176745f6b 2.2.4 å®¹å™¨å‘½ä»¤ä¸‹è½½ä¸€ä¸ªcentosé•œåƒæ¥å­¦ä¹  docker pull centos æ–°å»ºå®¹å™¨å¹¶å¯åŠ¨ docker run [å¯é€‰å‚æ•°] image #å‚æ•°è¯´æ˜ --name=â€œnameâ€ å®¹å™¨åå­— -d åå°è¿è¡Œ -it ä½¿ç”¨äº¤äº’æ–¹å¼è¿è¡Œï¼Œè¿›å…¥å®¹å™¨æŸ¥çœ‹å†…å®¹ -p æŒ‡å®šå®¹å™¨ç«¯å£ -p 8080:8080 -p ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ -p ip:ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£ -p å®¹å™¨ç«¯å£ -P éšæœºæŒ‡å®šç«¯å£ # å¯åŠ¨å¹¶è¿›å…¥å®¹å™¨ yukino@Yukinos-Mac-mini î‚° ~ î‚° docker run -it centos /bin/sh sh-4.4# # é€€å‡ºå®¹å™¨ exit åˆ—å‡ºæ‰€æœ‰çš„è¿è¡Œçš„å®¹å™¨ yukino@Yukinos-Mac-mini î‚° ~ î‚° docker ps #æ­£åœ¨è¿è¡Œçš„å®¹å™¨ CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES yukino@Yukinos-Mac-mini î‚° ~ î‚° docker ps -a # åˆ—å‡ºå½“å‰æ­£åœ¨è¿è¡Œæ¸¸æˆ + å†å²è¿è¡Œè¿‡çš„å®¹å™¨ CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 58058be7aaee centos &quot;/bin/sh&quot; About a minute ago Exited (0) 11 seconds ago friendly_khorana d163d1d78b57 centos &quot;/bin/sh&quot; 2 minutes ago Exited (0) About a minute ago charming_curie 4a7f75643f52 centos &quot;/bin/zsh&quot; 3 minutes ago Created objective_ellis f8639e957394 centos &quot;/bin/sh&quot; 3 minutes ago Exited (0) 3 minutes ago reverent_wing 76a01cac119f bf756fb1ae65 &quot;/hello&quot; 2 hours ago Exited (0) 2 hours ago frosty_edison # å¯é€‰é¡¹ -a, --all Show all containers (default shows just running) -f, --filter filter Filter output based on conditions provided --format string Pretty-print containers using a Go template -n, --last int Show n last created containers (includes all states) (default -1) -l, --latest Show the latest created container (includes all states) --no-trunc Don&#39;t truncate output -q, --quiet Only display container IDs -s, --size Display total file sizes å®¹å™¨é€€å‡º exit # å®¹å™¨åœæ­¢é€€å‡º cmd(ä¸­é—´é‚£ä¸ªé”®) + p + q #å®¹å™¨ä¸åœæ­¢é€€å‡º åˆ é™¤å®¹å™¨ docker rm å®¹å™¨id #åˆ é™¤æŒ‡å®šå®¹å™¨ï¼Œä¸èƒ½åˆ é™¤æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼Œ -f å¼ºåˆ¶åˆ é™¤ docker rm -f $(docker ps -aq) #åˆ é™¤æ‰€æœ‰å®¹å™¨ docker ps -a -q|xargs docker rm -f #åˆ é™¤æ‰€æœ‰å®¹å™¨ å¯åŠ¨å’Œåœæ­¢å®¹å™¨çš„æ“ä½œ docker start å®¹å™¨id # å¯åŠ¨å®¹å™¨ docker restart å®¹å™¨id # é‡å¯å®¹å™¨ docker stop å®¹å™¨id # åœæ­¢å®¹å™¨ docker kill å®¹å™¨id # å¼ºåˆ¶åœæ­¢å½“å‰å®¹å™¨ 2.2.5 å¸¸ç”¨å…¶ä»–å‘½ä»¤åå°å¯åŠ¨å®¹å™¨ yukino@Yukinos-Mac-mini î‚° ~ î‚° docker run -d centos # åå°å¯åŠ¨å®¹å™¨ 0ed9981b2b99a49d7a6badda06d6b5214adf7f4abd12e69b59a3740944c86da2 yukino@Yukinos-Mac-mini î‚° ~ î‚° docker ps # å‘ç°æ²¡æœ‰èµ·æ¥ CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES # docker å®¹å™¨ä½¿ç”¨åå°è¿è¡Œï¼Œå¿…é¡»è¦ä¸€ä¸ªå‰å°è¿›ç¨‹ï¼Œdockerå‘ç°æ²¡æœ‰åº”ç”¨ï¼Œå°±ä¼šè‡ªåŠ¨åœæ­¢ # nginx å®¹å™¨å¯åŠ¨åï¼Œå‘ç°è‡ªå·±æ²¡æœ‰æä¾›æœåŠ¡ï¼Œå°±ä¼šç«‹åˆ»åœæ­¢ï¼Œå°±æ˜¯æ²¡æœ‰ç¨‹åºäº† æŸ¥çœ‹æ—¥å¿— # è‡ªå·±ç¼–å†™ä¸€æ®µshellè„šæœ¬ yukino@Yukinos-Mac-mini î‚° ~ î‚° docker run -d centos /bin/sh -c &quot;while true;do echo hello;sleep 1;done&quot; 7e367211d5e06cf782c23ed36e8bd915e79c7d37290f340b08f49c121ac13859 # æŸ¥çœ‹å®¹å™¨ yukino@Yukinos-Mac-mini î‚° ~ î‚° docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 7e367211d5e0 centos &quot;/bin/sh -c &#39;while tâ€¦&quot; 6 seconds ago Up 5 seconds mystifying_ardinghelli # æŸ¥çœ‹log yukino@Yukinos-Mac-mini î‚° ~ î‚° docker logs -tf --tail 10 7e367211d5e0 2021-01-11T16:03:59.195128830Z hello 2021-01-11T16:04:00.197724751Z hello 2021-01-11T16:04:01.200070913Z hello 2021-01-11T16:04:02.204645447Z hello 2021-01-11T16:04:03.209292239Z hello # å¯é€‰é¡¹ Options: --details Show extra details provided to logs -f, --follow Follow log output --since string Show logs since timestamp (e.g. 2013-01-02T13:23:37Z) or relative (e.g. 42m for 42 minutes) -n, --tail string Number of lines to show from the end of the logs (default &quot;all&quot;) -t, --timestamps Show timestamps --until string Show logs before a timestamp (e.g. 2013-01-02T13:23:37Z) or relative (e.g. 42m for 42 minutes) æŸ¥çœ‹å®¹å™¨ä¸­çš„è¿›ç¨‹ä¿¡æ¯ yukino@Yukinos-Mac-mini î‚° ~ î‚° docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 7e367211d5e0 centos &quot;/bin/sh -c &#39;while tâ€¦&quot; 5 minutes ago Up 5 minutes mystifying_ardinghelli # æŸ¥çœ‹è¿›ç¨‹ä¿¡æ¯ yukino@Yukinos-Mac-mini î‚° ~ î‚° docker top 7e367211d5e0 PID USER TIME COMMAND 3248 root 0:00 /bin/sh -c while true;do echo hello;sleep 1;done 3641 root 0:00 {sleep} /usr/bin/coreutils --coreutils-prog-shebang=sleep /usr/bin/sleep 1 æŸ¥çœ‹é•œåƒå…ƒæ•°æ® docker inspect 7e367211d5e0 [ { &quot;Id&quot;: &quot;7e367211d5e06cf782c23ed36e8bd915e79c7d37290f340b08f49c121ac13859&quot;, &quot;Created&quot;: &quot;2021-01-11T16:03:29.779361521Z&quot;, &quot;Path&quot;: &quot;/bin/sh&quot;, &quot;Args&quot;: [ &quot;-c&quot;, &quot;while true;do echo hello;sleep 1;done&quot; ], &quot;State&quot;: { &quot;Status&quot;: &quot;running&quot;, &quot;Running&quot;: true, &quot;Paused&quot;: false, &quot;Restarting&quot;: false, &quot;OOMKilled&quot;: false, &quot;Dead&quot;: false, &quot;Pid&quot;: 3248, &quot;ExitCode&quot;: 0, &quot;Error&quot;: &quot;&quot;, &quot;StartedAt&quot;: &quot;2021-01-11T16:03:30.085701324Z&quot;, &quot;FinishedAt&quot;: &quot;0001-01-01T00:00:00Z&quot; }, &quot;Image&quot;: &quot;sha256:300e315adb2f96afe5f0b2780b87f28ae95231fe3bdd1e16b9ba606307728f55&quot;, &quot;ResolvConfPath&quot;: &quot;/var/lib/docker/containers/7e367211d5e06cf782c23ed36e8bd915e79c7d37290f340b08f49c121ac13859/resolv.conf&quot;, &quot;HostnamePath&quot;: &quot;/var/lib/docker/containers/7e367211d5e06cf782c23ed36e8bd915e79c7d37290f340b08f49c121ac13859/hostname&quot;, &quot;HostsPath&quot;: &quot;/var/lib/docker/containers/7e367211d5e06cf782c23ed36e8bd915e79c7d37290f340b08f49c121ac13859/hosts&quot;, &quot;LogPath&quot;: &quot;/var/lib/docker/containers/7e367211d5e06cf782c23ed36e8bd915e79c7d37290f340b08f49c121ac13859/7e367211d5e06cf782c23ed36e8bd915e79c7d37290f340b08f49c121ac13859-json.log&quot;, &quot;Name&quot;: &quot;/mystifying_ardinghelli&quot;, &quot;RestartCount&quot;: 0, &quot;Driver&quot;: &quot;overlay2&quot;, &quot;Platform&quot;: &quot;linux&quot;, &quot;MountLabel&quot;: &quot;&quot;, &quot;ProcessLabel&quot;: &quot;&quot;, &quot;AppArmorProfile&quot;: &quot;&quot;, &quot;ExecIDs&quot;: null, &quot;HostConfig&quot;: { &quot;Binds&quot;: null, &quot;ContainerIDFile&quot;: &quot;&quot;, &quot;LogConfig&quot;: { &quot;Type&quot;: &quot;json-file&quot;, &quot;Config&quot;: {} }, &quot;NetworkMode&quot;: &quot;default&quot;, &quot;PortBindings&quot;: {}, &quot;RestartPolicy&quot;: { &quot;Name&quot;: &quot;no&quot;, &quot;MaximumRetryCount&quot;: 0 }, &quot;AutoRemove&quot;: false, &quot;VolumeDriver&quot;: &quot;&quot;, &quot;VolumesFrom&quot;: null, &quot;CapAdd&quot;: null, &quot;CapDrop&quot;: null, &quot;Capabilities&quot;: null, &quot;Dns&quot;: [], &quot;DnsOptions&quot;: [], &quot;DnsSearch&quot;: [], &quot;ExtraHosts&quot;: null, &quot;GroupAdd&quot;: null, &quot;IpcMode&quot;: &quot;private&quot;, &quot;Cgroup&quot;: &quot;&quot;, &quot;Links&quot;: null, &quot;OomScoreAdj&quot;: 0, &quot;PidMode&quot;: &quot;&quot;, &quot;Privileged&quot;: false, &quot;PublishAllPorts&quot;: false, &quot;ReadonlyRootfs&quot;: false, &quot;SecurityOpt&quot;: null, &quot;UTSMode&quot;: &quot;&quot;, &quot;UsernsMode&quot;: &quot;&quot;, &quot;ShmSize&quot;: 67108864, &quot;Runtime&quot;: &quot;runc&quot;, &quot;ConsoleSize&quot;: [ 0, 0 ], &quot;Isolation&quot;: &quot;&quot;, &quot;CpuShares&quot;: 0, &quot;Memory&quot;: 0, &quot;NanoCpus&quot;: 0, &quot;CgroupParent&quot;: &quot;&quot;, &quot;BlkioWeight&quot;: 0, &quot;BlkioWeightDevice&quot;: [], &quot;BlkioDeviceReadBps&quot;: null, &quot;BlkioDeviceWriteBps&quot;: null, &quot;BlkioDeviceReadIOps&quot;: null, &quot;BlkioDeviceWriteIOps&quot;: null, &quot;CpuPeriod&quot;: 0, &quot;CpuQuota&quot;: 0, &quot;CpuRealtimePeriod&quot;: 0, &quot;CpuRealtimeRuntime&quot;: 0, &quot;CpusetCpus&quot;: &quot;&quot;, &quot;CpusetMems&quot;: &quot;&quot;, &quot;Devices&quot;: [], &quot;DeviceCgroupRules&quot;: null, &quot;DeviceRequests&quot;: null, &quot;KernelMemory&quot;: 0, &quot;KernelMemoryTCP&quot;: 0, &quot;MemoryReservation&quot;: 0, &quot;MemorySwap&quot;: 0, &quot;MemorySwappiness&quot;: null, &quot;OomKillDisable&quot;: false, &quot;PidsLimit&quot;: null, &quot;Ulimits&quot;: null, &quot;CpuCount&quot;: 0, &quot;CpuPercent&quot;: 0, &quot;IOMaximumIOps&quot;: 0, &quot;IOMaximumBandwidth&quot;: 0, &quot;MaskedPaths&quot;: [ &quot;/proc/asound&quot;, &quot;/proc/acpi&quot;, &quot;/proc/kcore&quot;, &quot;/proc/keys&quot;, &quot;/proc/latency_stats&quot;, &quot;/proc/timer_list&quot;, &quot;/proc/timer_stats&quot;, &quot;/proc/sched_debug&quot;, &quot;/proc/scsi&quot;, &quot;/sys/firmware&quot; ], &quot;ReadonlyPaths&quot;: [ &quot;/proc/bus&quot;, &quot;/proc/fs&quot;, &quot;/proc/irq&quot;, &quot;/proc/sys&quot;, &quot;/proc/sysrq-trigger&quot; ] }, &quot;GraphDriver&quot;: { &quot;Data&quot;: { &quot;LowerDir&quot;: &quot;/var/lib/docker/overlay2/acddf2185fe63f216521b671abaeca46264f46939e439026c4b0a6151da02c5d-init/diff:/var/lib/docker/overlay2/329520e3e0d88d8454fba204a80c88b7f6ef891bb8dbd6691761ac4d95c5177d/diff&quot;, &quot;MergedDir&quot;: &quot;/var/lib/docker/overlay2/acddf2185fe63f216521b671abaeca46264f46939e439026c4b0a6151da02c5d/merged&quot;, &quot;UpperDir&quot;: &quot;/var/lib/docker/overlay2/acddf2185fe63f216521b671abaeca46264f46939e439026c4b0a6151da02c5d/diff&quot;, &quot;WorkDir&quot;: &quot;/var/lib/docker/overlay2/acddf2185fe63f216521b671abaeca46264f46939e439026c4b0a6151da02c5d/work&quot; }, &quot;Name&quot;: &quot;overlay2&quot; }, &quot;Mounts&quot;: [], &quot;Config&quot;: { &quot;Hostname&quot;: &quot;7e367211d5e0&quot;, &quot;Domainname&quot;: &quot;&quot;, &quot;User&quot;: &quot;&quot;, &quot;AttachStdin&quot;: false, &quot;AttachStdout&quot;: false, &quot;AttachStderr&quot;: false, &quot;Tty&quot;: false, &quot;OpenStdin&quot;: false, &quot;StdinOnce&quot;: false, &quot;Env&quot;: [ &quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot; ], &quot;Cmd&quot;: [ &quot;/bin/sh&quot;, &quot;-c&quot;, &quot;while true;do echo hello;sleep 1;done&quot; ], &quot;Image&quot;: &quot;centos&quot;, &quot;Volumes&quot;: null, &quot;WorkingDir&quot;: &quot;&quot;, &quot;Entrypoint&quot;: null, &quot;OnBuild&quot;: null, &quot;Labels&quot;: { &quot;org.label-schema.build-date&quot;: &quot;20201204&quot;, &quot;org.label-schema.license&quot;: &quot;GPLv2&quot;, &quot;org.label-schema.name&quot;: &quot;CentOS Base Image&quot;, &quot;org.label-schema.schema-version&quot;: &quot;1.0&quot;, &quot;org.label-schema.vendor&quot;: &quot;CentOS&quot; } }, &quot;NetworkSettings&quot;: { &quot;Bridge&quot;: &quot;&quot;, &quot;SandboxID&quot;: &quot;273cc9e3080fa62dc986a5c0b8da4ef8c86edaa2f7af92a241e388638c7647c6&quot;, &quot;HairpinMode&quot;: false, &quot;LinkLocalIPv6Address&quot;: &quot;&quot;, &quot;LinkLocalIPv6PrefixLen&quot;: 0, &quot;Ports&quot;: {}, &quot;SandboxKey&quot;: &quot;/var/run/docker/netns/273cc9e3080f&quot;, &quot;SecondaryIPAddresses&quot;: null, &quot;SecondaryIPv6Addresses&quot;: null, &quot;EndpointID&quot;: &quot;d147d056858d03efcdb9ce0a1a14552873ebe1c87c55514523def2dc879b206b&quot;, &quot;Gateway&quot;: &quot;172.17.0.1&quot;, &quot;GlobalIPv6Address&quot;: &quot;&quot;, &quot;GlobalIPv6PrefixLen&quot;: 0, &quot;IPAddress&quot;: &quot;172.17.0.2&quot;, &quot;IPPrefixLen&quot;: 16, &quot;IPv6Gateway&quot;: &quot;&quot;, &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;, &quot;Networks&quot;: { &quot;bridge&quot;: { &quot;IPAMConfig&quot;: null, &quot;Links&quot;: null, &quot;Aliases&quot;: null, &quot;NetworkID&quot;: &quot;7c3627e0ba0582a218c280f8fbb0bd6cca3d3325582b5cedd1b8b6410de986cd&quot;, &quot;EndpointID&quot;: &quot;d147d056858d03efcdb9ce0a1a14552873ebe1c87c55514523def2dc879b206b&quot;, &quot;Gateway&quot;: &quot;172.17.0.1&quot;, &quot;IPAddress&quot;: &quot;172.17.0.2&quot;, &quot;IPPrefixLen&quot;: 16, &quot;IPv6Gateway&quot;: &quot;&quot;, &quot;GlobalIPv6Address&quot;: &quot;&quot;, &quot;GlobalIPv6PrefixLen&quot;: 0, &quot;MacAddress&quot;: &quot;02:42:ac:11:00:02&quot;, &quot;DriverOpts&quot;: null } } } } ] è¿›å…¥å½“å‰æ­£åœ¨è¿è¡Œçš„å®¹å™¨ # æˆ‘ä»¬é€šå¸¸å®¹å™¨éƒ½æ˜¯ä½¿ç”¨åå°æ–¹å¼è¿è¡Œçš„ï¼Œéœ€è¦è¿›å…¥å®¹å™¨ï¼Œä¿®æ”¹ä¸€äº›é…ç½® yukino@Yukinos-Mac-mini î‚° ~ î‚° docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 7e367211d5e0 centos &quot;/bin/sh -c &#39;while tâ€¦&quot; 13 minutes ago Up 13 minutes mystifying_ardinghelli # æ–¹å¼1:ä»¥äº¤äº’æ¨¡å¼è¿›å…¥å®¹å™¨ yukino@Yukinos-Mac-mini î‚° ~ î‚° docker exec -it 7e367211d5e0 /bin/bash [root@7e367211d5e0 /]# ps -ef UID PID PPID C STIME TTY TIME CMD root 1 0 0 16:03 ? 00:00:00 /bin/sh -c while true;do echo hello;sleep 1;done root 864 0 0 16:17 pts/0 00:00:00 /bin/bash root 1023 1 0 16:20 ? 00:00:00 /usr/bin/coreutils --coreutils-prog-shebang=sleep /usr/bin/sleep 1 root 1024 864 0 16:20 pts/0 00:00:00 ps -ef # æ–¹å¼2: docker attach yukino@Yukinos-Mac-mini î‚° ~ î‚° docker attach e367211d5e æ­£åœ¨æ‰§è¡Œå½“å‰çš„ä»£ç  # docker exec # è¿›å…¥å®¹å™¨å¼€å¯ä¸€ä¸ªæ–°çš„ç»ˆç«¯ï¼Œå¯ä»¥åœ¨é‡Œé¢æ“ä½œ(å¸¸ç”¨) # docker attach # è¿›å…¥å®¹å™¨æ­£åœ¨æ‰§è¡Œçš„ç»ˆç«¯ï¼Œä¸ä¼šå¯åŠ¨æ–°çš„è¿›ç¨‹ ä»å®¹å™¨å†…æ‹·è´æ–‡ä»¶åˆ°ä¸»æœºä¸Š docker cp f03fddef487a:/home/tmp.md . # æ‹·è´æ˜¯ä¸€ä¸ªæ‰‹åŠ¨è¿‡ç¨‹ï¼Œæœªæ¥æˆ‘ä»¬é€šè¿‡-V å·çš„æŠ€æœ¯ï¼Œå¯ä»¥å®ç°è‡ªåŠ¨åŒæ­¥ /home /home 2.2.6 docker å‘½ä»¤å°ç»“ 2.2.7 docker tomcatå¯åŠ¨# å®˜æ–¹ä½¿ç”¨ docker run -it --rm tomcat:9.0# ä¸€èˆ¬ç”¨æ¥æµ‹è¯•ï¼Œç”¨å®Œå°±åˆ é™¤å®¹æ˜“(é•œåƒè¿˜åœ¨)ï¼Œä¸€èˆ¬ä¸è¿™æ ·ç”¨ # ä¸‹è½½å¯åŠ¨ docker pull tomcat:9.0 #å¯åŠ¨è¿è¡Œ docker run -d -p 3355:8080 --name tomcat01 tomcat:9.0 #åå°å¯åŠ¨ï¼Œå®¿ä¸»æœºç«¯å£æ˜ å°„3355æ˜ å°„åˆ°å®¹å™¨ç«¯å£8080 # å‘ç°æµè§ˆå™¨è®¿é—® http://localhost:3355/ å‡ºé”™ã€‚ #è¿›å…¥tomcat docker exec -it tomcat01 /bin/sh è¿›å…¥ tomcatä¸‹çš„webappsï¼Œå‘ç°ä¸ºç©º # æ‹·è´å†…å®¹ï¼Œåˆ·æ–°æµè§ˆå™¨è®¿é—® http://localhost:3355/ï¼ŒæˆåŠŸ cp -r webapps.dist/* webapps/ 2.2.8 å¯è§†åŒ–portainer docker run -d -p 8088:9000 \\ --restart=always -v /var/run/docker.sock:/var/run/docker.sock --privileged=true portainer/portainer 2.2.9 commit é•œåƒ# å¯åŠ¨å®¹å™¨ docker run -it -p 8080:8080 tomcat:9.0 # è¿›å…¥å®¹å™¨ docker exec -it d239c0637046 /bin/sh # æ·»åŠ webappsåº”ç”¨ cp -r webapps.dist/* webapps/ # commit æˆä¸€ä¸ªæ–°é•œåƒ yukino@Yukinos-Mac-mini î‚° ~ î‚° docker commit -a=&quot;yukino&quot; -m=&quot;add webapps app&quot; d239c0637046 tomcat02:1.0 sha256:98532da3cc1bbd014972e720081c187023f2172f9caaced66e94cd2f5c48b85c yukino@Yukinos-Mac-mini î‚° ~ î‚° docker images REPOSITORY TAG IMAGE ID CREATED SIZE tomcat02 1.0 98532da3cc1b 5 seconds ago 653MB # ä½¿ç”¨ä¸€ä¸ªæ–°é•œåƒ docker run -it -p 8081:8080 tomcat02:1.0 3. å®¹å™¨æ•°æ®å·3.1 ä½¿ç”¨å·æŠ€æœ¯docker run -it -v ä¸»æœºç›®å½•:å®¹å™¨ç›®å½• docker run -it -v /Users/yukino/Desktop/temp/test:/home centos /bin/sh # æŸ¥çœ‹æŒ‚è½½ä¿¡æ¯ docker inspect 5f48c7d36c11 &quot;Mounts&quot;: [ { &quot;Type&quot;: &quot;bind&quot;, &quot;Source&quot;: &quot;/Users/yukino/Desktop/temp/test&quot;, &quot;Destination&quot;: &quot;/home&quot;, &quot;Mode&quot;: &quot;&quot;, &quot;RW&quot;: true, &quot;Propagation&quot;: &quot;rprivate&quot; } ], ä¸¤ä¸ªæ–‡ä»¶å¤¹æ•°æ®å…±äº«,å°†å®¹å™¨åˆ é™¤æ‰ï¼Œæ•°æ®ä¾ç„¶èƒ½å¤Ÿä¿å­˜ 3.2 mysql# å®˜æ–¹æµ‹è¯•ä»£ç  docker run --name some-mysql -v /my/own/datadir:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=my-secret-pw -d mysql:tag -d åå°è¿è¡Œ -p ç«¯å£æ˜ å°„ -v å·æŒ‚è½½ -e ç¯å¢ƒé…ç½® --name å®¹å™¨å # docker run -d -p 3310:3306 -v /Users/yukino/Desktop/temp/mysql/conf:/etc/mysql/conf.d -v /Users/yukino/Desktop/temp/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql01 mysql:8.0 3.3 å…·åå’ŒåŒ¿åæŒ‚è½½docker volume Commands: create Create a volume inspect Display detailed information on one or more volumes ls List volumes prune Remove all unused local volumes rm Remove one or more volumes # æŸ¥çœ‹æ‰€æœ‰volume docker volume ls # åŒ¿åæŒ‚è½½ yukino@Yukinos-Mac-mini î‚° ~/Desktop/temp/mysql/data î‚° docker run -d -P --name nginx01 -v /etc/nginx nginx yukino@Yukinos-Mac-mini î‚° ~/Desktop/temp/mysql/data î‚° docker volume ls DRIVER VOLUME NAME local 3510004e6812e29dbbbda68b229b61e8cda715d573eef744bd470843014bea88 local 8388160e20f4753e11b20d159c0eca0eb8f269fdbe1e37274874bf0dc85871e9 # åŒ¿åæŒ‚è½½æŒ‚è½½å³ -v åªå†™äº†å®¹å™¨å†…çš„è·¯å¾„ï¼Œæ²¡æœ‰å†™å®¹å™¨å¤–çš„è·¯å¾„ # å…·åæŒ‚è½½ -v å·å:å®¹å™¨è·¯å¾„ yukino@Yukinos-Mac-mini î‚° ~/Desktop/temp/mysql/data î‚° docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx nginx 9656638bbc24aabdfc5961eaa7824c508b6fb7e152c78ab16b7af50dcc3f7a92 yukino@Yukinos-Mac-mini î‚° ~/Desktop/temp/mysql/data î‚° docker volume ls DRIVER VOLUME NAME local 3510004e6812e29dbbbda68b229b61e8cda715d573eef744bd470843014bea88 local 8388160e20f4753e11b20d159c0eca0eb8f269fdbe1e37274874bf0dc85871e9 local juming-nginx # é€šè¿‡å·åï¼ŒæŸ¥çœ‹å·ä¿¡æ¯ yukino@Yukinos-Mac-mini î‚° ~/Desktop/temp/mysql/data î‚° docker volume inspect juming-nginx [ { &quot;CreatedAt&quot;: &quot;2021-01-12T16:36:27Z&quot;, &quot;Driver&quot;: &quot;local&quot;, &quot;Labels&quot;: null, &quot;Mountpoint&quot;: &quot;/var/lib/docker/volumes/juming-nginx/_data&quot;, &quot;Name&quot;: &quot;juming-nginx&quot;, &quot;Options&quot;: null, &quot;Scope&quot;: &quot;local&quot; } ] å¦‚ä½•ç¡®å®šæ˜¯å…·åè¿˜æ˜¯åŒ¿å -v å®¹å™¨å†…è·¯å¾„ # åŒ¿å -v å·å:å®¹å™¨å†…è·¯å¾„ # å…·å -v /å®¿ä¸»æœºè·¯å¾„:å®¹å™¨å†…è·¯å¾„ # æŒ‡å®šæŒ‚è½½è·¯å¾„ æ‹“å±• docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx:ro nginx # ro åªè¯» docker run -d -P --name nginx02 -v juming-nginx:/etc/nginx:ro nginx # rw å¯è¯»å¯å†™ # ä¸€æ—¦è¿™ä¸ªè®¾ç½®äº†å®¹å™¨æƒé™ï¼Œå®¹å™¨å¯¹æˆ‘ä»¬æŒ‚è½½å‡ºæ¥çš„å†…å®¹å°±æœ‰é™å®šäº† # ro åªè¦çœ‹åˆ°è¯´æ˜è¿™ä¸ªè·¯å¾„åªèƒ½é€šè¿‡å®¿ä¸»æœºæ¥æ“ä½œï¼Œå®¹å™¨å†…éƒ¨æ˜¯æ— æ³•æ“ä½œçš„ 3.4 Docker file æŒ‚è½½# dockerfile å†…å®¹ # åŸºäºcentosé•œåƒ FROM centos # æŒ‚è½½ä¸¤ä¸ªåŒ¿åå· VOLUME [&quot;volume01&quot;,&quot;volume02&quot;] # è¾“å‡ºecho CMD echo &quot;---end---&quot; CMD /bin/bash #è¿™é‡Œçš„æ¯ä¸ªå‘½ä»¤éƒ½æ˜¯é•œåƒçš„ä¸€å±‚ # ç”Ÿæˆé•œåƒ docker build -f dockerfile1 -t yukinocentos:1.0 . #æ‰§è¡Œé•œåƒ âœ˜ yukino@Yukinos-Mac-mini î‚° ~/Desktop/temp/dockerfile î‚° docker run -it yukinocentos:1.0 /bin/sh sh-4.4# ls bin dev etc home lib lib64 lost+found media mnt opt proc root run sbin srv sys tmp usr var volume01 volume02 # æŒ‚è½½çš„é•œåƒ # é€€å‡ºæŸ¥çœ‹åŸæ•°æ® yukino@Yukinos-Mac-mini î‚° ~/Desktop/temp/test î‚° docker ps CONTAINER ID IMAGE COMMAND CREATED STATUS PORTS NAMES 1c6ec60a439f yukinocentos:1.0 &quot;/bin/sh&quot; 2 minutes ago Up 2 minutes #æŸ¥çœ‹åŸæ•°æ® docker inspect 1c6ec60a439f &quot;Mounts&quot;: [ { &quot;Type&quot;: &quot;volume&quot;, &quot;Name&quot;: &quot;e3002d4d1b7a1ea25504a7fdbdae8d1f103924c3b87930bb004a2e6c49259a67&quot;, &quot;Source&quot;: &quot;/var/lib/docker/volumes/e3002d4d1b7a1ea25504a7fdbdae8d1f103924c3b87930bb004a2e6c49259a67/_data&quot;, &quot;Destination&quot;: &quot;volume01&quot;, &quot;Driver&quot;: &quot;local&quot;, &quot;Mode&quot;: &quot;&quot;, &quot;RW&quot;: true, &quot;Propagation&quot;: &quot;&quot; }, { &quot;Type&quot;: &quot;volume&quot;, &quot;Name&quot;: &quot;3ecffa507747fce5d61ab4779ceb9ce1a458167829d63101ab89d332f93cd49c&quot;, &quot;Source&quot;: &quot;/var/lib/docker/volumes/3ecffa507747fce5d61ab4779ceb9ce1a458167829d63101ab89d332f93cd49c/_data&quot;, &quot;Destination&quot;: &quot;volume02&quot;, &quot;Driver&quot;: &quot;local&quot;, &quot;Mode&quot;: &quot;&quot;, &quot;RW&quot;: true, &quot;Propagation&quot;: &quot;&quot; } ], ä¸çŸ¥é“ä¸ºå•¥ï¼Œsource ç›®å½•åœ¨macä¸Šæ‰“ä¸å¼€ 3.5 æ•°æ®å·å®¹å™¨å¤šä¸ªmysqlå®¹å™¨ä¹‹é—´æ•°æ®åŒæ­¥ docker run -it --name docker01 yukinocentos:1.0 docker run -it --name docker02 --volumes-from docker01 yukinocentos:1.0 #ç›¸å½“äºdocker02ç»§æ‰¿äº†docker01 # ä¸¤ä¸ªå®¹å™¨çš„æ•°æ®å·volume01ä¸volume02åˆ†åˆ«åŒæ­¥ bin dev etc home lib lib64 lost+found media mnt opt proc root run sbin srv sys tmp usr var volume01 volume02 # åˆ›å»ºdocker03 docker run -it --name docker03 --volumes-from docker01 yukinocentos:1.0 docker01 docker02 docker03 æ•°æ®å·å…±äº« å½“åˆ é™¤docker01åï¼Œdocker02 docker03 æ•°æ®ä¾ç„¶å­˜åœ¨ 4. DockerFile4.1 å‘½ä»¤ æ¯ä¸ªæŒ‡ä»¤ï¼ˆå…³é”®å­—ï¼‰ éƒ½æ˜¯å¤§å†™å­—æ¯ FROM # åŸºç¡€é•œåƒï¼Œä¸€åˆ‡ä»è¿™é‡Œå¼€å§‹æ„å»º centos MAINTAINER # é•œåƒè°å†™çš„ï¼Œå§“å+é‚®ç®± RUN # é•œåƒæ„å»ºçš„æ—¶å€™éœ€è¦è¿è¡Œçš„å‘½ä»¤ ADD # æ­¥éª¤ï¼štomcaté•œåƒï¼Œè¿™ä¸ªtomcatå‹ç¼©åŒ…ï¼Œæ·»åŠ å†…å®¹ WORKDIR # è®¾ç½®é•œåƒçš„å·¥ä½œç›®å½• VOLUME # æŒ‚è½½çš„ç›®å½• EXPOSE # æŒ‡å®šå¯¹å¤–çš„ç«¯å£ RUN # å®¹å™¨å¯åŠ¨åè¦åšçš„äº‹ CMD # æŒ‡å®šå®¹å™¨å¯åŠ¨çš„æ—¶å€™è¦è¿è¡Œçš„å‘½ä»¤ï¼Œåªæœ‰æœ€åä¸€ä¸ªä¼šè¢«ç”Ÿæ•ˆ ENTRYPOINT # æŒ‡å®šè¿™ä¸ªå®¹å™¨çš„æ—¶å€™è¦è¿è¡Œçš„å‘½ä»¤ï¼Œå¯ä»¥è¿½åŠ å‘½ä»¤ ONBUILD # å½“æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿ DockerFile è¿™ä¸ªæ—¶å€™å°±ä¼šè¿è¡Œ ONBUILD çš„æŒ‡ä»¤ã€‚è§¦å‘æŒ‡ä»¤ COPY # ç±»ä¼¼ADDï¼Œå°†æ–‡ä»¶æ‹·è´åˆ°é•œåƒä¸­ ENV # æ„å»ºæ—¶è®¾ç½®ç¯å¢ƒå˜é‡ 4.2 æ„å»ºè‡ªå·±çš„centosDocker Hub ä¸­å¤§éƒ¨åˆ†é•œåƒéƒ½æ˜¯ä»è¿™ä¸ªåŸºç¡€é•œåƒè¿‡æ¥çš„FROM scratchï¼Œç„¶åå†æ„å»º FROM centos MAINTAINER yukino&lt;233@qq.com&gt; ENV MYPATH /usr/local WORKDIR $MYPATH RUN yum -y install vim RUN yum -y install net-tools EXPOSE 80 CMD echo $MYPATH CMD echo &quot;---end---&quot; CMD /bin/bash # æ„å»ºé•œåƒ yukino@Yukinos-Mac-mini î‚° ~/Desktop/temp/test î‚° docker build -f yukinocentos -t mycentos:0.1 . [+] Building 168.9s (8/8) FINISHED =&gt; [internal] load build definition from yukinocentos 0.0s =&gt; =&gt; transferring dockerfile: 241B 0.0s =&gt; [internal] load .dockerignore 0.0s =&gt; =&gt; transferring context: 2B 0.0s =&gt; [internal] load metadata for docker.io/library/centos:latest 0.0s =&gt; CACHED [1/4] FROM docker.io/library/centos 0.0s =&gt; [2/4] WORKDIR /usr/local 0.0s =&gt; [3/4] RUN yum -y install vim 163.2s =&gt; [4/4] RUN yum -y install net-tools 5.1s =&gt; exporting to image 0.5s =&gt; =&gt; exporting layers 0.5s =&gt; =&gt; writing image sha256:018a20376d20419103f1e2941e3d932fd376380551617692bf6bf336b5932ca4 0.0s =&gt; =&gt; naming to docker.io/library/mycentos:0.1 # å¯åŠ¨image yukino@Yukinos-Mac-mini î‚° ~/Desktop/temp/test î‚° docker run -it mycentos:0.1 [root@f2e629f64672 local]# pwd /usr/local # vim ifconfig å¯ä»¥ä½¿ç”¨äº† # æŸ¥çœ‹æ„å»ºè¿‡ç¨‹ docker history yukino@Yukinos-Mac-mini î‚° ~/Desktop/temp/test î‚° docker history mycentos:0.1 IMAGE CREATED CREATED BY SIZE COMMENT 018a20376d20 4 minutes ago CMD [&quot;/bin/sh&quot; &quot;-c&quot; &quot;/bin/bash&quot;] 0B buildkit.dockerfile.v0 &lt;missing&gt; 4 minutes ago CMD [&quot;/bin/sh&quot; &quot;-c&quot; &quot;echo \\&quot;---end---\\&quot;&quot;] 0B buildkit.dockerfile.v0 &lt;missing&gt; 4 minutes ago CMD [&quot;/bin/sh&quot; &quot;-c&quot; &quot;echo $MYPATH&quot;] 0B buildkit.dockerfile.v0 &lt;missing&gt; 4 minutes ago EXPOSE map[80/tcp:{}] 0B buildkit.dockerfile.v0 &lt;missing&gt; 4 minutes ago RUN /bin/sh -c yum -y install net-tools # buâ€¦ 14.4MB buildkit.dockerfile.v0 &lt;missing&gt; 4 minutes ago RUN /bin/sh -c yum -y install vim # buildkit 58.1MB buildkit.dockerfile.v0 &lt;missing&gt; 7 minutes ago WORKDIR /usr/local 0B buildkit.dockerfile.v0 &lt;missing&gt; 7 minutes ago ENV MYPATH=/usr/local 0B buildkit.dockerfile.v0 &lt;missing&gt; 7 minutes ago MAINTAINER yukino&lt;233@qq.com&gt; 0B buildkit.dockerfile.v0 &lt;missing&gt; 5 weeks ago /bin/sh -c #(nop) CMD [&quot;/bin/bash&quot;] 0B &lt;missing&gt; 5 weeks ago /bin/sh -c #(nop) LABEL org.label-schema.scâ€¦ 0B &lt;missing&gt; 5 weeks ago /bin/sh -c #(nop) ADD file:bd7a2aed6ede423b7â€¦ 209MB 4.3 CMD ä¸ ENTRYPOINTENTRYPOINT # æŒ‡å®šè¿™ä¸ªå®¹å™¨çš„æ—¶å€™è¦è¿è¡Œçš„å‘½ä»¤ï¼Œå¯ä»¥è¿½åŠ å‘½ä»¤ ONBUILD # å½“æ„å»ºä¸€ä¸ªè¢«ç»§æ‰¿ DockerFile è¿™ä¸ªæ—¶å€™å°±ä¼šè¿è¡Œ ONBUILD çš„æŒ‡ä»¤ã€‚è§¦å‘æŒ‡ä»¤ æµ‹è¯• CMD # DockerFile cmd-test yukino@Yukinos-Mac-mini î‚° ~/Desktop/temp/test î‚° cat cmd-test FROM centos CMD [&quot;ls&quot;,&quot;-a&quot;] # æ„å»ºé•œåƒ docker build -f cmd-test -t cmdtest . # æ‰§è¡Œ âœ˜ yukino@Yukinos-Mac-mini î‚° ~/Desktop/temp/test î‚° docker run -it cmdtest . .dockerenv dev home lib64 media opt root sbin sys usr .. bin etc lib lost+found mnt proc run srv tmp var # è¿½åŠ å‘½ä»¤,æŠ¥é”™, -l æ›¿æ¢äº† CMD [&quot;ls&quot;,&quot;-a&quot;]ï¼Œ -lä¸æ˜¯å‘½ä»¤ï¼Œæ‰€ä»¥æŠ¥é”™ yukino@Yukinos-Mac-mini î‚° ~/Desktop/temp/test î‚° docker run -it cmdtest -l docker: Error response from daemon: OCI runtime create failed: container_linux.go:370: starting container process caused: exec: &quot;-l&quot;: executable file not found in $PATH: unknown. # è¿½åŠ å‘½ä»¤ ls -al å¯è¡Œ âœ˜ yukino@Yukinos-Mac-mini î‚° ~/Desktop/temp/test î‚° docker run -it cmdtest ls -al total 56 drwxr-xr-x 1 root root 4096 Jan 13 15:28 . drwxr-xr-x 1 root root 4096 Jan 13 15:28 .. -rwxr-xr-x 1 root root 0 Jan 13 15:28 .dockerenv lrwxrwxrwx 1 root root 7 Nov 3 15:22 bin -&gt; usr/bin drwxr-xr-x 5 root root 360 Jan 13 15:28 dev drwxr-xr-x 1 root root 4096 Jan 13 15:28 etc drwxr-xr-x 2 root root 4096 Nov 3 15:22 home lrwxrwxrwx 1 root root 7 Nov 3 15:22 lib -&gt; usr/lib lrwxrwxrwx 1 root root 9 Nov 3 15:22 lib64 -&gt; usr/lib64 drwx------ 2 root root 4096 Dec 4 17:37 lost+found drwxr-xr-x 2 root root 4096 Nov 3 15:22 media drwxr-xr-x 2 root root 4096 Nov 3 15:22 mnt drwxr-xr-x 2 root root 4096 Nov 3 15:22 opt dr-xr-xr-x 148 root root 0 Jan 13 15:28 proc dr-xr-x--- 2 root root 4096 Dec 4 17:37 root drwxr-xr-x 11 root root 4096 Dec 4 17:37 run lrwxrwxrwx 1 root root 8 Nov 3 15:22 sbin -&gt; usr/sbin drwxr-xr-x 2 root root 4096 Nov 3 15:22 srv dr-xr-xr-x 13 root root 0 Jan 13 15:28 sys drwxrwxrwt 7 root root 4096 Dec 4 17:37 tmp drwxr-xr-x 12 root root 4096 Dec 4 17:37 usr drwxr-xr-x 20 root root 4096 Dec 4 17:37 var æµ‹è¯• ENTRYPOINT # Docker file yukino@Yukinos-Mac-mini î‚° ~/Desktop/temp/test î‚° cat dockerfile-entrypoint FROM centos ENTRYPOINT [&quot;ls&quot;,&quot;-a&quot;] # æ„å»º docker build -f dockerfile-entrypoint -t entrypointtest . # è¿½åŠ å‘½ä»¤ -l è¿½åŠ åˆ°äº† ENTRYPOINT [&quot;ls&quot;,&quot;-a&quot;]ï¼Œä¸ä¼šæŠ¥é”™ yukino@Yukinos-Mac-mini î‚° ~/Desktop/temp/test î‚° docker run -it entrypointtest -l total 56 drwxr-xr-x 1 root root 4096 Jan 13 15:32 . drwxr-xr-x 1 root root 4096 Jan 13 15:32 .. -rwxr-xr-x 1 root root 0 Jan 13 15:32 .dockerenv lrwxrwxrwx 1 root root 7 Nov 3 15:22 bin -&gt; usr/bin drwxr-xr-x 5 root root 360 Jan 13 15:32 dev drwxr-xr-x 1 root root 4096 Jan 13 15:32 etc drwxr-xr-x 2 root root 4096 Nov 3 15:22 home lrwxrwxrwx 1 root root 7 Nov 3 15:22 lib -&gt; usr/lib lrwxrwxrwx 1 root root 9 Nov 3 15:22 lib64 -&gt; usr/lib64 drwx------ 2 root root 4096 Dec 4 17:37 lost+found drwxr-xr-x 2 root root 4096 Nov 3 15:22 media drwxr-xr-x 2 root root 4096 Nov 3 15:22 mnt drwxr-xr-x 2 root root 4096 Nov 3 15:22 opt dr-xr-xr-x 150 root root 0 Jan 13 15:32 proc dr-xr-x--- 2 root root 4096 Dec 4 17:37 root drwxr-xr-x 11 root root 4096 Dec 4 17:37 run lrwxrwxrwx 1 root root 8 Nov 3 15:22 sbin -&gt; usr/sbin drwxr-xr-x 2 root root 4096 Nov 3 15:22 srv dr-xr-xr-x 13 root root 0 Jan 13 15:28 sys drwxrwxrwt 7 root root 4096 Dec 4 17:37 tmp drwxr-xr-x 12 root root 4096 Dec 4 17:37 usr drwxr-xr-x 20 root root 4096 Dec 4 17:37 var 4.4 æ„å»ºtomcat 5.å‘å¸ƒé•œåƒ5.1 é˜¿é‡Œäº‘ è¿›å…¥é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡ï¼Œåˆ›å»ºé•œåƒä»“åº“ push åˆ° é˜¿é‡Œäº‘çš„æ­¥éª¤å‚è€ƒ é˜¿é‡Œäº‘é‡Œé¢çš„æ“ä½œæ­¥éª¤å³å¯ 6.docker ç½‘ç»œ# è¿è¡Œå®¹å™¨ docker run -d -P --name tomcat01 tomcat # æ‰§è¡Œ ip addr docker exec -it c864d7b91d46 ip addr 1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000 link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00 inet 127.0.0.1/8 scope host lo valid_lft forever preferred_lft forever 2: tunl0@NONE: &lt;NOARP&gt; mtu 1480 qdisc noop state DOWN group default qlen 1000 link/ipip 0.0.0.0 brd 0.0.0.0 3: ip6tnl0@NONE: &lt;NOARP&gt; mtu 1452 qdisc noop state DOWN group default qlen 1000 link/tunnel6 :: brd :: 50: eth0@if51: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default link/ether 02:42:ac:11:00:02 brd ff:ff:ff:ff:ff:ff link-netnsid 0 inet 172.17.0.2/16 brd 172.17.255.255 scope global eth0 valid_lft forever preferred_lft forever","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"docker","slug":"docker","permalink":"/tags/docker/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Daily Review 2020-12","slug":"ç”Ÿæ´»/Daily Review - 202012","date":"2020-12-31T03:30:00.000Z","updated":"2022-10-09T15:19:10.437Z","comments":true,"path":"2020/12/31/ç”Ÿæ´»/Daily Review - 202012/","link":"","permalink":"/2020/12/31/ç”Ÿæ´»/Daily Review - 202012/","excerpt":"","text":"leetcode è¯´æ˜ *(çœ‹äº†ä¸€åŠ) !(å¤šè§£æœªçœ‹å®Œ) .è·³è¿‡ 1 2 3 4(*) 5 6 7 8 9 10(.) 11 12 13 14 15 16 17(.) 18 19(.) 20 21 â€¦ 26 27 28 175 176 177 178 180 181 182 183 184 185 186 197 262 595 596 601 620 626 627 1179 2020-12-29 ä¸‹ç­æ—¶é—´ 22:00 23:20 - 2:00 spring Boot å­¦ä¹  å¦‚æœèƒ½å†…éƒ¨è½¬å²—å°±å¥½äº†ï¼Œç•™ç»™æˆ‘å­¦ä¹ çš„æ—¶é—´ä¸å¤šäº†ã€‚ 2020-12-28 ä¸‹ç­æ—¶é—´ 23:00 code review 00:00 - 1:50 BootStrap ä½¿ç”¨ å‚»é€¼æµ‹è¯•ï¼Œå¡æˆ‘str4 2020-12-27 å¼€å§‹spring Booté¡¹ç›®å­¦ä¹ ï¼Œä»14:00 - 1:00 github ä¸‰æ–¹ç™»å½• 2020-12-26 ä¸‹ç­æ—¶é—´ 19:00 éº»å°† + äºŒéº»é…’é¦† åˆ°å‡Œæ™¨2:00 2020-12-25 ä¸‹ç­æ—¶é—´ 22:00 2020-12-24 ä¸‹ç­æ—¶é—´ 22:00 code review 23:30 - 1:30 æŸäº›æµ‹è¯•æ˜¯å‚»å‰ï¼Œè¿˜æœ‰ä¸¤å¤©str4ç»™æˆ‘æ–°bugæ ‡è®°str4ï¼ŒçœŸtmæ¶å¿ƒäºº spring boot taskå­¦ä¹  2020-12-23 ä¸‹ç­æ—¶é—´ ~ code review 23:00 - 1:00 è¿åŠ¨æ—¥ï¼Œç¾½æ¯›çƒæ‰“äº†ä¸ªç—›å¿« spring Boot swaggerå­¦ä¹  2020-12-22 ä¸‹ç­æ—¶é—´ 21:15 code review 22:30 - 0:00 å­¦ä¹ äº† spring boot æ•´åˆ mybatis 2020-12-21 ä¸‹ç­æ—¶é—´ 22:00 code review 23:40 - 1:00 å­¦ä¹ äº†spring boot jdbcç”¨æ³• 2020-12-20 code review ä¸‹åˆ2ç‚¹ï¼Œé™†é™†ç»­ç»­åˆ°å‡Œæ™¨12:40 å°†spring Boot çš„ç¬¬ä¸€ä¸ªé¡¹ç›®å­¦ä¹ äº†ä¸€é 2020-12-19 åŠ ç­ åƒäº†å…”è‚‰ç«é”…ï¼ŒçœŸä¸é”™ æ‰“éº»å°†ï¼Œå¥‹æˆ˜åˆ°å‡Œæ™¨2ç‚¹ï¼Œåˆäº¤å­¦è´¹äº† å­¦ä¹  null 2020-12-18 null 2020-12-17 ä¸‹ç­æ—¶é—´ 20:40 code review 22:20 - 00:50 Spring Boot å­¦ä¹ ï¼Œæ„Ÿè§‰æ‰¾ä¸åˆ°ä¸€ä¸ªå¥½çš„æ•™ç¨‹ï¼Œè¿™äº›è§†é¢‘æ„Ÿè§‰æ·±äº•å†°ï¼ŒåŸºç¡€éƒ½æ²¡å­¦ï¼Œå°±å¼€å§‹å­¦æºç ï¼Œä¸€è„¸æ‡µé€¼ã€‚ 2020-12-16 ä¸‹ç­æ—¶é—´ 21:00 code review 23:00 - 1:00 Spring bootç»§ç»­è·Ÿè¿› 2020-12-15 ä¸‹ç­æ—¶é—´ 21:20 code review 23:00 -1:00 SpringBootæºç é…ç½®ok,å­¦ä¹ äº†SpringBootæºç çš„ä¸€ç‚¹è¯¾ç¨‹ï¼Œå¾ˆéš¾ è£…ä¿®é£æ ¼è§†é¢‘å­¦ä¹  2020-12-14 ä¸‹ç­æ—¶é—´ 20:20 code review 21:30 - 23:30 ä¸Šç­æ‘¸é±¼ å¤ä¹ ä¸‰é“ leetcode mysql å¼€å§‹å­¦ä¹ spring boot æºç ï¼Œç¯å¢ƒå‡†å¤‡ä¸­ è£…ä¿®é£æ ¼è§†é¢‘å­¦ä¹  2020-12-13 æœ¬åº”è‡ªå·±ç‚–æ±¤ï¼Œä½†æ˜¯æ‡’ï¼Œæ²¡æœ‰åšæŒ code review Spring Boot é‡æ–°å¼€å§‹ å®…äº†ä¸€å¤©ï¼Œå­¦ä¹ äº†Spring Bootçš„ä¸€äº›åŸºç¡€çŸ¥è¯†ï¼Œå‘ç°Spring Bootçš„æºç å¤ªéš¾äº†ï¼Œå¬è¯¾ä¸€è„¸æ‡µé€¼ã€‚ä¸Spring æºç ä¾èµ–å¾ˆå¤§ï¼Œç„¶è€Œä¹‹å‰æ…•è¯¾ç½‘ä»€ä¹ˆéƒ½æ²¡è®²ï¼ŒçœŸçš„æœäº†ã€‚ 2020-12-12 ä¸æœ‹å‹ç©ï¼Œç¾Šè‚‰æ±¤ä¸é”™ï¼Œå­¦ä¼šäº†æ‰“éº»å°†ï¼Œä¸€ç›´ç©åˆ°å‡Œæ™¨2ç‚¹ï¼Œæ€»ä¹‹å¾ˆä¹…æ²¡è¿™ä¹ˆå¼€å¿ƒäº†ã€‚ code review null 2020-12-9 - 11 Bç«™å­¦ä¹ å°šç¡…è°·çš„spring bootï¼Œç‰ˆæœ¬å¤ªæ—§äº†ï¼Œå„ç§é—®é¢˜ã€‚å‡†å¤‡æ¢å­¦ä¹ èµ„æ–™äº†ã€‚ 2020-12-8 ä¸‹ç­æ—¶é—´ 20:30 code review 22:00 - 01:00 leetcode database [1179] æ—¥è¯­æ‰“å¡ æ…•è¯¾ç½‘çš„spring bootå±…ç„¶æ˜¯eclipseç‰ˆæœ¬ï¼ŒåŠé€€ï¼Œæ‰¾äº†Bç«™å°šç¡…è°·çš„è§†é¢‘ï¼Œå‘ç°åˆ«äººçš„è§†é¢‘æ—¢å…è´¹ï¼Œåˆè®²å¾—å¥½ã€‚ã€‚ã€‚é‡æ–°å¼€å§‹å­¦ä¹ spring boot è€ƒè™‘è¦ä¸è¦å°†æœ‰é“äº‘ç¬”è®°åˆ‡æ¢åˆ°Typora + åšæœäº‘ï¼Œæœ‰é“äº‘ç¬”è®°æ‰‹æœºç«¯å±…ç„¶æ²¡æœ‰å¤åˆ¶ç²˜è´´æ–‡ç« åŠŸèƒ½ï¼Œå¤ªæ‹‰å®äº†ã€‚ 2020-12-7 ä¸‹ç­æ—¶é—´ 21:30 code review 23:00 - 01:10 leetcode null æ—¥è¯­æ‰“å¡ å­¦ä¹ äº†spring bootçš„åŸºç¡€çŸ¥è¯†ï¼Œæ„Ÿè§‰spring bootæ¯”spring mvcç®€å•å¾ˆå¤šã€‚ 2020-12-6 code review å­¦ä¹ äº† leetcode database [601 620 626 627] Spring mvcå¤§æ¦‚æ¡†æ¶å·²ç»äº†è§£ï¼Œä¸‹ä¸€æ­¥å‡†å¤‡å­¦ä¹ spring bootï¼Œè¿™éƒ¨åˆ†æ˜¯é‡ç‚¹ã€‚ æ—¥è¯­ ankiæ‰“å¡ å­¦ä¹ äº†å±±è¯ç‚–æ’éª¨ï¼Œnice è¿™å‘¨å­¦ä¹ çš„æ—¶é—´è¿˜æ˜¯å¤ªå°‘äº†ï¼Œæ¥ä¸‹æ¥é‡ç‚¹ä»mysql è½¬ä¸º Java Web ä¸šåŠ¡ä»£ç  2020-12-5 ä¸‹ç­æ—¶é—´ 18:30 (å‘¨å…­åŠ ç­) code review å­¦ä¹ äº† leetcode database [197,262,595,596] æ—¥è¯­ ankiæ‰“å¡ 2020-12-4 ä¸‹ç­æ—¶é—´ 18:30 null 2020-12-3 ä¸‹ç­æ—¶é—´ 20:50 code review 22:00 - 23:50 å­¦ä¹ äº† leetcode database [184,185,186] æ—¥è¯­ ankiæ‰“å¡ ä»Šæ—¥å¿™äºè§£bugï¼Œæ— æš‡æ‘¸é±¼ 2020-12-2 ä¸‹ç­æ—¶é—´ 21:35 code reveiw 23:00 - 00:00 å­¦ä¹ äº† leetcode database [181,182,183] æ—¥è¯­ anki æ‰“å¡ è¿åŠ¨æ—¥æœªè¿åŠ¨ ä»Šæ—¥å¿™äºè§£bugï¼Œæ— æš‡æ‘¸é±¼ 2020-12-1 ä¸‹ç­æ—¶é—´21:00 code review 23:00 -00:30 å­¦ä¹ äº†leetcode database [175,176,177,178,180] æ—¥è¯­anki æ‰“å¡ ä¸Šç­åˆ·äº†ä¸¤é“ leetcode database èµšåˆ°äº† ä»Šæ—¥å¿™äºè§£bug ä»ä»Šå¤©å¼€å§‹è®°å½•æ¯æ—¥æ”¯å‡º","categories":[{"name":"ç”Ÿæ´»","slug":"ç”Ÿæ´»","permalink":"/categories/ç”Ÿæ´»/"}],"tags":[{"name":"Daily Review","slug":"Daily-Review","permalink":"/tags/Daily-Review/"}],"keywords":[{"name":"ç”Ÿæ´»","slug":"ç”Ÿæ´»","permalink":"/categories/ç”Ÿæ´»/"}]},{"title":"Daily Review 2020-11","slug":"ç”Ÿæ´»/Daily Review - 202011","date":"2020-12-01T03:30:00.000Z","updated":"2022-10-09T15:19:10.437Z","comments":true,"path":"2020/12/01/ç”Ÿæ´»/Daily Review - 202011/","link":"","permalink":"/2020/12/01/ç”Ÿæ´»/Daily Review - 202011/","excerpt":"","text":"leetcode è¯´æ˜ *(çœ‹äº†ä¸€åŠ) !(å¤šè§£æœªçœ‹å®Œ) .è·³è¿‡ 1 2 3 4(*) 5 6 7 8 9 10(.) 11 12 13 14 15 16 17(.) 18 19(.) 20 21 â€¦ 26 27 28 2020-11-30 ä¸‹ç­æ—¶é—´ 21:00 code review 22:40 - 00:40 leetcode null å¤ä¹ äº†Spring mvcçš„ç›¸å…³å†…å®¹ï¼Œä½†è¿˜æ˜¯æœ‰äº›é€»è¾‘æ²¡çœ‹æ‡‚ï¼Œéœ€è¦æ‰¾æ—¶é—´å†çœ‹ä¸€ä¸‹ã€‚ anki æ—¥è¯­æ‰“å¡ è·ç¦»ç¦»èŒä¸åˆ°4ä¸ªæœˆäº†ï¼Œä»»åŠ¡å¾ˆè‰°å·¨å‘€ã€‚å¾—æƒ³åŠæ³•ä¸Šç­å¤šçœ‹ä¹¦äº†ã€‚leetcodeå‡ ä¹åœæ»ä¸å‰ï¼Œä¸Šç­æŒ¤æ—¶é—´åˆ·é¢˜ã€‚ 2020-11-29 å‘¨å¤©æ åŸºçº¿å‡çº§é—®é¢˜ï¼Œæ‰“ä¹±äº†æˆ‘åšé¥­çš„è®¡åˆ’ï¼Œshift çœ‹äº†ä¸€ä¼šå„¿æ•°æ®åº“çš„å†…å®¹ï¼Œä¸äº 2020-11-28 æ’æŸ¥åŸºçº¿å‡çº§çš„é—®é¢˜ è·Ÿåˆä¸­åŒå­¦èšä¼šï¼Œkæ­Œ 2020-11-27 null 2020-11-26 null 2020-11-25 ä¸‹ç­æ—¶é—´ 22:40 æ—¥è¯­å®Œæˆ leetcode null 2020-11-21 - 2020-11-24 leetcode null å¤ä¹ äº†spring mvcå®æˆ˜é¡¹ç›® ä¸å¯å…¬å¼€çš„æƒ…æŠ¥ 2020-11-20 ä¸‹ç­æ—¶é—´ 21:00 code review null leetcode null æ—¥è¯­ anki æ‰“å¡å®Œæˆ å“”å“©å“”å“©è¶Šæ¥è¶Šæ— èŠäº†ã€‚æœ‰ç‚¹æƒ³ç©galgameäº†ã€‚ 2020-11-19 ä¸‹ç­æ—¶é—´ 21:00 code review 22:30 - 23:30 leetcode [31] æ—¥è¯­ anki æ‰“å¡å®Œæˆ æ²¡æœ‰è¿åŠ¨ï¼Œä¸Šç­éƒ½æ˜¯å†æµªè´¹æ—¶é—´ï¼Œå¥½æƒ³è·‘è·¯ã€‚ 2020-11-18 ä¸‹ç­æ—¶é—´ 21:30 leetcode [29] æ—¥è¯­ ankiç´¯è®¡æ¸…é›¶ code review 23:00 - 24:00 2020-11-12 - 2020-11-13 ä¸å¯å…¬å¼€çš„æƒ…æŠ¥ 2020-11-11 ä¸‹ç­æ—¶é—´ 20:30 leetcode [20 21 27 28] æ—¥è¯­å•è¯ï¼Œå®Œæˆ ä¸Šç­åˆ·äº†ä¸¤é“leetcodeï¼Œèµšåˆ°äº† ä¸€å°æ—¶ç¾½æ¯›çƒ æŠ“ä½åŒåä¸€çš„å°¾å·´ï¼ŒèŠ±äº† 300 +ï¼Œä¹°äº†effective java å’Œ ä¸€äº›é›¶é£Ÿ 2020-11-10 ä¸‹ç­æ—¶é—´ 20:30 leetcode [19] æ—¥è¯­å•è¯ï¼Œå®Œæˆ 2233æ•…å®«æ‰‹åŠå¿ä½æ²¡æœ‰å‰æ‰‹ 2020-11-9 ä¸‹ç­æ—¶é—´ 21:30 leetcode [18] æ—¥è¯­å•è¯ï¼Œå®Œæˆ 2020-11-8 æ²¡æœ‰leetcode ç¡åˆ°ä¸‹åˆ æ”¶æ‹¾äº†æˆ¿é—´ æ˜ŸæœŸä¸€å¼€å§‹è¦ç»§ç»­å­¦ä¹ leetcodeå’Œæ—¥è¯­äº† 2020-11-7 æ²¡æœ‰leetcode åªæœ‰åŠ ç­ Kæ­Œåˆ°å‡Œæ™¨ 2020-11-6 æ²¡æœ‰leetcode åªæœ‰åŠ ç­ 2020-11-6 æ²¡æœ‰leetcode æ²¡æœ‰æ—¥è¯­ åªæœ‰åŠ ç­ 2020-11-5 ä¸‹ç­æ—¶é—´ 23:00 code study 00: - 00:30 é¡¹ç›®å‡ºäº†ä¸¤ä¸ªå‡ºè´§å¿…è§£çš„bugï¼ŒåŠ ç­åˆ°23:00ï¼Œå¤´å¥½æ™•ï¼Œæ„Ÿè§‰å¿«åäº†ã€‚å®åœ¨æ— æ³•å­¦ä¹ äº†ï¼Œæ—©ç‚¹ä¼‘æ¯å§ã€‚ leetcodep[16]æ¶‰åŠæ ‘ï¼Œé€’å½’ï¼Œä¸‹æ¬¡å¥½å¥½çœ‹ä¸€ä¸‹ã€‚ 2020-11-4 ä¸‹ç­æ—¶é—´ 22:00 code study 23:00 - 00:50 leetcode [16] å­¦ä¹ äº†mysqlåŸºç¡€ã€‚ æ—¥è¯­å­¦ä¹ è®°å¿†å•è¯20ä¸ªã€‚ ç¾½æ¯›çƒä¸€å°æ—¶ 2020-11-3 ä¸‹ç­æ—¶é—´ 21:00 code study 22:10 - 20:30 leetcode [15] å­¦ä¹ äº†mysqlåŸºç¡€ã€‚ æ—¥è¯­å­¦ä¹ ç¯å¢ƒå‡†å¤‡ã€‚ 2020-11-2 ä¸‹ç­æ—¶é—´ 21:35 code study 23:00 - 00:35 leetcode [14] å­¦ä¹ äº†mysqlåŸºç¡€ã€‚ æ—¥è¯­å­¦ä¹ ç¯å¢ƒå‡†å¤‡ã€‚ 2020-11-1 code study ä»ä¸‹åˆåˆ°æ™šä¸Šæ–­æ–­ç»­ç»­å­¦ä¹ äº†6ä¸ªå°æ—¶ leetcode [7, 8, 9, 11, 12, 13] å­¦ä¹ äº†mysqlåŸºç¡€ã€‚å‘ç°leetcodeä¸Šæœ‰æ•°æ®åº“ç»ƒä¹  æƒ³å­¦æ—¥è¯­äº†ã€‚ å–œæ¬¢ä¸Šäº†å®è—up warmaï¼Œå–œæ¬¢warmaçš„å£°éŸ³ã€‚äºæ˜¯æˆ‘å¬äº†2ä¸ªå°æ—¶warmaçš„boomç”µå° æ‰“ç®—è°ƒæ•´ä¸€ä¸‹ç”Ÿæ´»äº†ï¼Œ1ç‚¹å‰ç¡è§‰ï¼Œå¤šåƒæ°´æœã€‚ 2020-10-31 code study 23:30 - 0:00 ä¸‹ç­æ—¶é—´ï¼š18:00 è§£å†³äº†å‡ ä¸ªbugï¼Œè¿˜å‰©ä¸‹æ–°é¡¹ç›®çš„å¥½å¤šadsp crashã€‚æ¶ˆè§£bugçš„é€Ÿåº¦ä¸åŠæŠ¥bugçš„é€Ÿåº¦ã€‚ ä¸‰ä¸ªæœˆçš„å¤´å‘ç»ˆäºå‰ªäº† 1ä¸ªå°æ—¶éª‘è½¦ leetcode [6] 2020-10-30 code study null ä¸‹ç­æ—¶é—´ï¼š23:30 æ­å»ºadspç¯å¢ƒæäº†åŠå¤©ï¼Œå¹¸å¥½æœ‰å°å§å§å¸®å¿™ã€‚ æ¬ äº†ä¸€é“leetcodeæ²¡æœ‰åˆ· 2020-10-29 code study 11:50 - 12:50 ä¸‹ç­æ—¶é—´ï¼š11:00 åˆ·äº†leetcode [5]é¢˜ï¼Œå­¦ä¹ äº†åŠ¨æ€è§„åˆ’ã€‚ Daily Review åšæŒæ—¥æ›´æ–°ï¼Œä¿æŒå­¦ä¹ çŠ¶æ€ bug çœŸå¤š tonyè¡¨ç¤ºï¼Œå†…éƒ¨è½¬å²—ä½ï¼Œç»©æ•ˆBåŠä»¥ä¸Šä¸”ç›®æ ‡éƒ¨é—¨åŒæ„å³å¯è½¬ã€‚åŸéƒ¨é—¨ä¸éœ€è¦ã€‚ æ•°æ®åº“å­¦ä¹ æ˜¯å½“åŠ¡ä¹‹æ€¥ 2020-10-28 code study 12:00 - 1:47 ä¸‹ç­æ—¶é—´ï¼š11:00 åˆ·äº†leetcode [5]é¢˜ï¼Œç¬¬5é¢˜ä¸ç¬¦åˆè¦æ±‚ï¼Œéœ€è¦é‡æ–°å­¦ä¹ ï¼Œåªå­¦ä¹ äº†ä¸­å¿ƒæ‰©æ•£è§£å†³æœ€é•¿å›æ–‡ã€‚åŠ¨æ€è§„åˆ’è¿˜éœ€è¦å­¦äº› Daily Review åšæŒæ—¥æ›´æ–°ï¼Œä¿æŒå­¦ä¹ çŠ¶æ€ è¿åŠ¨æ—¥ç¾½æ¯›çƒ 1å°æ—¶ bug åˆå¼€å§‹å‚¬äº†ã€‚ 2020-10-27 code study 11:00 - 1:00 ä¸‹ç­æ—¶é—´ï¼š20:30 åˆ·äº†leetcode [3,4]é¢˜ï¼Œç¬¬4é¢˜ä¸ç¬¦åˆè¦æ±‚ï¼Œéœ€è¦é‡æ–°å­¦ä¹  Daily Review åšæŒæ—¥æ›´æ–°ï¼Œä¿æŒå­¦ä¹ çŠ¶æ€ 2020-10-26 code study 11:30 - 1:20 ä¸‹ç­æ—¶é—´ï¼š21:10 ä»Šå¤©å®£å¸ƒå‘¨å…­å¼ºåˆ¶ä¸Šç­ï¼Œè®²ä¸ªç¬‘è¯ï¼Œæœ¬åˆ†ã€‚ åˆ·äº†leetcode [1,2]é¢˜ï¼Œæå…¶ä¸ç†Ÿç»ƒã€‚æƒ³äº†åŠå¤©ã€‚ Daily Review åšæŒæ—¥æ›´æ–°ï¼Œä¿æŒå­¦ä¹ çŠ¶æ€ 2020-10-25 code study null ä¸‹ç­æ—¶é—´ï¼šnull ä»å¤©åºœæ–°åŒºéª‘è‡ªè¡Œè½¦åˆ°åŒæµåŒºï¼Œ3ä¸ªåŠå°æ—¶ã€‚åƒäº†çº¢æ¹–è²è—•æ±¤é”…æ±¤é”…ï¼Œæ„Ÿè§‰è¿˜ä¸é”™ 2020-10-24 code study 0:00 - 5:00 ä¸‹ç­æ—¶é—´ï¼š6:00 ä¸Šäº†ä¸€å¤©ç­ï¼Œæœ€åå‘ç°å›°æ‰°äº†æˆ‘ä¸¤å¤©çš„é—®é¢˜å±…ç„¶æ˜¯ç¼–è¯‘é—®é¢˜ï¼Œæµªè´¹æˆ‘çš„æ—¶é—´ è¿›åŸåƒäº†ä¸²ä¸²å’Œå¤ªå¤é‡Œé€›è¡—ï¼Œiphone12çš„å±å¹•å’Œæœºèº«æ‰‹æ„Ÿï¼Œè®©äººå¤±æœ› é€šå®µå‡†å¤‡å­—èŠ‚è·³åŠ¨é¢è¯•ï¼Œé¢è¯•ç»“æœï¼Œæƒ¨è´¥ï¼Œç®—æ³•å’Œç½‘ç»œåè®®æ˜¯æˆ‘çš„çŸ­æ¿ã€‚æ¥ä¸‹æ¥åˆ·leetcode 2020-10-23 code study null ä¸‹ç­æ—¶é—´ï¼š21:30 null é‡åˆ°ç¥å¥‡çš„äº‹æƒ…äº†ã€‚è«åå…¶å¦™çš„bugè§£äº†ä¸¤å¤©ã€‚æ€•æ˜¯ç¼–è¯‘ç¯å¢ƒçš„é—®é¢˜å§ Daily Review åšæŒæ—¥æ›´æ–°ï¼Œä¿æŒå­¦ä¹ çŠ¶æ€ å¤ªç´¯äº†ã€‚æ— æ³•å­¦ä¹ ã€‚æ˜å¤©æ˜¯å­¦ä¹ è¿˜æ˜¯ç»§ç»­ä¸Šç­ï¼Ÿ 2020-10-22 code study 00:30 - 1:30 ä¸‹ç­æ—¶é—´ï¼š23:40 WebåŸºç¡€ä¸æ•°æ®å¤„ç† é¡¹ç›®åˆæœŸï¼Œå„ç§é—®é¢˜ï¼Œç¡¬ä»¶åˆå¼€å§‹å‚¬äº†ã€‚åæ­£é‡åˆ°é—®é¢˜å°±æ˜¯é˜»å¡ï¼Œå°±æ˜¯å¾ˆä¸¥é‡ã€‚ç°åœ¨æ˜¯äººè¶Šæ¥è¶Šå°‘ï¼Œé¡¹ç›®å‘¨æœŸè¶Šæ¥è¶ŠçŸ­ï¼Œé¡¹ç›®è¶Šæ¥è¶Šå¤šã€‚æˆ‘çœŸçš„æœäº†ï¼ŒåŠé€€è­¦å‘Šã€‚ Daily Review åšæŒæ—¥æ›´æ–°ï¼Œä¿æŒå­¦ä¹ çŠ¶æ€ å¤ªç´¯äº†ï¼Œå­¦ä¹ çŠ¶æ€ä¸å¥½ï¼Œæ„Ÿè§‰è¦å­¦ä¹ çš„å†…å®¹å¤ªå¤šäº†ã€‚ä¹‹å‰å­¦ä¹ çš„javaåç«¯çš„åŸºç¡€å¿˜å¾—å·®ä¸å¤šäº†ã€‚è¿™æ¬¡é¢è¯•æ€•æ˜¯å‡‰é€äº†ã€‚ 2020-10-21 code study 22:45 - 1:30 ä¸‹ç­æ—¶é—´ï¼š20:40 Javaçš„åŸºç¡€çŸ¥è¯†ï¼Œå¤šçº¿ç¨‹ï¼ŒJVMï¼ŒGCç®€ä»‹ å®Œæˆè¯¾ç¨‹åˆ†äº«ï¼Œå¦‚é‡Šé‡è´Ÿ Daily Review åšæŒæ—¥æ›´æ–°ï¼Œä¿æŒå­¦ä¹ çŠ¶æ€ è¿åŠ¨æ—¥ï¼Œbugå¤ªå¤šï¼Œæ²¡æœ‰æ—¶é—´æ‰“çƒã€‚ 2020-10-20 code study 23:50 - 1:50 ä¸‹ç­æ—¶é—´ : 22:20 Javaçš„åŸºç¡€çŸ¥è¯†ï¼Œå‡†å¤‡é¢è¯•å†…å®¹ Daily Review åšæŒæ—¥æ›´æ–°ï¼Œä¿æŒå­¦ä¹ çŠ¶æ€ è§£bugçš„é€Ÿåº¦è¿œæ¯”ä¸ä¸ŠæŠ¥bugçš„é€Ÿåº¦ã€‚åˆæŠ¥äº†ä¸€å¤§æ³¢äº§çº¿é—®é¢˜ ä¿®æ”¹äº†ç®€å†ã€‚ æ˜å¤©æœ‰éŸ³é¢‘åŸºç¡€çŸ¥è¯†æˆè¯¾ã€‚æ˜å¤©æ—©ä¸Šå‡†å¤‡ä¸€æ³¢ 2020-10-19 code study 22:30 - 1:45 ä¸‹ç­æ—¶é—´ : 21:20 spring mvc çš„ restfulé£æ ¼ å’Œ æ‹¦æˆªå™¨ Daily Review åšæŒæ—¥æ›´æ–°ï¼Œä¿æŒå­¦ä¹ çŠ¶æ€ å­—èŠ‚è·³åŠ¨ é¢è¯•é‚€è¯·ï¼Œæ¥ä¸‹æ¥çš„ä¸€å‘¨å‡†å¤‡é¢è¯• ä¸­ç§»ç‰©è”ç½‘ï¼Œè¿˜æœªä¿®æ”¹ç®€å†ï¼Œå‡†å¤‡æŠ•ä¸€æ³¢ oppoçš„å·¥ä½œå¥½å¿™ï¼Œé¡¹ç›®çš„ä¸€å¤§æ³¢bugè¦è§£ï¼Œä¸€å¤§æ³¢featureéœ€è¦ç§»æ¤","categories":[{"name":"ç”Ÿæ´»","slug":"ç”Ÿæ´»","permalink":"/categories/ç”Ÿæ´»/"}],"tags":[{"name":"Daily Review","slug":"Daily-Review","permalink":"/tags/Daily-Review/"}],"keywords":[{"name":"ç”Ÿæ´»","slug":"ç”Ÿæ´»","permalink":"/categories/ç”Ÿæ´»/"}]},{"title":"æ‹¦æˆªå™¨-Interceptor","slug":"æŠ€æœ¯/æ‹¦æˆªå™¨-Interceptor","date":"2020-10-19T17:50:00.000Z","updated":"2022-10-09T15:19:10.433Z","comments":true,"path":"2020/10/20/æŠ€æœ¯/æ‹¦æˆªå™¨-Interceptor/","link":"","permalink":"/2020/10/20/æŠ€æœ¯/æ‹¦æˆªå™¨-Interceptor/","excerpt":"","text":"æ‹¦æˆªå™¨(Interceptor)ç”¨äºå¯¹URLè¯·æ±‚è¿›è¡Œå‰ç½®/åç½®è¿‡æ»¤ Interceptorä¸Filterç”¨é€”ç›¸ä¼¼ï¼Œä½†å®ç°æ–¹å¼ä¸åŒ Interceptoråº•å±‚å°±æ˜¯åŸºäºSpring Aopé¢å‘åˆ‡é¢ç¼–ç¨‹å®ç° 1.æ‹¦æˆªå™¨å…¥é—¨&lt;!--pom.xml--&gt; &lt;dependency&gt; &lt;groupId&gt;javax.servlet&lt;/groupId&gt; &lt;artifactId&gt;javax.servlet-api&lt;/artifactId&gt; &lt;version&gt;3.1.0&lt;/version&gt; &lt;scope&gt;provided&lt;/scope&gt; &lt;/dependency&gt; &lt;!--applicationContext.xml--&gt; &lt;mvc:interceptors&gt; &lt;mvc:interceptor&gt; &lt;bean class=&quot;com.imooc.restful.interceptor.MyInterceptor&quot;/&gt; &lt;/mvc:interceptor&gt; &lt;/mvc:interceptors&gt; @RestController @RequestMapping(&quot;/restful&quot;) //@CrossOrigin(origins = {&quot;http://localhost:8080&quot;,&quot;http://www.imooc.com&quot;}) //@CrossOrigin(origins = &quot;*&quot;,maxAge = 3600) public class RestfulController { @GetMapping(&quot;/persons&quot;) public List&lt;Person&gt; findPersons(){ List list = new ArrayList(); Person p1 = new Person(); p1.setName(&quot;lily&quot;); p1.setAge(23); p1.setBirthday(new Date()); Person p2 = new Person(); p2.setName(&quot;smith&quot;); p2.setAge(22); p2.setBirthday(new Date()); list.add(p1); list.add(p2); System.out.println(&quot;RestfulController.findPersons() - return list&quot;); return list; } } public class MyInterceptor implements HandlerInterceptor { public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { System.out.println(request.getRequestURL() + &quot;-å‡†å¤‡æ‰§è¡Œ&quot;); // response.getWriter().print(&quot;[]&quot;); return true;//è¿”å›falseä¼šç›´æ¥æ‹¦æˆªï¼Œä¸è¿›è¡Œä¸‹ä¸€æ­¥ä¼ é€’ } public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { System.out.println(request.getRequestURL() + &quot;-ç›®æ ‡å¤„ç†æˆåŠŸ&quot;); } public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { System.out.println(request.getRequestURL() + &quot;-å“åº”å†…å®¹å·²äº§ç”Ÿ&quot;); } } preHandle -å‰ç½®æ‰§è¡Œå¤„ç† postHandle - ç›®æ ‡èµ„æºå·²ç»è¢«Spring mvc æ¡†æ¶å¤„ç† afterCompletion - å“åº”æ–‡æœ¬å·²ç»äº§ç”Ÿ æ‰“å°log http://localhost:8080/restful/persons-å‡†å¤‡æ‰§è¡Œ RestfulController.findPersons() - return list http://localhost:8080/restful/persons-ç›®æ ‡å¤„ç†æˆåŠŸ http://localhost:8080/restful/persons-å“åº”å†…å®¹å·²äº§ç”Ÿ é™æ€èµ„æºå¤„ç† å› ä¸ºæŒ‰ç…§ä¸Šé¢çš„é…ç½®ï¼Œå½“è®¿é—®é™æ€èµ„æºä¹Ÿä¼šè¿›è¡Œæ‹¦æˆªï¼Œæ˜¾ç„¶è¿™æ˜¯ä¸åˆç†çš„ã€‚ &lt;mvc:interceptors&gt; &lt;mvc:interceptor&gt; &lt;mvc:mapping path=&quot;/restful/**&quot;/&gt; &lt;mvc:mapping path=&quot;/webapi/**&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.ico&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.jpg&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.gif&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.js&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.css&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/resources/**&quot;/&gt; &lt;bean class=&quot;com.imooc.restful.interceptor.MyInterceptor&quot;/&gt; &lt;/mvc:interceptor&gt; &lt;/mvc:interceptors&gt; æ‰‹åŠ¨æ’é™¤é™æ€èµ„æº/**.ico å°†é™æ€èµ„æºæ”¾åœ¨ç»Ÿä¸€ç›®å½•/resource/ æŒ‡å®šè®¿é—®çš„é“¾æ¥ /restful/** 2.å¤šæ‹¦æˆªå™¨é—®é¢˜ &lt;mvc:interceptors&gt; &lt;mvc:interceptor&gt; &lt;mvc:mapping path=&quot;/restful/**&quot;/&gt; &lt;mvc:mapping path=&quot;/webapi/**&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.ico&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.jpg&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.gif&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.js&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.css&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/resources/**&quot;/&gt; &lt;bean class=&quot;com.imooc.restful.interceptor.MyInterceptor&quot;/&gt; &lt;/mvc:interceptor&gt; &lt;/mvc:interceptors&gt; &lt;mvc:interceptors&gt; &lt;mvc:interceptor&gt; &lt;mvc:mapping path=&quot;/restful/**&quot;/&gt; &lt;mvc:mapping path=&quot;/webapi/**&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.ico&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.jpg&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.gif&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.js&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/**.css&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/resources/**&quot;/&gt; &lt;bean class=&quot;com.imooc.restful.interceptor.MyInterceptor1&quot;/&gt; &lt;/mvc:interceptor&gt; &lt;/mvc:interceptors&gt; public class MyInterceptor implements HandlerInterceptor { public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { System.out.println(request.getRequestURL() + &quot;-å‡†å¤‡æ‰§è¡Œ&quot;); // response.getWriter().print(&quot;[]&quot;);//æ‹¦æˆªå™¨è¾“å‡ºåˆ°å‰ç«¯ return true;//è¿”å›falseä¼šç›´æ¥æ‹¦æˆªï¼Œä¸è¿›è¡Œä¸‹ä¸€æ­¥ä¼ é€’ } public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { System.out.println(request.getRequestURL() + &quot;-ç›®æ ‡å¤„ç†æˆåŠŸ&quot;); } public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { System.out.println(request.getRequestURL() + &quot;-å“åº”å†…å®¹å·²äº§ç”Ÿ&quot;); } } public class MyInterceptor1 implements HandlerInterceptor { public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { System.out.println(request.getRequestURL()+&quot;-å‡†å¤‡æ‰§è¡Œ-1&quot;); return true; } public void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView) throws Exception { System.out.println(request.getRequestURL()+&quot;-ç›®æ ‡å¤„ç†æˆåŠŸ-1&quot;); } public void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler, Exception ex) throws Exception { System.out.println(request.getRequestURL()+&quot;-å“åº”å†…å®¹å·²äº§ç”Ÿ-1&quot;); } } æ‰§è¡Œlog http://localhost:8080/restful/persons-å‡†å¤‡æ‰§è¡Œhttp://localhost:8080/restful/persons-å‡†å¤‡æ‰§è¡Œ-1RestfulController.findPersons() - return listhttp://localhost:8080/restful/persons-ç›®æ ‡å¤„ç†æˆåŠŸ-1http://localhost:8080/restful/persons-ç›®æ ‡å¤„ç†æˆåŠŸhttp://localhost:8080/restful/persons-å“åº”å†…å®¹å·²äº§ç”Ÿ-1http://localhost:8080/restful/persons-å“åº”å†…å®¹å·²äº§ç”Ÿ 3.ç”¨æˆ·æµé‡æ‹¦æˆªå™¨ å¼•å…¥logback &lt;dependency&gt; &lt;groupId&gt;ch.qos.logback&lt;/groupId&gt; &lt;artifactId&gt;logback-classic&lt;/artifactId&gt; &lt;version&gt;1.2.3&lt;/version&gt; &lt;/dependency&gt; &lt;/dependencies&gt; æ–°å»º resource/logback.xml&lt;!--logback.xml--&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;configuration&gt; &lt;!--å®šä¹‰å‘æ§åˆ¶å°è¾“å‡ºçš„è¿½åŠ å™¨--&gt; &lt;appender name=&quot;console&quot; class=&quot;ch.qos.logback.core.ConsoleAppender&quot;&gt; &lt;encoder&gt; &lt;pattern&gt;[%thread] %d %level %logger{10} - %msg%n&lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;!--å®šä¹‰å‘logæ–‡ä»¶è¾“å‡ºçš„è¿½åŠ å™¨--&gt; &lt;appender name=&quot;accessHistoryLog&quot; class=&quot;ch.qos.logback.core.rolling.RollingFileAppender&quot;&gt; &lt;rollingPolicy class=&quot;ch.qos.logback.core.rolling.TimeBasedRollingPolicy&quot;&gt; &lt;fileNamePattern&gt;d:/logs/history.%d.log&lt;/fileNamePattern&gt; &lt;/rollingPolicy&gt; &lt;encoder&gt; &lt;pattern&gt;[%thread] %d %level %logger{10} - %msg%n&lt;/pattern&gt; &lt;/encoder&gt; &lt;/appender&gt; &lt;!--è¾“å‡ºæœ€ä½çº§åˆ«debug--&gt; &lt;root level=&quot;debug&quot;&gt; &lt;appender-ref ref=&quot;console&quot;/&gt; &lt;/root&gt; &lt;logger name=&quot;com.imooc.restful.interceptor.AccessHistoryInterceptor&quot; level=&quot;INFO&quot; additivity=&quot;false&quot;&gt; &lt;!--level=&quot;INFO&quot; é»˜è®¤è¾“å‡ºç­‰çº§ additivity=&quot;false&quot; è¡¨ç¤ºä¸è¾“å‡ºåˆ°consoleï¼Œè¾“å‡ºåˆ°æ–‡ä»¶--&gt; &lt;appender-ref ref=&quot;accessHistoryLog&quot;/&gt; &lt;/logger&gt; &lt;/configuration&gt; &lt;!--applicationContext.xml--&gt; &lt;mvc:interceptors&gt; &lt;mvc:interceptor&gt; &lt;mvc:mapping path=&quot;/**&quot;/&gt; &lt;mvc:exclude-mapping path=&quot;/resources/**&quot;/&gt; &lt;bean class=&quot;com.imooc.restful.interceptor.AccessHistoryInterceptor&quot;/&gt; &lt;/mvc:interceptor&gt; &lt;/mvc:interceptors&gt; &lt;pattern&gt;[%thread] %d %level %logger{10} - %msg%n&lt;/pattern&gt; %pattern çº¿ç¨‹å %d æ—¶é—´ %level æ—¥å¿—çº§åˆ« %logger{10} äº§ç”Ÿç±»æ—¥å¿—ï¼Œé™å®šé•¿åº¦10 %msg logä¿¡æ¯ %n æ¢è¡Œ RollingFileAppender ç”ŸæˆæŒ‰å¤©æ»šåŠ¨çš„æ–‡ä»¶ã€‚æ¯ä¸€å¤©ä¸€ä¸ªæ–‡ä»¶ã€‚ public class AccessHistoryInterceptor implements HandlerInterceptor { private Logger logger = LoggerFactory.getLogger(AccessHistoryInterceptor.class); public boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler) throws Exception { StringBuilder log = new StringBuilder(); log.append(request.getRemoteAddr()); log.append(&quot;|&quot;); log.append(request.getRequestURL()); log.append(&quot;|&quot;); log.append(request.getHeader(&quot;user-agent&quot;)); logger.info(log.toString()); return true; } } 4.Spring MVCå¤„ç†æµç¨‹","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"Spring MVC","slug":"Spring-MVC","permalink":"/tags/Spring-MVC/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Restfulé£æ ¼","slug":"æŠ€æœ¯/Restful","date":"2020-10-19T13:00:00.000Z","updated":"2022-10-09T15:19:10.433Z","comments":true,"path":"2020/10/19/æŠ€æœ¯/Restful/","link":"","permalink":"/2020/10/19/æŠ€æœ¯/Restful/","excerpt":"","text":"0. åŸºç¡€ä»‹ç»Restfulå¼€å‘è§„èŒƒ ä½¿ç”¨URLä½œä¸ºç”¨æˆ·äº¤äº’å…¥å£ æ˜ç¡®çš„è¯­ä¹‰è§„èŒƒ(GET|POST|PUT|DELETE) GET æŸ¥è¯¢ POST æ–°å¢ PUT ä¿®æ”¹ DELETE åˆ é™¤ Refstfulå‘½åè¦æ±‚ 1.ç¯å¢ƒå‡†å¤‡&lt;!--web.xml--&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot; version=&quot;3.1&quot;&gt; &lt;servlet&gt; &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;init-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt; &lt;/init-param&gt; &lt;load-on-startup&gt;0&lt;/load-on-startup&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; &lt;filter&gt; &lt;filter-name&gt;characterFilter&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt; &lt;init-param&gt; &lt;param-name&gt;encoding&lt;/param-name&gt; &lt;param-value&gt;UTF-8&lt;/param-value&gt; &lt;/init-param&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;characterFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt; &lt;/web-app&gt; &lt;!--applicationContext.xml--&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:mv=&quot;http://www.springframework.org/schema/mvc&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;&gt; &lt;context:component-scan base-package=&quot;com.imooc.restful&quot;/&gt; &lt;mvc:annotation-driven&gt; &lt;mvc:message-converters&gt; &lt;bean class=&quot;org.springframework.http.converter.StringHttpMessageConverter&quot;&gt; &lt;property name=&quot;supportedMediaTypes&quot;&gt; &lt;list&gt; &lt;!-- response.setContentType(&quot;text/html;charset=utf-8&quot;) --&gt; &lt;value&gt;text/html;charset=utf-8&lt;/value&gt; &lt;value&gt;application/json;charset=utf-8&lt;/value&gt; &lt;/list&gt; &lt;/property&gt; &lt;/bean&gt; &lt;/mvc:message-converters&gt; &lt;/mvc:annotation-driven&gt; &lt;mvc:default-servlet-handler/&gt; &lt;/beans&gt; 2.Restful æ³¨è§£ @RestController - ä½¿ç”¨åœ¨ç±»ä¸Šï¼Œæ›¿ä»£æ¯ä¸ª@ResponseBodyï¼Œä»£è¡¨æ˜¯restfulæ•°æ®è€Œä¸æ˜¯é¡µé¢è·³è½¬ @PathVariable - è·¯å¾„å˜é‡æ³¨è§£ @GetMapping @PostMapping -å¯¹åº”è¯·æ±‚æ³¨è§£ &lt;!DOCTYPE html&gt; &lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;RESTfulå®éªŒå®¤&lt;/title&gt; &lt;script src=&quot;jquery-3.3.1.min.js&quot;&gt;&lt;/script&gt; &lt;script&gt; $(function(){ $(&quot;#btnGet&quot;).click(function () { $.ajax({ url : &quot;/restful/request&quot;, type : &quot;get&quot; , dataType : &quot;json&quot; , success : function(json){ $(&quot;#message&quot;).text(json.message); } }) }); }) $(function(){ $(&quot;#btnPost&quot;).click(function () { $.ajax({ url : &quot;/restful/request/100&quot;,//è·¯å¾„å˜é‡100 type : &quot;post&quot; , data : &quot;name=lily&amp;age=23&quot;,//æ•°æ® dataType : &quot;json&quot; , success : function(json){ $(&quot;#message&quot;).text(json.message+&quot;:&quot;+json.id); } }) }); }) $(function(){ $(&quot;#btnPut&quot;).click(function () { $.ajax({ url : &quot;/restful/request&quot;, type : &quot;put&quot; , data : &quot;name=lily&amp;age=23&quot;, dataType : &quot;json&quot; , success : function(json){ $(&quot;#message&quot;).text(json.message); } }) }); }) $(function(){ $(&quot;#btnDelete&quot;).click(function () { $.ajax({ url : &quot;/restful/request&quot;, type : &quot;delete&quot; , dataType : &quot;json&quot; , success : function(json){ $(&quot;#message&quot;).text(json.message); } }) }); }) $(function () { $(&quot;#btnPersons&quot;).click(function () { $.ajax({ url : &quot;/restful/persons&quot;, type : &quot;get&quot;, dataType : &quot;json&quot;, success : function(json){ console.info(json); for(var i = 0 ; i &lt; json.length;i++){ var p = json[i]; $(&quot;#divPersons&quot;).append(&quot;&lt;h2&gt;&quot; + p.name + &quot;-&quot; + p.age + &quot;-&quot; + p.birthday+ &quot;&lt;/h2&gt;&quot;) } } }) }) }) &lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;input type=&quot;button&quot; id=&quot;btnGet&quot; value=&quot;å‘é€Getè¯·æ±‚&quot;&gt; &lt;input type=&quot;button&quot; id=&quot;btnPost&quot; value=&quot;å‘é€Postè¯·æ±‚&quot;&gt; &lt;input type=&quot;button&quot; id=&quot;btnPut&quot; value=&quot;å‘é€Putè¯·æ±‚&quot;&gt; &lt;input type=&quot;button&quot; id=&quot;btnDelete&quot; value=&quot;å‘é€Deleteè¯·æ±‚&quot;&gt; &lt;h1 id=&quot;message&quot;&gt;&lt;/h1&gt; &lt;hr/&gt; &lt;input type=&quot;button&quot; id=&quot;btnPersons&quot; value=&quot;æŸ¥è¯¢æ‰€æœ‰äººå‘˜&quot;&gt; &lt;div id=&quot;divPersons&quot;&gt;&lt;/div&gt; &lt;/body&gt; &lt;/html&gt; @RestController //æ›¿ä»£æ¯ä¸ª@ResponseBodyï¼Œä»£è¡¨æ˜¯restfulæ•°æ®è€Œä¸æ˜¯é¡µé¢è·³è½¬ @RequestMapping(&quot;/restful&quot;) public class RestfulController { @GetMapping(&quot;/request&quot;) //@ResponseBody public String doGetRequest(){ return &quot;{\\&quot;message\\&quot;:\\&quot;è¿”å›æŸ¥è¯¢ç»“æœ\\&quot;}&quot;; } // POST /article/1 // POST /restful/request/100 // è·å–è·¯å¾„å˜é‡ @PostMapping(&quot;/request/{rid}&quot;) //@ResponseBody public String doPostRequest(@PathVariable(&quot;rid&quot;) Integer requestId, Person person){ System.out.println(person.getName() + &quot;:&quot; + person.getAge()); return &quot;{\\&quot;message\\&quot;:\\&quot;æ•°æ®æ–°å»ºæˆåŠŸ\\&quot;,\\&quot;id\\&quot;:&quot; + requestId + &quot;}&quot;; } @PutMapping(&quot;/request&quot;) //@ResponseBody public String doPutRequest(Person person){ System.out.println(person.getName() + &quot;:&quot; + person.getAge()); return &quot;{\\&quot;message\\&quot;:\\&quot;æ•°æ®æ›´æ–°æˆåŠŸ\\&quot;}&quot;; } @DeleteMapping(&quot;/request&quot;) //@ResponseBody public String doDeleteRequest(){ return &quot;{\\&quot;message\\&quot;:\\&quot;æ•°æ®åˆ é™¤æˆåŠŸ\\&quot;}&quot;; } } 3.ç®€å•è¯·æ±‚ä¸éç®€å•è¯·æ±‚ ç®€å•è¯·æ±‚æ˜¯æŒ‡æ ‡å‡†ç»“æ„çš„HTTPè¯·æ±‚,å¯¹åº”GET/POSTè¯·æ±‚ éç®€å•è¯·æ±‚æ˜¯å¤æ‚è¦æ±‚çš„HTTPè¯·æ±‚,æŒ‡PUT/DELETEã€æ‰©å±•æ ‡å‡†è¯·æ±‚ ä¸¤è€…æœ€å¤§åŒºåˆ«æ˜¯éç®€å•è¯·æ±‚å‘é€å‰éœ€è¦å‘é€é¢„æ£€è¯·æ±‚ éç®€å•è¯·æ±‚ &lt;script&gt; $(function(){ $(&quot;#btnPost&quot;).click(function () { $.ajax({ url : &quot;/restful/request/100&quot;, type : &quot;post&quot; , data : &quot;name=lily&amp;age=23&quot;, dataType : &quot;json&quot; , success : function(json){ $(&quot;#message&quot;).text(json.message+&quot;:&quot;+json.id); } }) }); }) $(function(){ $(&quot;#btnPut&quot;).click(function () { $.ajax({ url : &quot;/restful/request&quot;, type : &quot;put&quot; , data : &quot;name=lily&amp;age=23&quot;, dataType : &quot;json&quot; , success : function(json){ $(&quot;#message&quot;).text(json.message); } }) }); }) &lt;/script&gt; @PostMapping(&quot;/request/{rid}&quot;) //@ResponseBody public String doPostRequest(@PathVariable(&quot;rid&quot;) Integer requestId, Person person){ System.out.println(person.getName() + &quot;:&quot; + person.getAge()); return &quot;{\\&quot;message\\&quot;:\\&quot;æ•°æ®æ–°å»ºæˆåŠŸ\\&quot;,\\&quot;id\\&quot;:&quot; + requestId + &quot;}&quot;; } @PutMapping(&quot;/request&quot;) //@ResponseBody public String doPutRequest(Person person){ System.out.println(person.getName() + &quot;:&quot; + person.getAge()); return &quot;{\\&quot;message\\&quot;:\\&quot;æ•°æ®æ›´æ–°æˆåŠŸ\\&quot;}&quot;; } ç”±äºPostè¯·æ±‚æ˜¯ç®€å•è¯·æ±‚,å¯ä»¥å¾—åˆ°æ‰§è¡Œç»“æœ lily:23 ä½†Putè¯·æ±‚æ˜¯éç®€å•è¯·æ±‚ï¼Œæ‰§è¡Œç»“æœ null:null ä¸ºäº†ä½¿éç®€å•è¯·æ±‚ï¼Œèƒ½å¤Ÿè·å–åˆ°æ•°æ®ã€‚éœ€è¦åœ¨web.xmlå¢åŠ é…ç½® &lt;!--web.xml--&gt; &lt;filter&gt; &lt;filter-name&gt;formContentFilter&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.FormContentFilter&lt;/filter-class&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;formContentFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt; 4.JSONåºåˆ—åŒ–public class Person { private String name; private Integer age; @JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot; , timezone = &quot;GMT+8&quot;) private Date birthday; public String getName() { return name; } public void setName(String name) { this.name = name; } public Integer getAge() { return age; } public void setAge(Integer age) { this.age = age; } public Date getBirthday() { return birthday; } public void setBirthday(Date birthday) { this.birthday = birthday; } } @JsonFormat(pattern = â€œyyyy-MM-dd HH:mm:ssâ€ , timezone = â€œGMT+8â€) å¯¹æ—¥æœŸè¿›è¡Œæ ¼å¼åŒ–ï¼ŒJackSonçš„é»˜è®¤æ—¶åŒºä¸ºæ ¼æ—å°¼æ²»æ—¶é—´(GMT),åŒ—äº¬æ—¶é—´ä¸ºä¸œå…«åŒºã€‚éœ€è¦è¿›è¡Œè½¬æ¢æ—¶åŒºã€‚ @GetMapping(&quot;/person&quot;) public Person findByPersonId(Integer id){ Person p = new Person(); if(id==1){ p.setName(&quot;lily&quot;); p.setAge(23); }else if(id==2){ p.setName(&quot;smith&quot;); p.setAge(22); } return p; } @GetMapping(&quot;/persons&quot;) public List&lt;Person&gt; findPersons(){ List list = new ArrayList(); Person p1 = new Person(); p1.setName(&quot;lily&quot;); p1.setAge(23); p1.setBirthday(new Date()); Person p2 = new Person(); p2.setName(&quot;smith&quot;); p2.setAge(22); p2.setBirthday(new Date()); list.add(p1); list.add(p2); return list; } &lt;script&gt; $(function () { $(&quot;#btnPersons&quot;).click(function () { $.ajax({ url : &quot;/restful/persons&quot;, type : &quot;get&quot;, dataType : &quot;json&quot;, success : function(json){ console.info(json); for(var i = 0 ; i &lt; json.length;i++){ var p = json[i]; $(&quot;#divPersons&quot;).append(&quot;&lt;h2&gt;&quot; + p.name + &quot;-&quot; + p.age + &quot;-&quot; + p.birthday+ &quot;&lt;/h2&gt;&quot;) } } }) }) }) &lt;/script&gt; &lt;body&gt; &lt;h1 id=&quot;message&quot;&gt;&lt;/h1&gt; &lt;hr/&gt; &lt;input type=&quot;button&quot; id=&quot;btnPersons&quot; value=&quot;æŸ¥è¯¢æ‰€æœ‰äººå‘˜&quot;&gt; &lt;div id=&quot;divPersons&quot;&gt;&lt;/div&gt; &lt;/body&gt; 5.è·¨åŸŸè¯·æ±‚5.1 è·¨åŸŸåŸºç¡€çŸ¥è¯†æµè§ˆå™¨åŒæºç­–ç•¥ åŒæºç­–ç•¥é˜»æ­¢ä¸€ä¸ªåŸŸåŠ è½½çš„è„šæœ¬å»è·å–å¦ä¸€ä¸ªåŸŸä¸Šçš„èµ„æº åªè¦åè®®ã€åŸŸåã€ç«¯å£æœ‰ä¸€ä¸ªä¸åŒï¼Œéƒ½è¢«å½“ä½œæ˜¯ä¸åŒçš„åŸŸ æµè§ˆå™¨Consoleçœ‹åˆ° Access-Control-Allow-Originå°±ä»£è¡¨è·¨åŸŸäº† åŒæºç­–ç•¥ç¤ºä¾‹ HTMLä¸­å…è®¸è·¨åŸŸçš„æ ‡ç­¾ &lt;img&gt; - æ˜¾ç¤ºè¿œç¨‹å›¾ç‰‡ &lt;script&gt; - åŠ è½½è¿œç¨‹JS &lt;link&gt; - åŠ è½½è¿œç¨‹CSS ä¸ªäººç»å† å¹´å°‘æ—¶ç©çˆ¬è™«çš„æ—¶å€™ï¼Œç›®æ ‡æ˜¯ç›´æ¥çˆ¬å–Bç«™çš„æ•°æ®ï¼Œç›´æ¥æ˜¾ç¤ºåœ¨è‡ªå·±çš„ç•Œé¢ã€‚Bç«™æœ‰ä¸€ä¸ªæœåŠ¡å™¨ï¼Œæ˜¯restfulé£æ ¼æä¾›æ•°æ®ã€‚é€šè¿‡å‰ç«¯ç›´æ¥å»Bç«™æœåŠ¡å™¨çš„Jsonæ•°æ®ã€‚ç»“æœå‘ç°ä¸€ç›´æ˜¯æ— æ³•æˆåŠŸè·å–ã€‚è¿™ä¸ªé—®é¢˜å°±æ˜¯åŒæºç­–ç•¥ã€‚åé¢è¿˜æ˜¯åªæœ‰é€šè¿‡åç«¯è¯­éŸ³æ‹¿åˆ°æ•°æ®å†ä¼ åˆ°å‰ç«¯ç¬é—´å®ç°ã€‚ CORSè·¨åŸŸèµ„æºè®¿é—® CORSæ˜¯ä¸€ç§æœºåˆ¶,ä½¿ç”¨é¢å¤–çš„HTTPå¤´é€šçŸ¥æµè§ˆå™¨å¯ä»¥è®¿é—®å…¶ä»–åŸŸï¼Œå…¶å®æ˜¯æµè§ˆå™¨å‘ç°æ˜¯è·¨åŸŸï¼Œæ‰€ä»¥è¿›è¡Œæ‹¦æˆªäº†ã€‚ URLå“åº”å¤´åŒ…å« Access-Control-*æŒ‡æ˜è¯·æ±‚å…è®¸è·¨åŸŸï¼Œæµè§ˆå™¨å‘ç°å¸¦æœ‰è¿™ä¸ªresponseå¤´ï¼Œå°±æ”¾è¡Œäº†ã€‚ è·¨åŸŸè®¿é—®ï¼Œåœ¨Request Headersä¸­ï¼Œæœ‰å­—æ®µSec-Fetch-Mode: cors5.2 Spring MVCè§£å†³è·¨åŸŸè®¿é—® @CrossOriginï¼ Controllerè·¨åŸŸæ³¨è§£ mvc:cors - Spring MVCå…¨å±€è·¨åŸŸé…ç½® @CrossOrigin`Java@RestController//æ›¿ä»£æ¯ä¸ª@ResponseBodyï¼Œä»£è¡¨æ˜¯restfulæ•°æ®è€Œä¸æ˜¯æ•°æ®è·³è½¬@RequestMapping(â€œ/restfulâ€)//@CrossOrigin(origins = {â€œhttp://localhost:8080&quot;,&quot;http://www.imooc.com&quot;})//@CrossOrigin(origins = â€œ*â€,maxAge = 3600)public class RestfulController { } åœ¨Controllerç±»ä¸Šæ·»åŠ æ³¨è§£ `@CrossOrigin(origins = {&quot;http://localhost:8080&quot;,&quot;http://www.imooc.com&quot;})` `@CrossOrigin(origins = &quot;*&quot;,maxAge = 3600)` maxAgeçš„æ„æ€æ˜¯æµè§ˆå™¨çš„éç®€å•è¯·æ±‚åœ¨å®é™…è¯·æ±‚ä¹‹å‰ï¼Œä¼šå…ˆå‘é€é¢„æ£€è¯·æ±‚ã€‚ maxAge å³ä¿å­˜é¢„ç®€è¯·æ±‚çš„æ—¶é—´ï¼Œåœ¨è¿™æœŸé—´ã€‚éç®€å•è¯·æ±‚å°±ä¸ç”¨å‘é€é¢„æ£€è¯·æ±‚äº†ï¼Œç¼“è§£æœåŠ¡å™¨çš„å‹åŠ›ã€‚ 2. &lt;mvc:cors&gt; ```Xml &lt;mvc:cors&gt; &lt;mvc:mapping path=&quot;/restful/**&quot; allowed-origins=&quot;http://localhost:8080,http://www.imooc.com&quot; max-age=&quot;3600&quot;/&gt; &lt;/mvc:cors&gt; å…¶ä¸­ path=&quot;/restful/** è¡¨ç¤ºè®¿é—®çš„ç›®æ ‡åŸŸåä¸ºrestful/ ä¸‹çš„æ‰€æœ‰åŸŸå æ€»ç»“ mvc:cors çš„ä¼˜åŠ¿æ–¹ä¾¿é…ç½®å…¨å±€è·¨åŸŸè®¿é—®ã€‚","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"Spring MVC","slug":"Spring-MVC","permalink":"/tags/Spring-MVC/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Spring MVC","slug":"æŠ€æœ¯/Spring MVC","date":"2020-10-18T13:00:00.000Z","updated":"2022-10-09T15:19:10.433Z","comments":true,"path":"2020/10/18/æŠ€æœ¯/Spring MVC/","link":"","permalink":"/2020/10/18/æŠ€æœ¯/Spring MVC/","excerpt":"","text":"1.ç¯å¢ƒé…ç½®&lt;!--web.xml--&gt; &lt;servlet&gt; &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt; &lt;!-- DispatcherServletæ˜¯Spring MVCæœ€æ ¸å¿ƒçš„å¯¹è±¡ DispatcherServletç”¨äºæ‹¦æˆªHttpè¯·æ±‚, å¹¶æ ¹æ®è¯·æ±‚çš„URLè°ƒç”¨ä¸ä¹‹å¯¹åº”çš„Controlleræ–¹æ³•,æ¥å®ŒæˆHttpè¯·æ±‚çš„å¤„ç† --&gt; &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt; &lt;!--applicationContext.xml--&gt; &lt;init-param&gt; &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt; &lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt; &lt;/init-param&gt; &lt;!-- åœ¨Webåº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨åˆ›å»ºSpring IOCå®¹å™¨, å¹¶åˆå§‹åŒ–DispatcherServlet --&gt; &lt;load-on-startup&gt;0&lt;/load-on-startup&gt; &lt;/servlet&gt; &lt;servlet-mapping&gt; &lt;servlet-name&gt;springmvc&lt;/servlet-name&gt; &lt;!--&quot;/&quot; ä»£è¡¨æ‹¦æˆªæ‰€æœ‰è¯·æ±‚--&gt; &lt;url-pattern&gt;/&lt;/url-pattern&gt; &lt;/servlet-mapping&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:mv=&quot;http://www.springframework.org/schema/mvc&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/mvc http://www.springframework.org/schema/mvc/spring-mvc.xsd&quot;&gt; &lt;!-- context:component-scan æ ‡ç­¾ä½œç”¨ åœ¨Spring IOCåˆå§‹åŒ–è¿‡ç¨‹ä¸­,è‡ªåŠ¨åˆ›å»ºå¹¶ç®¡ç†com.imooc.springmvcåŠå­åŒ…ä¸­ æ‹¥æœ‰ä»¥ä¸‹æ³¨è§£çš„å¯¹è±¡. @Repository @Service @Controller @Component --&gt; &lt;context:component-scan base-package=&quot;com.imooc.springmvc&quot;&gt;&lt;/context:component-scan&gt; &lt;!--1.å¯ç”¨Spring MVCçš„æ³¨è§£å¼€å‘æ¨¡å¼--&gt; &lt;mvc:annotation-driven conversion-service=&quot;conversionService&quot;&gt; &lt;/mvc:annotation-driven&gt; &lt;!-- å°†å›¾ç‰‡/JS/CSSç­‰é™æ€èµ„æºæ’é™¤åœ¨å¤–,å¯æé«˜æ‰§è¡Œæ•ˆç‡ --&gt; &lt;mvc:default-servlet-handler/&gt; 2.URL Mappingæ³¨è§£ä½œç”¨URL Mappingå°†URLä¸Controlleræ–¹æ³•è¿›è¡Œç»‘å®š RequestMapping - é€šç”¨ç»‘å®š GetMaping - ç»‘å®šGetè¯·æ±‚ PostMapping - ç»‘å®šPostè¯·æ±‚ å‰ç«¯Post è¯·æ±‚ &lt;!DOCTYPE html&gt; &lt;html lang=&quot;en&quot;&gt; &lt;head&gt; &lt;meta charset=&quot;UTF-8&quot;&gt; &lt;title&gt;Title&lt;/title&gt; &lt;/head&gt; &lt;body&gt; &lt;form action=&quot;/um/p1&quot; method=&quot;post&quot;&gt; &lt;input name=&quot;username&quot;&gt; &lt;br&gt; &lt;input name=&quot;password&quot;&gt; &lt;br&gt; &lt;input name=&quot;createTime&quot;&gt; &lt;br&gt; &lt;input type=&quot;submit&quot; value=&quot;æäº¤&quot;&gt; &lt;/form&gt; &lt;/body&gt; &lt;/html&gt; @Controller @RequestMapping(&quot;/um&quot;) //ä¸ºæ‰€æœ‰ç±»çš„æ˜ å°„éƒ½æ·»åŠ ä¸€ä¸ªå‰ç¼€ public class URLMappingController { @GetMapping(&quot;/g&quot;) @ResponseBody //manager_nameå‚æ•°æ˜ å°„åˆ°String managerName //Date createTime æ˜¯ä½¿ç”¨MyDateConverterç±»åœ¨applicationContext.xmlé…ç½®è¿›è¡Œæ—¥æœŸè½¬æ¢çš„ public String getMapping(@RequestParam(&quot;manager_name&quot;) String managerName,Date createTime){ System.out.println(&quot;managerName:&quot; + managerName); System.out.println(createTime); return &quot;This is get method&quot;; } @PostMapping(&quot;/p&quot;) @ResponseBody public String postMapping(String username, Long password) { System.out.println(username + &quot;:&quot; + password); return &quot;This is post method&quot;; } @PostMapping(&quot;/p1&quot;) @ResponseBody //1.å¯ä»¥ç”¨å¯¹è±¡Userè¿›è¡Œæ¥æ”¶Postå‚æ•°ï¼Œå…¶ä¸­createTimeå­—æ®µï¼Œåœ¨Userç±»ä¸­ï¼Œéœ€è¦ä½¿ç”¨DateTimeFormat //2.å•ç‹¬æ¥æ”¶createTime æ—¶ï¼Œä¹Ÿå¯ä»¥å½¢å¼å‚æ•°ä¸­@DateTimeFormatï¼ŒæŒ‡æ˜æ ¼å¼ //3.String usernameä¹Ÿå¯ä»¥æ¥æ”¶åˆ°æ•°æ® public String postMapping(User user, String username, @DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;) Date createTime) { System.out.println(user.getUsername() + &quot;:&quot; + user.getPassword()); System.out.println(&quot;date:&quot; + user.getCreateTime()); return &quot;&lt;h1&gt;è¿™æ˜¯Postå“åº”&lt;/h1&gt;&quot;; } } public class User { private String username; private Long password; @DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;) private Date createTime; public String getUsername() { return username; } public void setUsername(String username) { this.username = username; } public Long getPassword() { return password; } public void setPassword(Long password) { this.password = password; } public Date getCreateTime() { return createTime; } public void setCreateTime(Date createTime) { this.createTime = createTime; } } 3.æ¥æ”¶è¡¨å•å¤æ‚æ•°æ®&lt;div class=&quot;container&quot;&gt; &lt;h2&gt;å­¦å‘˜è°ƒæŸ¥é—®å·&lt;/h2&gt; &lt;form action=&quot;./apply&quot; method=&quot;post&quot;&gt; &lt;h3&gt;æ‚¨çš„å§“å&lt;/h3&gt; &lt;input name=&quot;name&quot; class=&quot;text&quot; style=&quot;width: 150px&quot;&gt; &lt;h3&gt;æ‚¨æ­£åœ¨å­¦ä¹ çš„æŠ€æœ¯æ–¹å‘&lt;/h3&gt; &lt;select name=&quot;course&quot; style=&quot;width: 150px&quot;&gt; &lt;option value=&quot;java&quot;&gt;Java&lt;/option&gt; &lt;option value=&quot;h5&quot;&gt;HTML5&lt;/option&gt; &lt;option value=&quot;python&quot;&gt;Python&lt;/option&gt; &lt;option value=&quot;php&quot;&gt;PHP&lt;/option&gt; &lt;/select&gt; &lt;div&gt; &lt;h3&gt;æ‚¨çš„å­¦ä¹ ç›®çš„ï¼š&lt;/h3&gt; &lt;input type=&quot;checkbox&quot; name=&quot;purpose&quot; value=&quot;1&quot;&gt;å°±ä¸šæ‰¾å·¥ä½œ &lt;input type=&quot;checkbox&quot; name=&quot;purpose&quot; value=&quot;2&quot;&gt;å·¥ä½œè¦æ±‚ &lt;input type=&quot;checkbox&quot; name=&quot;purpose&quot; value=&quot;3&quot;&gt;å…´è¶£çˆ±å¥½ &lt;input type=&quot;checkbox&quot; name=&quot;purpose&quot; value=&quot;4&quot;&gt;å…¶ä»– &lt;/div&gt; &lt;div style=&quot;text-align: center;padding-top:10px&quot; &gt; &lt;input type=&quot;submit&quot; value=&quot;æäº¤&quot; style=&quot;width:100px&quot;&gt; &lt;/div&gt; &lt;/form&gt; &lt;/div&gt; @Controller public class FormContoller { @PostMapping(&quot;/apply&quot;) @ResponseBody //1.@RequestParam æŒ‡å®šæ¥æ”¶åˆ°çš„å‚æ•°ä¸ºn,é»˜è®¤å€¼ä¸º&quot;ANON&quot;,å¯é¿å…æ— æ³•åŒ¹é…åˆ°å‚æ•°æ—¶ï¼Œå‡ºç°çš„å¼‚å¸¸ //2.å¤é€‰æ¡†ä½¿ç”¨æ•°ç»„Integer[] purposeï¼Œæ¥æ”¶ public String apply(@RequestParam(value = &quot;n&quot;, defaultValue = &quot;ANON&quot;) String name, String course, Integer[] purpose) { System.out.println(&quot;name:&quot; + name); System.out.println(&quot;course:&quot; + course); for(Integer p : purpose){ System.out.println(&quot;purpose:&quot; + p); } return &quot;SUCCES&quot;; } // @PostMapping(&quot;/apply&quot;) @ResponseBody //@RequestParamè¡¨ç¤ºå°†æ¥æ”¶åˆ°çš„æ•°æ®è½¬æ¢æˆListï¼Œä¸€å®šè¦åŠ  public String apply(String name, String course, @RequestParam List&lt;Integer&gt; purpose){ System.out.println(&quot;name:&quot; + name); System.out.println(&quot;course:&quot; + course); for(Integer p : purpose){ System.out.println(&quot;purpose:&quot; + p); } return &quot;SUCCES&quot;; } // @PostMapping(&quot;/apply&quot;) @ResponseBody //ä»¥å¯¹è±¡æ–¹å¼æ¥æ”¶å‚æ•° public String apply(Form form) { System.out.println(form.getName()); System.out.println(form.getCourse()); for(Integer p : form.getPurpose()) { System.out.println(p); } return &quot;SUCCESS&quot;; } // @PostMapping(&quot;/apply&quot;) @ResponseBody //æ³¨æ„Mapç±»å‹æœ€å¥½ä¸è¦ç”¨å› ä¸ºMapç±»å‹å¯¹äºä¼ è¿‡æ¥çš„purposeå‚æ•°ï¼Œå¯¹äºå¤æ‚ç±»å‹ï¼Œå¦‚å¤é€‰æ¡†ï¼Œåªä¼šå–ç¬¬ä¸€ä¸ªå€¼ã€‚æ¼æ‰æ•°æ® public String apply(@RequestParam Map map){ System.out.println(map); return &quot;SUCCESS&quot;; } } public class Form { private String name; private String course; private List&lt;Integer&gt; purpose; public String getName() { return name; } public void setName(String name) { this.name = name; } public String getCourse() { return course; } public void setCourse(String course) { this.course = course; } public List&lt;Integer&gt; getPurpose() { return purpose; } public void setPurpose(List&lt;Integer&gt; purpose) { this.purpose = purpose; } } 4.å…³è”å¯¹è±¡èµ‹å€¼ &lt;h2&gt;å­¦å‘˜è°ƒæŸ¥é—®å·&lt;/h2&gt; &lt;form action=&quot;./apply&quot; method=&quot;post&quot;&gt; &lt;h3&gt;æ‚¨çš„å§“å&lt;/h3&gt; &lt;input name=&quot;name&quot; class=&quot;text&quot; style=&quot;width: 150px&quot;&gt; &lt;h3&gt;æ‚¨æ­£åœ¨å­¦ä¹ çš„æŠ€æœ¯æ–¹å‘&lt;/h3&gt; &lt;select name=&quot;course&quot; style=&quot;width: 150px&quot;&gt; &lt;option value=&quot;java&quot;&gt;Java&lt;/option&gt; &lt;option value=&quot;h5&quot;&gt;HTML5&lt;/option&gt; &lt;option value=&quot;python&quot;&gt;Python&lt;/option&gt; &lt;option value=&quot;php&quot;&gt;PHP&lt;/option&gt; &lt;/select&gt; &lt;div&gt; &lt;h3&gt;æ‚¨çš„å­¦ä¹ ç›®çš„ï¼š&lt;/h3&gt; &lt;input type=&quot;checkbox&quot; name=&quot;purpose&quot; value=&quot;1&quot;&gt;å°±ä¸šæ‰¾å·¥ä½œ &lt;input type=&quot;checkbox&quot; name=&quot;purpose&quot; value=&quot;2&quot;&gt;å·¥ä½œè¦æ±‚ &lt;input type=&quot;checkbox&quot; name=&quot;purpose&quot; value=&quot;3&quot;&gt;å…´è¶£çˆ±å¥½ &lt;input type=&quot;checkbox&quot; name=&quot;purpose&quot; value=&quot;4&quot;&gt;å…¶ä»– &lt;/div&gt; &lt;h3&gt;æ”¶è´§äºº&lt;/h3&gt; &lt;input name=&quot;delivery.name&quot; class=&quot;text&quot; style=&quot;width: 150px&quot;&gt; &lt;h3&gt;è”ç³»ç”µè¯&lt;/h3&gt; &lt;input name=&quot;delivery.mobile&quot; class=&quot;text&quot; style=&quot;width: 150px&quot;&gt; &lt;h3&gt;æ”¶è´§åœ°å€&lt;/h3&gt; &lt;input name=&quot;delivery.address&quot; class=&quot;text&quot; style=&quot;width: 150px&quot;&gt; &lt;div style=&quot;text-align: center;padding-top:10px&quot; &gt; &lt;input type=&quot;submit&quot; value=&quot;æäº¤&quot; style=&quot;width:100px&quot;&gt; &lt;/div&gt; &lt;/form&gt; delivery.name delivery.mobile delivery.address public class Delivery { private String name; private String address; private String mobile; public String getName() { return name; } public void setName(String name) { this.name = name; } public String getAddress() { return address; } public void setAddress(String address) { this.address = address; } public String getMobile() { return mobile; } public void setMobile(String mobile) { this.mobile = mobile; } } public class Form { private String name; private String course; private List&lt;Integer&gt; purpose; private Delivery delivery = new Delivery();//å…³è”å¯¹è±¡ public Delivery getDelivery() { return delivery; } public void setDelivery(Delivery delivery) { this.delivery = delivery; } public String getName() { return name; } public void setName(String name) { this.name = name; } public String getCourse() { return course; } public void setCourse(String course) { this.course = course; } public List&lt;Integer&gt; getPurpose() { return purpose; } public void setPurpose(List&lt;Integer&gt; purpose) { this.purpose = purpose; } } @PostMapping(&quot;/apply&quot;) @ResponseBody //æ³¨æ„Mapç±»å‹æœ€å¥½ä¸è¦ç”¨å› ä¸ºMapç±»å‹å¯¹äºä¼ è¿‡æ¥çš„purposeå‚æ•°ï¼Œåªä¼šå–ç¬¬ä¸€ä¸ª public String applyDelivery(Form form){ System.out.println(form.getDelivery().getName()); return &quot;SUCCESS&quot;; } 5.æ—¥æœŸè½¬æ¢ @DateTimeFormatæŒ‡å®šæ ¼å¼ï¼Œå°†String ç±»å‹è½¬æ¢ç§°æ—¥æœŸç±»å‹ @PostMapping(&quot;/p1&quot;) @ResponseBody //1.å¯ä»¥ç”¨å¯¹è±¡Userè¿›è¡Œæ¥æ”¶Postå‚æ•°ï¼Œå…¶ä¸­createTimeå­—æ®µï¼Œåœ¨Userç±»ä¸­ï¼Œéœ€è¦ä½¿ç”¨DateTimeFormat //2.å•ç‹¬æ¥æ”¶createTime æ—¶ï¼Œä¹Ÿå¯ä»¥å½¢å¼å‚æ•°ä¸­@DateTimeFormatï¼ŒæŒ‡æ˜æ ¼å¼ public String postMapping(User user, String username, @DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;) Date createTime) { System.out.println(user.getUsername() + &quot;:&quot; + user.getPassword()); System.out.println(&quot;date:&quot; + user.getCreateTime()); return &quot;&lt;h1&gt;è¿™æ˜¯Postå“åº”&lt;/h1&gt;&quot;; } å¯¹è±¡æˆå‘˜ æ³¨è§£ public class User { private String username; private Long password; //@DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;) private Date createTime; public String getUsername() { return username; } public void setUsername(String username) { this.username = username; } public Long getPassword() { return password; } public void setPassword(Long password) { this.password = password; } public Date getCreateTime() { return createTime; } public void setCreateTime(Date createTime) { this.createTime = createTime; } } public String postMapping(User user, String username, @DateTimeFormat(pattern = &quot;yyyy-MM-dd&quot;) Date createTime) { System.out.println(user.getUsername() + &quot;:&quot; + user.getPassword()); System.out.println(&quot;date:&quot; + user.getCreateTime()); return &quot;&lt;h1&gt;è¿™æ˜¯Postå“åº”&lt;/h1&gt;&quot;; } User å¯¹è±¡çš„æˆå‘˜å˜é‡è‡ªåŠ¨è½¬æ¢ è‡ªå®šä¹‰æ—¥æœŸè½¬æ¢ç±» //æ—¥æœŸè½¬æ¢ public class MyDateConverter implements Converter&lt;String, Date&gt; { public Date convert(String s) { SimpleDateFormat sdf = new SimpleDateFormat(&quot;yyyy-MM-dd&quot;); try { Date d = sdf.parse(s); return d; } catch (ParseException e) { return null; } } } &lt;!--applicationContext.xml--&gt; &lt;mvc:annotation-driven conversion-service=&quot;conversionService&quot;&gt;&lt;/mvc:annotation-driven&gt; &lt;bean id=&quot;conversionService&quot; class=&quot;org.springframework.format.support.FormattingConversionServiceFactoryBean&quot;&gt; &lt;property name=&quot;converters&quot;&gt; &lt;set&gt; &lt;!--æŒ‡å®šæ—¥æœŸè½¬æ¢ç±»--&gt; &lt;bean class=&quot;com.imooc.springmvc.converter.MyDateConverter&quot;/&gt; &lt;/set&gt; &lt;/property&gt; &lt;/bean&gt; @GetMapping(&quot;/g&quot;) @ResponseBody //manager_nameå‚æ•°æ˜ å°„åˆ°String managerName //Date createTime æ˜¯ä½¿ç”¨MyDateConverterç±»åœ¨applicationContext.xmlé…ç½®è¿›è¡Œæ—¥æœŸè½¬æ¢çš„ public String getMapping(@RequestParam(&quot;manager_name&quot;) String managerName,Date createTime){ System.out.println(&quot;managerName:&quot; + managerName); System.out.println(createTime); return &quot;This is get method&quot;; } Date createTime æ²¡æœ‰åŠ æ³¨è§£ï¼Œä¹Ÿå¯ä»¥è½¬æ¢ æ³¨æ„ï¼šæ³¨è§£ä¸è‡ªå®šä¹‰æ—¥æœŸè½¬æ¢ç±»åŒæ—¶å­˜åœ¨æ—¶ï¼Œä»¥æ—¥æœŸè½¬æ¢ç±»ä¼˜å…ˆ 6.ä¸­æ–‡ä¹±ç é—®é¢˜ Getä¹±ç é—®é¢˜ - server.xmlå¢åŠ URIEncodingå±æ€§ Postè¯·æ±‚ä¹±ç  - Web.xml é…ç½® CharacterEncodingFilter Responseå“åº”ä¹±ç  - springé…ç½®StringHttpMessageConverter 6.1 getPath:â€Tomcat v8.5 Server at localhost-config\\server.xmlâ€ &lt;Connector connectionTimeout=&quot;20000&quot; port=&quot;8080&quot; protocol=&quot;HTTP/1.1&quot; redirectPort=&quot;8443&quot; URIEncoding=&quot;UTF-8&quot;/&gt; åœ¨tomcat8 ä»¥ä¸‹çš„ç‰ˆæœ¬éœ€è¦å¢åŠ URIEncodingï¼Œä»¥ä¸Šç‰ˆæœ¬é»˜è®¤æ˜¯UTF-8 6.2 posté€šè¿‡è¿‡æ»¤å™¨æ¥å®ç°postç¼–ç  &lt;!--web.xml--&gt; &lt;filter&gt; &lt;filter-name&gt;characterFilter&lt;/filter-name&gt; &lt;filter-class&gt;org.springframework.web.filter.CharacterEncodingFilter&lt;/filter-class&gt; &lt;init-param&gt; &lt;param-name&gt;encoding&lt;/param-name&gt; &lt;param-value&gt;UTF-8&lt;/param-value&gt; &lt;/init-param&gt; &lt;/filter&gt; &lt;filter-mapping&gt; &lt;filter-name&gt;characterFilter&lt;/filter-name&gt; &lt;url-pattern&gt;/*&lt;/url-pattern&gt; &lt;/filter-mapping&gt; 6.3 Response&lt;!--applicationContext.xml--&gt; &lt;!--3.message-converters é…ç½®Responseå“åº”å­—ç¬¦é›†--&gt; &lt;mvc:annotation-driven conversion-service=&quot;conversionService&quot;&gt; &lt;mvc:message-converters&gt; &lt;bean class=&quot;org.springframework.http.converter.StringHttpMessageConverter&quot;&gt; &lt;property name=&quot;supportedMediaTypes&quot;&gt; &lt;list&gt; &lt;!-- response.setContentType(&quot;text/html;charset=utf-8&quot;) --&gt; &lt;value&gt;text/plain;charset=utf-8&lt;/value&gt; &lt;value&gt;text/html;charset=utf-8&lt;/value&gt; &lt;/list&gt; &lt;/property&gt; &lt;/bean&gt; &lt;/mvc:message-converters&gt; &lt;/mvc:annotation-driven&gt; 7.å“åº”è¾“å‡º7.1 ModelAndView","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"Spring MVC","slug":"Spring-MVC","permalink":"/tags/Spring-MVC/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"Spring äº‹åŠ¡ç®¡ç†","slug":"æŠ€æœ¯/Spring äº‹åŠ¡ç®¡ç†","date":"2020-10-18T07:00:00.000Z","updated":"2022-10-09T15:19:10.433Z","comments":true,"path":"2020/10/18/æŠ€æœ¯/Spring äº‹åŠ¡ç®¡ç†/","link":"","permalink":"/2020/10/18/æŠ€æœ¯/Spring äº‹åŠ¡ç®¡ç†/","excerpt":"","text":"ä»€ä¹ˆæ˜¯äº‹åŠ¡ï¼Ÿ äº‹åŠ¡ä¸€èˆ¬æŒ‡çš„æ˜¯æ•°æ®åº“äº‹åŠ¡(Database Transaction),æ˜¯æŒ‡ä¸€ä¸ªç¨‹åºæ‰§è¡Œå•å…ƒï¼Œè¦ä¹ˆå®Œå…¨æ‰§è¡Œï¼Œè¦ä¹ˆå®Œå…¨ä¸æ‰§è¡Œ äº‹åŠ¡å¹¶å‘é—®é¢˜ è„è¯» è§£å†³æ–¹æ³•ï¼šåªèƒ½è¯»å–æ°¸ä¹…æ•°æ®ï¼Œä¸èƒ½è¯»å–å†…å­˜ä¸­çš„æ•°æ® ä¸å¯é‡å¤è¯» è§£å†³æ–¹æ³•ï¼šé”è¡Œ å¹»è¯» è§£å†³æ–¹æ³•ï¼šé”è¡¨ Mysqläº‹åŠ¡éš”ç¦»çº§åˆ« JDBCäº‹åŠ¡éš”ç¦»çº§åˆ« äº‹åŠ¡ä¼ æ’­è¡Œä¸º 0. å…¬å…±ä»£ç &lt;!--spring-dao.xml--&gt; &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;&gt; &lt;bean id=&quot;dataSource&quot; class=&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;&gt; &lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.cj.jdbc.Driver&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/os?useUnicode=true&amp;amp;characterEncoding=utf-8&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;foreverlove&quot;/&gt; &lt;/bean&gt; &lt;bean id=&quot;jdbcTemplate&quot; class=&quot;org.springframework.jdbc.core.JdbcTemplate&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;!--åœ¨ XML é…ç½®æ–‡ä»¶ä¸­å¯åŠ¨ Spring çš„è‡ªåŠ¨æ‰«æåŠŸèƒ½ æˆ‘ä»¬å°±ä¸å†éœ€è¦åœ¨ XML ä¸­æ˜¾å¼ä½¿ç”¨ &lt;bean/&gt; è¿›è¡ŒBean çš„é…ç½®ã€‚ Spring åœ¨å®¹å™¨åˆå§‹åŒ–æ—¶å°†è‡ªåŠ¨æ‰«æ com.imooc.os.dao æŒ‡å®šçš„åŒ…åŠå…¶å­åŒ…ä¸‹çš„æ‰€æœ‰ classæ–‡ä»¶ï¼Œ æ‰€æœ‰æ ‡æ³¨äº† @Repository çš„ç±»éƒ½å°†è¢«æ³¨å†Œä¸º Spring Beanã€‚ --&gt; &lt;context:component-scan base-package=&quot;com.imooc.os.dao&quot;/&gt; &lt;/beans&gt; @Repository public class OrderDaoImpl implements OrderDao { @Autowired private JdbcTemplate jdbcTemplate; public void insert(Order order) { String sql = &quot;insert into orders values(?,?,?,?,?,?,?,?,?,?,?)&quot;; jdbcTemplate.update(sql,order.getId(),order.getProductsId(),order.getNumber(),order.getPrice(),order.getCreateTime(),order.getSendTime(),order.getConfirmTime(),order.getConsignee(),order.getConsigneePhone(),order.getConsigneeAddress(),order.getStatus()); } public void update(Order order) { String sql = &quot;update orders set create_time=?,send_time=?,confirm_time=?,consignee=?,consignee_phone=?,consignee_address=?,status=? where id=?&quot;; jdbcTemplate.update(sql,order.getProductsId(),order.getNumber(),order.getPrice(),order.getCreateTime(),order.getSendTime(),order.getConfirmTime(),order.getConsignee(),order.getConsigneePhone(),order.getConsigneeAddress(),order.getStatus(),order.getId()); } public void delete(String id) { String sql = &quot;delete from orders where id=?&quot;; jdbcTemplate.update(sql,id); } public Order select(String id) { String sql = &quot;select form orders where id=?&quot;; return jdbcTemplate.queryForObject(sql,new OrderRowMapper(),id); } public List&lt;Order&gt; select() { String sql = &quot;select form orders&quot;; return jdbcTemplate.query(sql,new OrderRowMapper()); } private class OrderRowMapper implements RowMapper&lt;Order&gt;{ public Order mapRow(ResultSet resultSet, int i) throws SQLException { Order order=new Order(); order.setId(resultSet.getString(&quot;id&quot;)); order.setProductsId(resultSet.getString(&quot;product_id&quot;)); order.setNumber(resultSet.getInt(&quot;number&quot;)); order.setPrice(resultSet.getDouble(&quot;price&quot;)); order.setCreateTime(resultSet.getTimestamp(&quot;create_time&quot;)); order.setSendTime(resultSet.getTimestamp(&quot;send_time&quot;)); order.setConfirmTime(resultSet.getTimestamp(&quot;confirm_time&quot;)); order.setConsignee(resultSet.getString(&quot;consignee&quot;)); order.setConsigneePhone(resultSet.getString(&quot;consignee_phone&quot;)); order.setConsigneeAddress(resultSet.getString(&quot;consignee_address&quot;)); order.setStatus(resultSet.getString(&quot;status&quot;)); return order; } } } @Repository public class ProductDaoImpl implements ProductDao { @Autowired private JdbcTemplate jdbcTemplate; public void insert(Product product) { String sql = &quot;insert into products values(?,?,?,?,?)&quot;; jdbcTemplate.update(sql,product.getId(),product.getTitle(),product.getPrice(),product.getStock(),product.getStatus()); } public void update(Product product) { String sql = &quot;update products set title=?,price=?,stock=?,status=? where id=?&quot;; jdbcTemplate.update(sql,product.getTitle(),product.getPrice(),product.getStock(),product.getStatus(),product.getId()); } public void delete(String id) { String sql = &quot;delete form products where id=?&quot;; jdbcTemplate.update(sql,id); } public Product select(String id) { String sql = &quot;select * from products where id=?&quot;; return jdbcTemplate.queryForObject(sql,new ProductRowMapper(),id); } public List&lt;Product&gt; select() { String sql = &quot;select * from products&quot;; return jdbcTemplate.query(sql,new ProductRowMapper()); } private class ProductRowMapper implements RowMapper&lt;Product&gt;{ public Product mapRow(ResultSet resultSet, int i) throws SQLException { Product product = new Product(); product.setId(resultSet.getString(&quot;id&quot;)); product.setTitle(resultSet.getString(&quot;title&quot;)); product.setPrice(resultSet.getDouble(&quot;price&quot;)); product.setStock(resultSet.getInt(&quot;stock&quot;)); product.setStatus(resultSet.getString(&quot;status&quot;)); return product; } } } 1.Springç¼–ç¨‹å¼äº‹ç‰©å¤„ç†1.1 æ–¹å¼1 åŸºäºåº•å±‚APIçš„ç¼–ç¨‹å¼äº‹ç‰©å¤„ç† PlatformTransactionManager TransactionDefinition TransactionStatus &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;import resource=&quot;spring-dao.xml&quot;/&gt; &lt;context:component-scan base-package=&quot;com.imooc.os.service.impl1&quot;/&gt; &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;bean id=&quot;transactionDefinition&quot; class=&quot;org.springframework.transaction.support.DefaultTransactionDefinition&quot;&gt; &lt;property name=&quot;propagationBehaviorName&quot; value=&quot;PROPAGATION_REQUIRED&quot;/&gt; &lt;!--PROPAGATION_REQUIRED è¡¨ç¤º äº‹åŠ¡ä¼ æ’­è¡Œä¸º--æ”¯æŒå½“å‰äº‹åŠ¡ï¼Œå¦‚æœæ²¡æœ‰å½“å‰äº‹åŠ¡ï¼Œå°±æ–°å»ºä¸€ä¸ªäº‹åŠ¡--&gt; &lt;!--ä¹Ÿå¯é…ç½®éš”ç¦»çº§åˆ«ç­‰å…¶ä»–å±æ€§ï¼Œä¸é…ç½®å³ä½¿ç”¨é»˜è®¤--&gt; &lt;/bean&gt; &lt;/beans&gt; package com.imooc.os.service; import com.imooc.os.entity.Order; public interface OrderService { void addOrder(Order order); } /*1.åŸºäºåº•å±‚APIçš„æ–¹å¼ PlatformTransactionManager TransactionDefinition*/ @Service public class OrderServiceImpl implements OrderService { @Autowired private OrderDao orderDao; @Autowired private ProductDao productDao; @Autowired private PlatformTransactionManager transactionManager; @Autowired private TransactionDefinition transactionDefinition; public void addOrder(Order order) { order.setCreateTime(new Date()); order.setStatus(&quot;å¾…ä»˜æ¬¾&quot;); //å¼€å¯äº‹åŠ¡ TransactionProxyFactoryBean transactionProxyFactoryBean; TransactionStatus transactionStatus = transactionManager.getTransaction(transactionDefinition); try { orderDao.insert(order); Product product = productDao.select(order.getProductsId()); product.setStock(product.getStock() - order.getNumber()); productDao.update(product); //ç»“æŸäº‹åŠ¡ transactionManager.commit(transactionStatus); }catch (Exception e){ e.printStackTrace(); //å‡ºé—®é¢˜ï¼Œå°†æœªæäº¤çš„sqlå›æ»š transactionManager.rollback(transactionStatus); } } } @RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration(&quot;classpath:spring-service1.xml&quot;) //1.åŸºäºåº•å±‚apiçš„ç¼–ç¨‹å¼äº‹åŠ¡å¤„ç†æ–¹å¼ public class OrderTest { @Autowired private OrderService orderService; @Test public void testAddOrder(){ Order order = new Order(&quot;100013&quot;,&quot;100002&quot;,2,1799,&quot;&quot;,&quot;&quot;,&quot;&quot;); orderService.addOrder(order); } } 1.2 åŸºäºTransactionTemplateçš„ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç† TransactionTemplate &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;import resource=&quot;spring-dao.xml&quot;/&gt; &lt;context:component-scan base-package=&quot;com.imooc.os.service.impl2&quot;/&gt; &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;bean id=&quot;transactionTemplate&quot; class=&quot;org.springframework.transaction.support.TransactionTemplate&quot;&gt; &lt;property name=&quot;transactionManager&quot; ref=&quot;transactionManager&quot;/&gt; &lt;/bean&gt; &lt;/beans&gt; //2.åŸºäºTransactionTemplateçš„ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç† @Service public class OrderServiceImpl implements OrderService { @Autowired private OrderDao orderDao; @Autowired private ProductDao productDao; //2.TransactionTemplate ç”¨äºç®€åŒ–åº•å±‚API @Autowired private TransactionTemplate transactionTemplate; public void addOrder(final Order order) { order.setCreateTime(new Date()); order.setStatus(&quot;å¾…ä»˜æ¬¾&quot;); transactionTemplate.execute(new TransactionCallback() { public Object doInTransaction(TransactionStatus transactionStatus) { try { orderDao.insert(order); Product product = productDao.select(order.getProductsId()); product.setStock(product.getStock() - order.getNumber()); productDao.update(product); //ä¸éœ€è¦æäº¤ï¼ŒTransactionTemplateä¼šå¸®ä½ æäº¤ }catch (Exception e){ e.printStackTrace(); transactionStatus.setRollbackOnly();//å›æ»š } return null; } }); } } public interface OrderService { void addOrder(Order order); } @RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration(&quot;classpath:spring-service2.xml&quot;) //2.åŸºäºTransactionTemplateçš„ç¼–ç¨‹å¼äº‹åŠ¡ç®¡ç† public class OrderTest { @Autowired private OrderService orderService; @Test public void testAddOrder(){ Order order = new Order(&quot;100013&quot;,&quot;100002&quot;,2,1799,&quot;&quot;,&quot;&quot;,&quot;&quot;); orderService.addOrder(order); } } 2.Springå£°æ˜å¼äº‹åŠ¡å¤„ç†ç®€ä»‹ Springçš„å£°æ˜å¼äº‹åŠ¡å¤„ç†æ˜¯å»ºç«‹åœ¨AOPçš„åŸºç¡€ä¹‹ä¸Šçš„ã€‚å…¶æœ¬è´¨æ˜¯å¯¹æ–¹æ³•å‰åè¿›è¡Œæ‹¦æˆªï¼Œç„¶ååœ¨ç›®æ ‡æ–¹æ³•å¼€å§‹ä¹‹å‰åˆ›å»ºæˆ–åŠ ä¸€ä¸ªäº‹åŠ¡ï¼Œåœ¨æ‰§è¡Œå®Œç›®æ ‡æ–¹æ³•ä¹‹åæ ¹æ®æ‰§è¡Œæƒ…å†µæäº¤æˆ–è€…å›æ»šäº‹åŠ¡ã€‚ å»ºè®®åœ¨å¼€å‘ä¸­ä½¿ç”¨å£°æ˜å¼äº‹åŠ¡ï¼Œä½¿å¾—ä¸šåŠ¡ä»£ç çº¯ç²¹å¹²å‡€ï¼Œæ–¹ä¾¿åæœŸä»£ç ç»´æŠ¤ åˆ†ç±» åŸºäºTransactionInterceptorçš„å£°æ˜å¼äº‹åŠ¡å¤„ç†ã€‚ åŸºäºTransactionProxyFactoryBeançš„å£°æ˜å¼äº‹åŠ¡å¤„ç†ã€‚ åŸºäº å‘½åç©ºé—´çš„å£°æ˜å¼äº‹ç‰©ç®¡ç†ã€‚ åŸºäº @Transactionalçš„å£°æ˜å¼äº‹åŠ¡ç®¡ç†ã€‚ 2.1 åŸºäºTransactionInterceptorçš„å£°æ˜å¼äº‹åŠ¡å¤„ç†ã€‚&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;import resource=&quot;spring-dao.xml&quot;/&gt; &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;!--1.åŸºäºTransactionInterceptorçš„å£°æ˜å¼äº‹åŠ¡å¤„ç†--&gt; &lt;bean id=&quot;orderServiceTarget&quot; class=&quot;com.imooc.os.service.impl.OrderServiceImpl&quot;/&gt; &lt;bean id=&quot;transactionInterceptor&quot; class=&quot;org.springframework.transaction.interceptor.TransactionInterceptor&quot;&gt; &lt;!--é…ç½®äº‹åŠ¡ç®¡ç†å™¨--&gt; &lt;property name=&quot;transactionManager&quot; ref=&quot;transactionManager&quot;/&gt; &lt;!--é…ç½®æ‹¦æˆªå™¨--&gt; &lt;property name=&quot;transactionAttributes&quot;&gt; &lt;props&gt; &lt;!--keyæ˜¯æ–¹æ³•ï¼Œé…ç½®äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼Œå±æ€§--&gt; &lt;prop key=&quot;get*&quot;&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt; &lt;prop key=&quot;find*&quot;&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt; &lt;prop key=&quot;search*&quot;&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt; &lt;prop key=&quot;*&quot;&gt;PROPAGATION_REQUIRED&lt;/prop&gt; &lt;/props&gt; &lt;/property&gt; &lt;/bean&gt; &lt;!--ç”¨æ‹¦æˆªå™¨å¢å¼ºç›®æ ‡ç±»ï¼Œå»ºç«‹å…³è”--&gt; &lt;bean id=&quot;orderService&quot; class=&quot;org.springframework.aop.framework.ProxyFactoryBean&quot;&gt; &lt;property name=&quot;target&quot; ref=&quot;orderServiceTarget&quot;/&gt; &lt;property name=&quot;interceptorNames&quot;&gt; &lt;list&gt; &lt;idref bean=&quot;transactionInterceptor&quot;/&gt; &lt;/list&gt; &lt;/property&gt; &lt;/bean&gt; &lt;/beans&gt; @Service public class OrderServiceImpl implements OrderService { @Autowired private OrderDao orderDao; @Autowired private ProductDao productDao; public void addOrder(Order order) { order.setCreateTime(new Date()); order.setStatus(&quot;å¾…ä»˜æ¬¾&quot;); orderDao.insert(order); Product product = productDao.select(order.getProductsId()); product.setStock(product.getStock() - order.getNumber()); productDao.update(product); } } å¯¹äºaddOrderï¼Œç”±äºæ‹¦æˆªå™¨å¢å¼ºï¼Œå‡ºé”™æ—¶ï¼Œè¿™ä¸ªå‡½æ•°çš„æ“ä½œè‡ªåŠ¨å›æ»šã€‚ @RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration(&quot;classpath:spring-service3.xml&quot;) //3.åŸºäºTransactionInterceptorçš„å£°æ˜å¼äº‹åŠ¡å¤„ç† public class OrderTest { @Autowired private OrderService orderService; @Test public void testAddOrder(){ Order order = new Order(&quot;100013&quot;,&quot;100002&quot;,2,1799,&quot;&quot;,&quot;&quot;,&quot;&quot;); orderService.addOrder(order); } } 2.2 åŸºäºTransactionProxyFactoryBeançš„å£°æ˜å¼äº‹åŠ¡å¤„ç†&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd&quot;&gt; &lt;import resource=&quot;spring-dao.xml&quot;/&gt; &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;!--2.åŸºäºTransactionProxyFactoryBeançš„å£°æ˜å¼äº‹åŠ¡å¤„ç†ï¼Œå…¶å®å°±æ˜¯ç®€åŒ–ä¸Šé¢çš„é‚£ç§æ‹¦æˆªå™¨--&gt; &lt;bean id=&quot;orderServiceTarget&quot; class=&quot;com.imooc.os.service.impl.OrderServiceImpl&quot;/&gt; &lt;bean id=&quot;orderService&quot; class=&quot;org.springframework.transaction.interceptor.TransactionProxyFactoryBean&quot;&gt; &lt;property name=&quot;transactionManager&quot; ref=&quot;transactionManager&quot;/&gt; &lt;property name=&quot;transactionAttributes&quot;&gt; &lt;props&gt; &lt;prop key=&quot;get*&quot;&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt; &lt;prop key=&quot;find*&quot;&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt; &lt;prop key=&quot;search*&quot;&gt;PROPAGATION_REQUIRED,readOnly&lt;/prop&gt; &lt;prop key=&quot;*&quot;&gt;PROPAGATION_REQUIRED&lt;/prop&gt; &lt;/props&gt; &lt;/property&gt; &lt;property name=&quot;target&quot; ref=&quot;orderServiceTarget&quot;/&gt; &lt;/bean&gt; &lt;/beans&gt; @Service public class OrderServiceImpl implements OrderService { @Autowired private OrderDao orderDao; @Autowired private ProductDao productDao; public void addOrder(Order order) { order.setCreateTime(new Date()); order.setStatus(&quot;å¾…ä»˜æ¬¾&quot;); orderDao.insert(order); Product product = productDao.select(order.getProductsId()); product.setStock(product.getStock() - order.getNumber()); productDao.update(product); } } @RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration(&quot;classpath:spring-service4.xml&quot;) //4.åŸºäºTransactionProxyFactoryBeançš„å£°æ˜å¼äº‹åŠ¡å¤„ç†ï¼Œå…¶å®å°±æ˜¯ç®€åŒ–ä¸Šé¢çš„é‚£ç§æ‹¦æˆªå™¨ public class OrderTest { @Autowired private OrderService orderService; @Test public void testAddOrder(){ Order order = new Order(&quot;100013&quot;,&quot;100002&quot;,2,1799,&quot;&quot;,&quot;&quot;,&quot;&quot;); orderService.addOrder(order); } } 2.3 (æœ€æ¨è)åŸºäº å‘½åç©ºé—´çš„å£°æ˜å¼äº‹ç‰©ç®¡ç†ã€‚&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;&gt; &lt;import resource=&quot;spring-dao.xml&quot;/&gt; &lt;context:component-scan base-package=&quot;com.imooc.os.service.impl&quot;/&gt; &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;!--3.åŸºäº&lt;tx&gt;å‘½åç©ºé—´çš„å£°æ˜å¼äº‹åŠ¡å¤„ç†ï¼Œè¿™ç§æ˜¯å®é™…å¼€å‘å¸¸ç”¨çš„--&gt; &lt;!--å¢åŠ é€šçŸ¥--&gt; &lt;tx:advice id=&quot;txAdvice&quot; transaction-manager=&quot;transactionManager&quot;&gt; &lt;tx:attributes&gt; &lt;tx:method name=&quot;get*&quot; propagation=&quot;REQUIRED&quot; read-only=&quot;true&quot;/&gt; &lt;tx:method name=&quot;find*&quot; propagation=&quot;REQUIRED&quot; read-only=&quot;true&quot;/&gt; &lt;tx:method name=&quot;search*&quot; propagation=&quot;REQUIRED&quot; read-only=&quot;true&quot;/&gt; &lt;tx:method name=&quot;*&quot; propagation=&quot;REQUIRED&quot;/&gt; &lt;/tx:attributes&gt; &lt;/tx:advice&gt; &lt;!--å¢å¼ºçš„åœ°æ–¹,åœ¨å“ªä¸ªæ–¹æ³•å¢å¼º--&gt; &lt;aop:config&gt; &lt;aop:pointcut id=&quot;pointcut&quot; expression=&quot;execution(* com.imooc.os.service.impl.*.*(..))&quot;/&gt; &lt;aop:advisor advice-ref=&quot;txAdvice&quot; pointcut-ref=&quot;pointcut&quot;/&gt; &lt;/aop:config&gt; &lt;/beans&gt; @Service public class OrderServiceImpl implements OrderService { @Autowired private OrderDao orderDao; @Autowired private ProductDao productDao; public void addOrder(Order order) { order.setCreateTime(new Date()); order.setStatus(&quot;å¾…ä»˜æ¬¾&quot;); orderDao.insert(order); Product product = productDao.select(order.getProductsId()); product.setStock(product.getStock() - order.getNumber()); productDao.update(product); } } @RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration(&quot;classpath:spring-service5.xml&quot;) //5.åŸºäº&lt;tx&gt;å‘½åç©ºé—´çš„å£°æ˜å¼äº‹åŠ¡å¤„ç†ï¼Œè¿™ç§æ˜¯å®é™…å¼€å‘å¸¸ç”¨çš„ public class OrderTest { @Autowired private OrderService orderService; @Test public void testAddOrder(){ Order order = new Order(&quot;100013&quot;,&quot;100002&quot;,2,1799,&quot;&quot;,&quot;&quot;,&quot;&quot;); orderService.addOrder(order); } } 2.4 åŸºäº @Transactionalçš„å£°æ˜å¼äº‹åŠ¡ç®¡ç†ã€‚&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;&gt; &lt;import resource=&quot;spring-dao.xml&quot;/&gt; &lt;context:component-scan base-package=&quot;com.imooc.os.service.impl6&quot;/&gt; &lt;bean id=&quot;transactionManager&quot; class=&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;!--4.åŸºäº@Transactionalçš„å£°æ˜å¼äº‹åŠ¡ç®¡ç†--&gt; &lt;tx:annotation-driven transaction-manager=&quot;transactionManager&quot;/&gt; &lt;/beans&gt; @Service public class OrderServiceImpl implements OrderService { @Autowired private OrderDao orderDao; @Autowired private ProductDao productDao; //4.åŸºäº@Transactionalçš„å£°æ˜å¼äº‹åŠ¡ç®¡ç† @Transactional(propagation = Propagation.REQUIRED) public void addOrder(Order order) { order.setCreateTime(new Date()); order.setStatus(&quot;å¾…ä»˜æ¬¾&quot;); orderDao.insert(order); Product product = productDao.select(order.getProductsId()); product.setStock(product.getStock() - order.getNumber()); productDao.update(product); } } @RunWith(SpringJUnit4ClassRunner.class) @ContextConfiguration(&quot;classpath:spring-service6.xml&quot;) //6.åŸºäº@Transactionalçš„å£°æ˜å¼äº‹åŠ¡ç®¡ç†,è¿™ç§æ˜¯å®é™…å¼€å‘å¸¸ç”¨çš„ public class OrderTest { @Autowired private OrderService orderService; @Test public void testAddOrder(){ Order order = new Order(&quot;100013&quot;,&quot;100002&quot;,2,1799,&quot;&quot;,&quot;&quot;,&quot;&quot;); orderService.addOrder(order); } }","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"spring","slug":"spring","permalink":"/tags/spring/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"JDBC Template","slug":"æŠ€æœ¯/JDBC Template","date":"2020-10-17T06:00:00.000Z","updated":"2022-10-09T15:19:10.433Z","comments":true,"path":"2020/10/17/æŠ€æœ¯/JDBC Template/","link":"","permalink":"/2020/10/17/æŠ€æœ¯/JDBC Template/","excerpt":"","text":"1.JDBC Templateç®€ä»‹Springå¯¹æ•°æ®åº“çš„æ“ä½œåœ¨jdbcä¸Šé¢åšäº†æ·±å±‚æ¬¡çš„å°è£…ï¼Œä½¿ç”¨springçš„æ³¨å…¥åŠŸèƒ½ï¼Œå¯ä»¥æŠŠDataSourceæ³¨å†Œåˆ°JdbcTemplateä¹‹ä¸­ã€‚ 2.codespring.xml &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt; &lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:context=&quot;http://www.springframework.org/schema/context&quot; xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot; xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop.xsd http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx.xsd&quot;&gt; &lt;bean id=&quot;dataSource&quot; class=&quot;org.springframework.jdbc.datasource.DriverManagerDataSource&quot;&gt; &lt;property name=&quot;driverClassName&quot; value=&quot;com.mysql.cj.jdbc.Driver&quot;/&gt; &lt;property name=&quot;url&quot; value=&quot;jdbc:mysql://localhost:3306/selection_course?useUnicode=true&amp;amp;characterEncoding=utf-8&quot;/&gt; &lt;property name=&quot;username&quot; value=&quot;root&quot;/&gt; &lt;property name=&quot;password&quot; value=&quot;foreverlove&quot;/&gt; &lt;/bean&gt; &lt;bean id=&quot;jdbcTemplate&quot; class=&quot;org.springframework.jdbc.core.JdbcTemplate&quot;&gt; &lt;property name=&quot;dataSource&quot; ref=&quot;dataSource&quot;/&gt; &lt;/bean&gt; &lt;!--åœ¨ XML é…ç½®æ–‡ä»¶ä¸­å¯åŠ¨ Spring çš„è‡ªåŠ¨æ‰«æåŠŸèƒ½ æˆ‘ä»¬å°±ä¸å†éœ€è¦åœ¨ XML ä¸­æ˜¾å¼ä½¿ç”¨ &lt;bean/&gt; è¿›è¡ŒBean çš„é…ç½®ã€‚ Spring åœ¨å®¹å™¨åˆå§‹åŒ–æ—¶å°†è‡ªåŠ¨æ‰«æ com.imooc.sc æŒ‡å®šçš„åŒ…åŠå…¶å­åŒ…ä¸‹çš„æ‰€æœ‰ classæ–‡ä»¶ï¼Œ æ‰€æœ‰æ ‡æ³¨äº† @Repository çš„ç±»éƒ½å°†è¢«æ³¨å†Œä¸º Spring Beanã€‚ --&gt; &lt;context:component-scan base-package=&quot;com.imooc.sc&quot;/&gt; &lt;/beans&gt; åŸºæœ¬æ“ä½œæ‰‹æ³• public class Test { private JdbcTemplate jdbcTemplate; { ApplicationContext context = new ClassPathXmlApplicationContext(&quot;spring.xml&quot;); jdbcTemplate = (JdbcTemplate)context.getBean(&quot;jdbcTemplate&quot;); } //create @org.junit.Test public void testExecute(){ jdbcTemplate.execute(&quot;create table user1(id int,name varchar(20))&quot;); } //insert @org.junit.Test public void testUpdate(){ String sql = &quot;insert into student(name,sex) values(?,?)&quot;; jdbcTemplate.update(sql,new Object[]{&quot;å¼ é£&quot;,&quot;ç”·&quot;}); } //update @org.junit.Test public void testUpdate2(){ String sql = &quot;update student set sex=? where id=?&quot;; jdbcTemplate.update(sql,&quot;å¥³&quot;,1); } //æ‰¹é‡æ›´æ–° @org.junit.Test public void testBatchUpdate(){ String[] sqls={ &quot;insert into student(name,sex) values(&#39;å…³ç¾½&#39;,&#39;å¥³&#39;)&quot;, &quot;insert into student(name,sex) values(&#39;åˆ˜å¤‡&#39;,&#39;ç”·&#39;)&quot;, &quot;update student set sex=&#39;å¥³&#39; where id=1&quot; }; jdbcTemplate.batchUpdate(sqls); } //æ‰¹é‡æ›´æ–° public void testBatchUpdate2(){ String sql = &quot;insert into selection(student,course) values(?,?)&quot;; List&lt;Object[]&gt; list = new ArrayList&lt;Object[]&gt;(); list.add(new Object[]{1005,1001}); list.add(new Object[]{1005,1003}); jdbcTemplate.batchUpdate(sql,list); } //æŸ¥è¯¢ @org.junit.Test public void testQuerySimple1(){ String sql = &quot;select count(*) from student&quot;; int count = jdbcTemplate.queryForObject(sql,Integer.class); System.out.println(count); } @org.junit.Test public void testQuerySimple2(){ String sql = &quot;select name from student where sex=?&quot;; List&lt;String&gt; names = jdbcTemplate.queryForList(sql,String.class,&quot;å¥³&quot;); System.out.println(names); } //æŸ¥è¯¢ç»“æœä¸ºmap @org.junit.Test public void testQueryMap1(){ String sql = &quot;select * from student where id = ?&quot;; Map&lt;String,Object&gt; stu = jdbcTemplate.queryForMap(sql,1); System.out.println(stu);//{id=1, name=å¼ é£, sex=å¥³, born=null} } @org.junit.Test public void testQueryMap2(){ String sql = &quot;select * from student&quot;; List&lt;Map&lt;String,Object&gt;&gt; stus = jdbcTemplate.queryForList(sql); System.out.println(stus); //[{id=1, name=å¼ é£, sex=å¥³, born=null}, {id=2, name=å…³ç¾½, sex=å¥³, born=null}] } //æŸ¥è¯¢ç»“æœè¿”å›å¯¹è±¡ public void testQueryEntity1(){ String sql = &quot;select * from student where id = ?&quot;; Student stu = jdbcTemplate.queryForObject(sql, new StudentRowMapper(), 1004); System.out.println(stu); } @org.junit.Test public void testQueryEntity2(){ String sql = &quot;select * from student&quot;; List&lt;Student&gt; stus = jdbcTemplate.query(sql,new StudentRowMapper()); System.out.println(stus); } private class StudentRowMapper implements RowMapper&lt;Student&gt;{ public Student mapRow(ResultSet resultSet, int i) throws SQLException { Student stu = new Student(); stu.setId(resultSet.getInt(&quot;id&quot;)); stu.setName(resultSet.getString(&quot;name&quot;)); stu.setSex(resultSet.getString(&quot;sex&quot;)); stu.setBorn(resultSet.getDate(&quot;born&quot;)); return stu; } } }","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"spring","slug":"spring","permalink":"/tags/spring/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"æ¡¥æ¥æ¨¡å¼","slug":"æŠ€æœ¯/æ¡¥æ¥æ¨¡å¼","date":"2020-10-13T16:30:00.000Z","updated":"2022-10-09T15:19:10.433Z","comments":true,"path":"2020/10/14/æŠ€æœ¯/æ¡¥æ¥æ¨¡å¼/","link":"","permalink":"/2020/10/14/æŠ€æœ¯/æ¡¥æ¥æ¨¡å¼/","excerpt":"","text":"åŸºæœ¬ä»‹ç» æ¡¥æ¥æ¨¡å¼(Bridgeæ¨¡å¼)æ˜¯æŒ‡:å°†å®ç°ä¸æŠ½è±¡æ”¾åœ¨ä¸¤ä¸ªä¸åŒçš„ç±»å±‚æ¬¡ä¸­ï¼Œä½¿ä¸¤ä¸ªå±‚æ¬¡å¯ä»¥ç‹¬ç«‹æ”¹å˜ã€‚ æ˜¯ä¸€ç§ç»“æ„å‹è®¾è®¡æ¨¡å¼ Bridge æ¨¡å¼åŸºäºç±»çš„æœ€å°è®¾è®¡åŸåˆ™ï¼Œé€šè¿‡ä½¿ç”¨å°è£…ã€èšåˆåŠç»§æ‰¿ç­‰è¡Œä¸ºè®©ä¸åŒçš„ç±»æ‰¿æ‹…ä¸åŒçš„èŒè´£ã€‚å®ƒçš„ä¸»è¦ç‰¹ç‚¹æ˜¯æŠŠæŠ½è±¡(Abstraction)ä¸è¡Œä¸ºå®ç°(Implementation)åˆ†ç¦»å¼€æ¥ï¼Œä»è€Œå¯ä»¥ä¿æŒå„éƒ¨åˆ†çš„ç‹¬ç«‹æ€§ä»¥åŠåº”å¯¹ä»–ä»¬çš„ åŠŸèƒ½æ‰©å±• UML CODE public interface Brand { void open(); void close(); } public class Vivo implements Brand { @Override public void open() { System.out.println(&quot;VIVOæ‰‹æœºå¼€æœº&quot;); } @Override public void close() { System.out.println(&quot;VIVOæ‰‹æœºå…³æœº&quot;); } } public class Xiaomi implements Brand { @Override public void open() { System.out.println(&quot;Xiaomiæ‰‹æœºå¼€æœº&quot;); } @Override public void close() { System.out.println(&quot;Xiaomiæ‰‹æœºå…³æœº&quot;); } } public abstract class Phone { private Brand brand; public Phone(Brand brand) { this.brand = brand; } protected void open() { brand.open(); } protected void close() { brand.close(); } } public class FoldedPhone extends Phone { public FoldedPhone(Brand brand) { super(brand); } public void open() { super.open(); System.out.println(&quot;æŠ˜å æ ·å¼æ‰‹æœº&quot;); } public void close() { super.close(); System.out.println(&quot;æŠ˜å æ ·å¼æ‰‹æœº&quot;); } } public class UpRightPhone extends Phone { //æ„é€ å™¨ public UpRightPhone(Brand brand) { super(brand); } public void open() { super.open(); System.out.println(&quot; ç›´ç«‹æ ·å¼æ‰‹æœº &quot;); } public void close() { super.close(); System.out.println(&quot; ç›´ç«‹æ ·å¼æ‰‹æœº &quot;); } } public class Client { public static void main(String[] args) { //è·å–æŠ˜å å¼æ‰‹æœº (æ ·å¼ + å“ç‰Œ ) Phone phone1 = new FoldedPhone(new Xiaomi()); phone1.open(); phone1.close(); System.out.println(&quot;=======================&quot;); Phone phone2 = new FoldedPhone(new Vivo()); phone2.open(); phone2.close(); System.out.println(&quot;==============&quot;); UpRightPhone phone3 = new UpRightPhone(new Xiaomi()); phone3.open(); phone3.close(); System.out.println(&quot;==============&quot;); UpRightPhone phone4 = new UpRightPhone(new Vivo()); phone4.open(); phone4.close(); } } ä¼˜ç¼ºç‚¹ å®ç°äº†æŠ½è±¡å’Œå®ç°éƒ¨åˆ†çš„åˆ†ç¦»ï¼Œä»è€Œæå¤§çš„æä¾›äº†ç³»ç»Ÿçš„çµæ´»æ€§ï¼Œè®©æŠ½è±¡éƒ¨åˆ†å’Œå®ç°éƒ¨åˆ†ç‹¬ç«‹å¼€æ¥ï¼Œè¿™æœ‰åŠ©äº ç³»ç»Ÿè¿›è¡Œåˆ†å±‚è®¾è®¡ï¼Œä»è€Œäº§ç”Ÿæ›´å¥½çš„ç»“æ„åŒ–ç³»ç»Ÿã€‚ å¯¹äºç³»ç»Ÿçš„é«˜å±‚éƒ¨åˆ†ï¼Œåªéœ€è¦çŸ¥é“æŠ½è±¡éƒ¨åˆ†å’Œå®ç°éƒ¨åˆ†çš„æ¥å£å°±å¯ä»¥äº†ï¼Œå…¶å®ƒçš„éƒ¨åˆ†ç”±å…·ä½“ä¸šåŠ¡æ¥å®Œæˆã€‚ æ¡¥æ¥æ¨¡å¼æ›¿ä»£å¤šå±‚ç»§æ‰¿æ–¹æ¡ˆï¼Œå¯ä»¥å‡å°‘å­ç±»çš„ä¸ªæ•°ï¼Œé™ä½ç³»ç»Ÿçš„ç®¡ç†å’Œç»´æŠ¤æˆæœ¬ã€‚ æ¡¥æ¥æ¨¡å¼çš„å¼•å…¥å¢åŠ äº†ç³»ç»Ÿçš„ç†è§£å’Œè®¾è®¡éš¾åº¦ï¼Œç”±äºèšåˆå…³è”å…³ç³»å»ºç«‹åœ¨æŠ½è±¡å±‚ï¼Œè¦æ±‚å¼€å‘è€…é’ˆå¯¹æŠ½è±¡è¿›è¡Œè®¾è®¡å’Œç¼–ç¨‹ æ¡¥æ¥æ¨¡å¼è¦æ±‚æ­£ç¡®è¯†åˆ«å‡ºç³»ç»Ÿä¸­ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦(æŠ½è±¡ã€å’Œå®ç°)ï¼Œå› æ­¤å…¶ä½¿ç”¨èŒƒå›´æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œå³éœ€è¦æœ‰è¿™æ ·çš„åº”ç”¨åœºæ™¯ã€‚ æ¡¥æ¥æ¨¡å¼å…¶å®ƒåº”ç”¨åœºæ™¯å¯¹äºé‚£äº›ä¸å¸Œæœ›ä½¿ç”¨ç»§æ‰¿æˆ–å› ä¸ºå¤šå±‚æ¬¡ç»§æ‰¿å¯¼è‡´ç³»ç»Ÿç±»çš„ä¸ªæ•°æ€¥å‰§å¢åŠ çš„ç³»ç»Ÿï¼Œæ¡¥æ¥æ¨¡å¼å°¤ä¸ºé€‚ç”¨.","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"/tags/è®¾è®¡æ¨¡å¼/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"é€‚é…å™¨æ¨¡å¼","slug":"æŠ€æœ¯/é€‚é…å™¨æ¨¡å¼","date":"2020-10-08T15:30:00.000Z","updated":"2022-10-09T15:19:10.437Z","comments":true,"path":"2020/10/08/æŠ€æœ¯/é€‚é…å™¨æ¨¡å¼/","link":"","permalink":"/2020/10/08/æŠ€æœ¯/é€‚é…å™¨æ¨¡å¼/","excerpt":"","text":"åŸºæœ¬ä»‹ç» é€‚é…å™¨æ¨¡å¼(AdapterPattern)å°†æŸä¸ªç±»çš„æ¥å£è½¬æ¢æˆå®¢æˆ·ç«¯æœŸæœ›çš„å¦ä¸€ä¸ªæ¥å£è¡¨ç¤ºï¼Œä¸»çš„ç›®çš„æ˜¯å…¼å®¹æ€§ï¼Œè®©åŸæœ¬ å› æ¥å£ä¸åŒ¹é…ä¸èƒ½ä¸€èµ·å·¥ä½œçš„ä¸¤ä¸ªç±»å¯ä»¥ååŒå·¥ä½œã€‚å…¶åˆ«åä¸ºåŒ…è£…å™¨(Wrapper)å°šç¡…è°· Java è®¾è®¡æ¨¡å¼ç¬¬ 9 ç«  é€‚é…å™¨è®¾è®¡æ¨¡å¼ 9.1 ç°å®ç”Ÿæ´»ä¸­çš„é€‚é…å™¨ä¾‹å­ é€‚é…å™¨æ¨¡å¼å±äºç»“æ„å‹æ¨¡å¼ ä¸»è¦åˆ†ä¸ºä¸‰ç±»:ç±»é€‚é…å™¨æ¨¡å¼ã€å¯¹è±¡é€‚é…å™¨æ¨¡å¼ã€æ¥å£é€‚é…å™¨æ¨¡å¼ 1.ç±»é€‚é…å™¨æ¨¡å¼ åº”ç”¨å®ä¾‹è¯´æ˜ ä»¥ç”Ÿæ´»ä¸­å……ç”µå™¨çš„ä¾‹å­æ¥è®²è§£é€‚é…å™¨ï¼Œå……ç”µå™¨æœ¬èº«ç›¸å½“äº Adapterï¼Œ220V äº¤æµç”µç›¸å½“äº src (å³è¢«é€‚é…è€…)ï¼Œæˆ‘ä»¬ çš„ç›® dst(å³ ç›®æ ‡)æ˜¯ 5V ç›´æµç”µ UML CODE public class Voltage220V { public int output220V() { int src = 220; System.out.println(&quot;ç”µå‹=&quot; + src + &quot;V&quot;); return src; } } public interface IVoltage5V { public int output5V(); } public class VoltageAdapter extends Voltage220V implements IVoltage5V{ @Override public int output5V() { int srcV = output220V(); int dstV = srcV / 44; return dstV; } } public class Client { public static void main(String[] args) { System.out.println(&quot;ç±»é€‚é…å™¨æ¨¡å¼&quot;); VoltageAdapter voltageAdapter = new VoltageAdapter(); System.out.println(&quot;è½¬æ¢åç”µå‹&quot; + voltageAdapter.output5V()); } } ä¼˜ç¼ºç‚¹ Java æ˜¯å•ç»§æ‰¿æœºåˆ¶ï¼Œæ‰€ä»¥ç±»é€‚é…å™¨éœ€è¦ç»§æ‰¿ src ç±»è¿™ä¸€ç‚¹ç®—æ˜¯ä¸€ä¸ªç¼ºç‚¹, å› ä¸ºè¿™è¦æ±‚ dst å¿…é¡»æ˜¯æ¥å£ï¼Œæœ‰ä¸€å®šå±€ é™æ€§; src ç±»çš„æ–¹æ³•åœ¨ Adapter ä¸­éƒ½ä¼šæš´éœ²å‡ºæ¥ï¼Œä¹Ÿå¢åŠ äº†ä½¿ç”¨çš„æˆæœ¬ã€‚ ç”±äºå…¶ç»§æ‰¿äº†srcç±»ï¼Œæ‰€ä»¥å®ƒå¯ä»¥æ ¹æ®éœ€æ±‚é‡å†™srcç±»çš„æ–¹æ³•ï¼Œä½¿å¾—Adapterçš„çµæ´»æ€§å¢å¼ºäº†ã€‚ 2.å¯¹è±¡é€‚é…å™¨æ¨¡å¼ä»‹ç» æ ¹æ®â€œåˆæˆå¤ç”¨åŸåˆ™â€ï¼Œåœ¨ç³»ç»Ÿä¸­å°½é‡ä½¿ç”¨å…³è”å…³ç³»(èšåˆ)æ¥æ›¿ä»£ç»§æ‰¿å…³ç³»ã€‚ UML CODE public interface IVoltage5V { public int output5V(); } public class Voltage220V { public int output220V() { int src = 220; System.out.println(&quot;ç”µå‹=&quot; + src + &quot;V&quot;); return src; } } public class VoltageAdapter implements IVoltage5V { private Voltage220V voltage220V; public VoltageAdapter(Voltage220V voltage220V) { this.voltage220V = voltage220V; } @Override public int output5V() { int srcV = voltage220V.output220V(); int dstV = srcV / 44; return dstV; } } public class Client { public static void main(String[] args) { System.out.println(&quot;ç±»é€‚é…å™¨æ¨¡å¼&quot;); VoltageAdapter voltageAdapter = new VoltageAdapter(new Voltage220V()); System.out.println(&quot;è½¬æ¢åç”µå‹&quot; + voltageAdapter.output5V() + &quot;V&quot;); } } ä¼˜ç¼ºç‚¹ å¯¹è±¡é€‚é…å™¨å’Œç±»é€‚é…å™¨å…¶å®ç®—æ˜¯åŒä¸€ç§æ€æƒ³ï¼Œåªä¸è¿‡å®ç°æ–¹å¼ä¸åŒã€‚ æ ¹æ®åˆæˆå¤ç”¨åŸåˆ™ï¼Œä½¿ç”¨ç»„åˆæ›¿ä»£ç»§æ‰¿ï¼Œ æ‰€ä»¥å®ƒè§£å†³äº†ç±»é€‚é…å™¨å¿…é¡»ç»§æ‰¿ src çš„å±€é™æ€§é—®é¢˜ï¼Œä¹Ÿä¸å†è¦æ±‚ dst å¿…é¡»æ˜¯æ¥å£ã€‚ 3.æ¥å£é€‚é…å™¨æ¨¡å¼ä»‹ç» ä¸€äº›ä¹¦ç±ç§°ä¸º:é€‚é…å™¨æ¨¡å¼(DefaultAdapterPattern)æˆ–ç¼ºçœé€‚é…å™¨æ¨¡å¼ã€‚ æ ¸å¿ƒæ€è·¯:å½“ä¸éœ€è¦å…¨éƒ¨å®ç°æ¥å£æä¾›çš„æ–¹æ³•æ—¶ï¼Œå¯å…ˆè®¾è®¡ä¸€ä¸ªæŠ½è±¡ç±»å®ç°æ¥å£ï¼Œå¹¶ä¸ºè¯¥æ¥å£ä¸­æ¯ä¸ªæ–¹æ³•æä¾›ä¸€ä¸ªé»˜è®¤å®ç°(ç©ºæ–¹æ³•)ï¼Œé‚£ä¹ˆè¯¥æŠ½è±¡ç±»çš„å­ç±»å¯æœ‰é€‰æ‹©åœ°è¦†ç›–çˆ¶ç±»çš„æŸäº›æ–¹æ³•æ¥å®ç°éœ€æ±‚ é€‚ç”¨äºä¸€ä¸ªæ¥å£ä¸æƒ³ä½¿ç”¨å…¶æ‰€æœ‰çš„æ–¹æ³•çš„æƒ…å†µã€‚ UML CODE public interface Interface4 { public void m1(); public void m2(); public void m3(); public void m4(); } public abstract class AbsAdapter implements Interface4{ //é»˜è®¤å®ç° @Override public void m1() { } @Override public void m2() { } @Override public void m3() { } @Override public void m4() { } } public class Client { public static void main(String[] args) { AbsAdapter absAdapter = new AbsAdapter() { //åªéœ€è¦å»è¦†ç›–æˆ‘ä»¬ éœ€è¦ä½¿ç”¨ æ¥å£æ–¹æ³• @Override public void m1() { System.out.println(&quot;m1 method&quot;); } }; absAdapter.m1(); } }","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"/tags/è®¾è®¡æ¨¡å¼/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"å»ºé€ è€…æ¨¡å¼","slug":"æŠ€æœ¯/å»ºé€ è€…æ¨¡å¼","date":"2020-10-08T03:30:00.000Z","updated":"2022-10-09T15:19:10.433Z","comments":true,"path":"2020/10/08/æŠ€æœ¯/å»ºé€ è€…æ¨¡å¼/","link":"","permalink":"/2020/10/08/æŠ€æœ¯/å»ºé€ è€…æ¨¡å¼/","excerpt":"","text":"åŸºæœ¬ä»‹ç» å»ºé€ è€…æ¨¡å¼(BuilderPattern)åˆå«ç”Ÿæˆå™¨æ¨¡å¼ï¼Œæ˜¯ä¸€ç§å¯¹è±¡æ„å»ºæ¨¡å¼ã€‚å®ƒå¯ä»¥å°†å¤æ‚å¯¹è±¡çš„å»ºé€ è¿‡ç¨‹æŠ½è±¡å‡º æ¥(æŠ½è±¡ç±»åˆ«)ï¼Œä½¿è¿™ä¸ªæŠ½è±¡è¿‡ç¨‹çš„ä¸åŒå®ç°æ–¹æ³•å¯ä»¥æ„é€ å‡ºä¸åŒè¡¨ç°(å±æ€§)çš„å¯¹è±¡ã€‚ å»ºé€ è€…æ¨¡å¼çš„å››ä¸ªè§’è‰² Product(äº§å“è§’è‰²): ä¸€ä¸ªå…·ä½“çš„äº§å“å¯¹è±¡ã€‚ Builder(æŠ½è±¡å»ºé€ è€…): åˆ›å»ºä¸€ä¸ª Product å¯¹è±¡çš„å„ä¸ªéƒ¨ä»¶æŒ‡å®šçš„ æ¥å£/æŠ½è±¡ç±»ã€‚ ConcreteBuilder(å…·ä½“å»ºé€ è€…): å®ç°æ¥å£ï¼Œæ„å»ºå’Œè£…é…å„ä¸ªéƒ¨ä»¶ã€‚ Director(æŒ‡æŒ¥è€…): æ„å»ºä¸€ä¸ªä½¿ç”¨ Builder æ¥å£çš„å¯¹è±¡ã€‚å®ƒä¸»è¦æ˜¯ç”¨äºåˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ã€‚å®ƒä¸»è¦æœ‰ä¸¤ä¸ªä½œç”¨ï¼Œä¸€æ˜¯:éš”ç¦»äº†å®¢æˆ·ä¸å¯¹è±¡çš„ç”Ÿäº§è¿‡ç¨‹ï¼ŒäºŒæ˜¯:è´Ÿè´£æ§åˆ¶äº§å“å¯¹è±¡çš„ç”Ÿäº§è¿‡ç¨‹ã€‚ å»ºé€ è€…æ¨¡å¼è§£å†³ç›–æˆ¿éœ€æ±‚ éœ€è¦å»ºæˆ¿å­:è¿™ä¸€è¿‡ç¨‹ä¸ºæ‰“æ¡©ã€ç Œå¢™ã€å°é¡¶ã€‚ä¸ç®¡æ˜¯æ™®é€šæˆ¿å­ä¹Ÿå¥½ï¼Œåˆ«å¢…ä¹Ÿå¥½éƒ½éœ€è¦ç»å†è¿™äº›è¿‡ç¨‹ï¼Œä¸‹é¢æˆ‘ä»¬ ä½¿ç”¨å»ºé€ è€…æ¨¡å¼(Builder Pattern)æ¥å®Œæˆ UML CODE public abstract class HouseBuilder { protected House house = new House(); //å»ºé€ çš„æµç¨‹æµç¨‹å†™å¥½ public abstract void buildBasic(); public abstract void buildWalls(); public abstract void roofed(); //å»ºé€ å¥½æˆ¿å­ï¼Œå°†äº§å“è¿”å› public House buildHouse() { return house; } } public class CommonHouseBuilder extends HouseBuilder { @Override public void buildBasic() { System.out.println(&quot;æ™®é€šæˆ¿å­æ‰“åœ°åŸº5ç±³&quot;); } @Override public void buildWalls() { System.out.println(&quot;æ™®é€šæˆ¿å­ç Œå¢™10å˜ç±³&quot;); } @Override public void roofed() { System.out.println(&quot;æ™®é€šæˆ¿å­å±‹é¡¶&quot;); } } public class HighHouseBuilder extends HouseBuilder { @Override public void buildBasic() { System.out.println(&quot; é«˜æ¥¼çš„æ‰“åœ°åŸº100ç±³ &quot;); } @Override public void buildWalls() { System.out.println(&quot; é«˜æ¥¼çš„ç Œå¢™20å˜ç±³ &quot;); } @Override public void roofed() { System.out.println(&quot; é«˜æ¥¼çš„é€æ˜å±‹é¡¶ &quot;); } } public class HouseDirector { HouseBuilder houseBuilder; public HouseDirector(HouseBuilder houseBuilder) { this.houseBuilder = houseBuilder; } //å¦‚ä½•å¤„ç†å»ºé€ æˆ¿å­çš„æµç¨‹ï¼Œäº¤ç»™æŒ‡æŒ¥è€… public House constructHouse() { houseBuilder.buildBasic(); houseBuilder.buildWalls(); houseBuilder.roofed(); return houseBuilder.buildHouse(); } } public class House { public String base; public String wall; public String rooted; } public class Client { public static void main(String[] args) { HouseDirector houseDirector = new HouseDirector(new CommonHouseBuilder()); //å®Œæˆç›–æˆ¿å­ï¼Œè¿”å›äº§å“(æ™®é€šæˆ¿å­) House house = houseDirector.constructHouse(); } } ä¼˜ç‚¹ äº§å“å’Œäº§å“å»ºé€ è¿‡ç¨‹è§£è€¦ï¼Œä¾¿äºæ‰©å±•å’Œç»´æŠ¤","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"/tags/è®¾è®¡æ¨¡å¼/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"åŸå‹æ¨¡å¼","slug":"æŠ€æœ¯/åŸå‹æ¨¡å¼","date":"2020-10-07T14:28:00.000Z","updated":"2022-10-09T15:19:10.433Z","comments":true,"path":"2020/10/07/æŠ€æœ¯/åŸå‹æ¨¡å¼/","link":"","permalink":"/2020/10/07/æŠ€æœ¯/åŸå‹æ¨¡å¼/","excerpt":"","text":"åŸºæœ¬ä»‹ç» åŸå‹æ¨¡å¼(Prototypeæ¨¡å¼)æ˜¯æŒ‡:ç”¨åŸå‹å®ä¾‹æŒ‡å®šåˆ›å»ºå¯¹è±¡çš„ç§ç±»ï¼Œå¹¶ä¸”é€šè¿‡æ‹·è´è¿™äº›åŸå‹ï¼Œåˆ›å»ºæ–°çš„å¯¹è±¡ 1.åŸºæœ¬ç±»å‹çš„æ‹·è´CODE public class Sheep implements Cloneable{ public String name; public int age; public Sheep friend;//æ˜¯å¯¹è±¡, å…‹éš†æ˜¯ä¼šå¦‚ä½•å¤„ç†, é»˜è®¤æ˜¯æµ…æ‹·è´ public Sheep(String name, int age) { this.name = name; this.age = age; } @Override protected Object clone() throws CloneNotSupportedException { return super.clone(); } } public class Client { public static void main(String[] args) throws CloneNotSupportedException { Sheep sheep1 = new Sheep(&quot;zhangsan&quot;,1); Sheep sheep2 = new Sheep(&quot;lisi&quot;, 2); sheep1.friend = sheep2; sheep2.friend = sheep1; Sheep sheep3 = (Sheep)sheep1.clone(); System.out.println(sheep3 == sheep1);//false System.out.println(sheep3.friend == sheep1.friend);//true } } æ³¨æ„ æˆå‘˜å˜é‡ä¸ºå¯¹è±¡æ—¶ï¼Œå…‹éš†æ˜¯æµ…æ‹·è´ï¼Œä½¿ç”¨é»˜è®¤æ‹·è´æ˜¯æ‹·è´çš„åœ°å€ 2.æ·±æ‹·è´åŸºæœ¬ä»‹ç» å¤åˆ¶å¯¹è±¡çš„æ‰€æœ‰åŸºæœ¬æ•°æ®ç±»å‹çš„æˆå‘˜å˜é‡å€¼ ä¸ºæ‰€æœ‰å¼•ç”¨æ•°æ®ç±»å‹çš„æˆå‘˜å˜é‡ç”³è¯·å­˜å‚¨ç©ºé—´ï¼Œå¹¶å¤åˆ¶æ¯ä¸ªå¼•ç”¨æ•°æ®ç±»å‹æˆå‘˜å˜é‡æ‰€å¼•ç”¨çš„å¯¹è±¡ï¼Œç›´åˆ°è¯¥å¯¹è±¡å¯è¾¾çš„æ‰€æœ‰å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¯¹è±¡è¿›è¡Œæ·±æ‹·è´è¦å¯¹æ•´ä¸ªå¯¹è±¡(åŒ…æ‹¬å¯¹è±¡çš„å¼•ç”¨ç±»å‹)è¿›è¡Œæ‹·è´ æ·±æ‹·è´å®ç°æ–¹å¼1:é‡å†™cloneæ–¹æ³•æ¥å®ç°æ·±æ‹·è´ æ·±æ‹·è´å®ç°æ–¹å¼2:é€šè¿‡å¯¹è±¡åºåˆ—åŒ–å®ç°æ·±æ‹·è´(æ¨è) CODE package blog.prototype; import java.io.Serializable; public class DeepCloneableTarget implements Serializable, Cloneable { public String cloneName; public String cloneClass; public DeepCloneableTarget(String cloneName, String cloneClass) { this.cloneName = cloneName; this.cloneClass = cloneClass; } //å› ä¸ºè¯¥ç±»çš„å±æ€§ï¼Œéƒ½æ˜¯ String , å› æ­¤æˆ‘ä»¬è¿™é‡Œä½¿ç”¨é»˜è®¤çš„ clone å®Œæˆå³å¯ @Override protected Object clone() throws CloneNotSupportedException { return super.clone(); } } package blog.prototype; import java.io.*; public class DeepProtoType implements Serializable, Cloneable { public String name; public DeepCloneableTarget deepCloneableTarget; //æ·±æ‹·è´ - æ–¹å¼ 1 ä½¿ç”¨clone æ–¹æ³• @Override protected Object clone() throws CloneNotSupportedException { Object deep = null; //è¿™é‡Œå®Œæˆå¯¹åŸºæœ¬æ•°æ®ç±»å‹(å±æ€§)å’Œ String çš„å…‹éš† deep = super.clone(); //å¯¹å¼•ç”¨ç±»å‹çš„å±æ€§ï¼Œè¿›è¡Œå•ç‹¬å¤„ç† DeepProtoType deepProtoType = (DeepProtoType)deep; deepProtoType.deepCloneableTarget = (DeepCloneableTarget)deepCloneableTarget.clone(); return deepProtoType; } //æ·±æ‹·è´ - æ–¹å¼ 2 é€šè¿‡å¯¹è±¡çš„åºåˆ—åŒ–å®ç° (æ¨è) public Object deepClone() { //åˆ›å»ºæµå¯¹è±¡ ByteArrayOutputStream bos = null; ObjectOutputStream oos = null; ByteArrayInputStream bis = null; ObjectInputStream ois = null; DeepProtoType copyObj = null; try { //åºåˆ—åŒ– bos = new ByteArrayOutputStream(); oos = new ObjectOutputStream(bos); oos.writeObject(this); //å½“å‰è¿™ä¸ªå¯¹è±¡ä»¥å¯¹è±¡æµçš„æ–¹å¼è¾“å‡º //ååºåˆ—åŒ– bis = new ByteArrayInputStream(bos.toByteArray()); ois = new ObjectInputStream(bis); copyObj = (DeepProtoType)ois.readObject(); } catch (Exception e) { e.printStackTrace(); } finally { try { bos.close(); oos.close(); bis.close(); ois.close(); } catch (IOException e) { e.printStackTrace(); } } return copyObj; } } package blog.prototype; public class Client { public static void main(String[] args) throws CloneNotSupportedException { DeepCloneableTarget deepCloneableTarget = new DeepCloneableTarget(&quot;cloneName&quot;,&quot;cloneClass&quot;); DeepProtoType deepProtoType = new DeepProtoType(); deepProtoType.name = &quot;DeepProtoType&quot;; deepProtoType.deepCloneableTarget = deepCloneableTarget; DeepProtoType deepProtoType1 = (DeepProtoType) deepProtoType.clone(); System.out.println(deepProtoType1.name); System.out.println(deepProtoType1.deepCloneableTarget.cloneName); System.out.println(deepProtoType.deepCloneableTarget == deepProtoType1.deepCloneableTarget);//false DeepProtoType deepProtoType2 = (DeepProtoType) deepProtoType.deepClone(); System.out.println(deepProtoType2.name); System.out.println(deepProtoType2.deepCloneableTarget.cloneName); System.out.println(deepProtoType.deepCloneableTarget == deepProtoType2.deepCloneableTarget);//false } } ä¼˜ç¼ºç‚¹ åˆ›å»ºæ–°çš„å¯¹è±¡æ¯”è¾ƒå¤æ‚æ—¶ï¼Œå¯ä»¥åˆ©ç”¨åŸå‹æ¨¡å¼ç®€åŒ–å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¤Ÿæé«˜æ•ˆç‡ ä¸ç”¨é‡æ–°åˆå§‹åŒ–å¯¹è±¡ï¼Œè€Œæ˜¯åŠ¨æ€åœ°è·å¾—å¯¹è±¡è¿è¡Œæ—¶çš„çŠ¶æ€ å¦‚æœåŸå§‹å¯¹è±¡å‘ç”Ÿå˜åŒ–(å¢åŠ æˆ–è€…å‡å°‘å±æ€§)ï¼Œå…¶å®ƒå…‹éš†å¯¹è±¡çš„ä¹Ÿä¼šå‘ç”Ÿç›¸åº”çš„å˜åŒ–ï¼Œæ— éœ€ä¿®æ”¹ä»£ç  åœ¨å®ç°æ·±å…‹éš†çš„æ—¶å€™å¯èƒ½éœ€è¦æ¯”è¾ƒå¤æ‚çš„ä»£ç  ç¼ºç‚¹:éœ€è¦ä¸ºæ¯ä¸€ä¸ªç±»é…å¤‡ä¸€ä¸ªå…‹éš†æ–¹æ³•ï¼Œè¿™å¯¹å…¨æ–°çš„ç±»æ¥è¯´ä¸æ˜¯å¾ˆéš¾ï¼Œä½†å¯¹å·²æœ‰çš„ç±»è¿›è¡Œæ”¹é€ æ—¶ï¼Œéœ€è¦ä¿®æ”¹å…¶æºä»£ç ï¼Œè¿èƒŒäº† ocp åŸåˆ™ï¼Œè¿™ç‚¹è¯·æ³¨æ„.","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"/tags/è®¾è®¡æ¨¡å¼/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"å·¥å‚æ¨¡å¼","slug":"æŠ€æœ¯/å·¥å‚æ¨¡å¼","date":"2020-10-07T06:00:00.000Z","updated":"2022-10-09T15:19:10.433Z","comments":true,"path":"2020/10/07/æŠ€æœ¯/å·¥å‚æ¨¡å¼/","link":"","permalink":"/2020/10/07/æŠ€æœ¯/å·¥å‚æ¨¡å¼/","excerpt":"","text":"1.ç®€å•å·¥å‚æ¨¡å¼çœ‹ä¸€ä¸ªæŠ«è¨çš„é¡¹ç›®:è¦ä¾¿äºæŠ«è¨ç§ç±»çš„æ‰©å±•ï¼Œè¦ä¾¿äºç»´æŠ¤ æŠ«è¨çš„ç§ç±»å¾ˆå¤š(æ¯”å¦‚ GreekPizzã€CheesePizz ç­‰) æŠ«è¨çš„åˆ¶ä½œæœ‰ prepareï¼Œbake, cut, box å®ŒæˆæŠ«è¨åº—è®¢è´­åŠŸèƒ½ã€‚ æ€è·¯ æŠŠåˆ›å»º Pizza å¯¹è±¡å°è£…åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œè¿™æ ·æˆ‘ä»¬æœ‰æ–°çš„ Pizza ç§ç±»æ—¶ï¼Œåªéœ€è¦ä¿®æ”¹è¯¥ç±»å°±å¯ï¼Œå…¶å®ƒæœ‰åˆ›å»ºåˆ° Pizza å¯¹è±¡çš„ä»£ç å°±ä¸éœ€è¦ä¿®æ”¹äº† UML package blog.factory; import blog.factory.pizza.CheesePizza; import blog.factory.pizza.GreekPizza; import blog.factory.pizza.Pizza; public class SimpleFactory { //ç®€å•å·¥å‚æ¨¡å¼ public Pizza createPizza(String orderType) { Pizza pizza = null; if (orderType.equals(&quot;å¥¶é…ª&quot;)) { pizza = new CheesePizza(); pizza.setName(&quot;å¥¶é…ªæŠ«è¨&quot;); } else if (orderType.equals(&quot;å¸Œè…Š&quot;)) { pizza = new GreekPizza(); pizza.setName(&quot;å¸Œè…ŠæŠ«è¨&quot;); } return pizza; } //ç®€å•å·¥å‚æ¨¡å¼ï¼Œé™æ€å·¥å‚æ¨¡å¼ public static Pizza createPizza2(String orderType) { Pizza pizza = null; if (orderType.equals(&quot;å¥¶é…ª&quot;)) { pizza = new CheesePizza(); pizza.setName(&quot;å¥¶é…ªæŠ«è¨&quot;); } else if (orderType.equals(&quot;å¸Œè…Š&quot;)) { pizza = new GreekPizza(); pizza.setName(&quot;å¸Œè…ŠæŠ«è¨&quot;); } return pizza; } } package blog.factory; import blog.factory.pizza.Pizza; public class OrderPizza { private SimpleFactory simpleFactory; public OrderPizza(SimpleFactory simpleFactory) { this.simpleFactory = simpleFactory; } public void makePizza(String orderType) { Pizza pizza = simpleFactory.createPizza(orderType); pizza.prepare(); pizza.bake(); pizza.cut(); pizza.box(); } } package blog.factory; public class Test { public static void main(String[] args) { OrderPizza orderPizza = new OrderPizza(new SimpleFactory()); orderPizza.makePizza(&quot;å¸Œè…Š&quot;); } } package blog.factory.pizza; public abstract class Pizza { private String name; //ä¸åŒç±»å‹åˆ¶ä½œææ–™çš„å‡†å¤‡ä¸åŒ public abstract void prepare(); public void bake() { System.out.println(name + &quot;baking&quot;); } public void cut() { System.out.println(name + &quot;cutting&quot;); } public void box() { System.out.println(name + &quot;boxing&quot;); } public String getName() { return name; } public void setName(String name) { this.name = name; } } package blog.factory.pizza; public class GreekPizza extends Pizza { @Override public void prepare() { System.out.println(&quot;ç»™å¸Œè…ŠæŠ«è¨å‡†å¤‡åŸææ–™&quot;); } } package blog.factory.pizza; public class CheesePizza extends Pizza{ @Override public void prepare() { System.out.println(&quot;åˆ¶ä½œå¥¶é…ªæŠ«è¨ï¼Œå‡†å¤‡ææ–™&quot;); } } 2.å·¥å‚æ–¹æ³•æ¨¡å¼éœ€æ±‚ æŠ«è¨é¡¹ç›®æ–°çš„éœ€æ±‚:å®¢æˆ·åœ¨ç‚¹æŠ«è¨æ—¶ï¼Œå¯ä»¥ç‚¹ä¸åŒå£å‘³çš„æŠ«è¨ï¼Œæ¯”å¦‚ åŒ—äº¬çš„å¥¶é…ª pizzaã€åŒ—äº¬çš„å¸Œè…Š pizza æˆ– è€…æ˜¯ä¼¦æ•¦çš„å¥¶é…ª pizzaã€ä¼¦æ•¦çš„å¸Œè…Š pizzaã€‚ æ€è·¯ ä½¿ç”¨ç®€å•å·¥å‚æ¨¡å¼ï¼Œåˆ›å»ºä¸åŒçš„ç®€å•å·¥å‚ç±»ï¼Œæ¯”å¦‚ BJPizzaSimpleFactoryã€LDPizzaSimpleFactory ç­‰ç­‰.ä»å½“å‰è¿™ä¸ªæ¡ˆä¾‹æ¥è¯´ï¼Œä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯è€ƒè™‘åˆ°é¡¹ç›®çš„è§„æ¨¡ï¼Œä»¥åŠè½¯ä»¶çš„å¯ç»´æŠ¤æ€§ã€å¯æ‰©å±•æ€§å¹¶ä¸æ˜¯ç‰¹åˆ«å¥½ å·¥å‚æ–¹æ³•æ¨¡å¼è®¾è®¡æ–¹æ¡ˆ:å°†æŠ«è¨é¡¹ç›®çš„å®ä¾‹åŒ–åŠŸèƒ½æŠ½è±¡æˆæŠ½è±¡æ–¹æ³•ï¼Œåœ¨ä¸åŒçš„å£å‘³ç‚¹é¤å­ç±»ä¸­å…·ä½“å®ç°ã€‚ å·¥å‚æ–¹æ³•æ¨¡å¼:å®šä¹‰äº†ä¸€ä¸ªåˆ›å»ºå¯¹è±¡çš„æŠ½è±¡æ–¹æ³•ï¼Œç”±å­ç±»å†³å®šè¦å®ä¾‹åŒ–çš„ç±»ã€‚å·¥å‚æ–¹æ³•æ¨¡å¼å°†å¯¹è±¡çš„å®ä¾‹ åŒ–æ¨è¿Ÿåˆ°å­ç±»ã€‚UML CODE public abstract class PizzaFactory { public abstract Pizza createPizza(String orderType); } public class BJPizzaFactory extends PizzaFactory{ @Override public Pizza createPizza(String orderType) { Pizza pizza = null; if (orderType.equals(&quot;cheese&quot;)) { pizza = new BJGreekPizza(); } else if (orderType.equals(&quot;greek&quot;)) { pizza = new BJGreekPizza(); } return pizza; } } public class LDPizzaFactory extends PizzaFactory{ @Override public Pizza createPizza(String orderType) { Pizza pizza = null; if (orderType.equals(&quot;cheese&quot;)) { pizza = new LDCheesePizza(); } else if (orderType.equals(&quot;greek&quot;)) { pizza = new LDGreekOPizza(); } return pizza; } } public class Order { private PizzaFactory pizzaFactory; public Order(PizzaFactory pizzaFactory) { this.pizzaFactory = pizzaFactory; } public void makePizza(String type) { Pizza pizza = pizzaFactory.createPizza(type); pizza.prepare(); pizza.bake(); pizza.cut(); pizza.box(); } } public class Client { public static void main(String[] args) { Order order = new Order(new LDPizzaFactory()); order.makePizza(&quot;greek&quot;); } } 3.æŠ½è±¡å·¥å‚æ¨¡å¼æ€è·¯ å°†å·¥å‚æŠ½è±¡æˆä¸¤å±‚ï¼ŒAbsFactory(æŠ½è±¡å·¥å‚) å’Œ å…·ä½“å®ç°çš„å·¥å‚å­ç±»ï¼Œå®Œæˆäº†å¯¹åœ°ç‚¹BJå’ŒLDçš„åŒºåˆ† UML CODE public interface AbsFactory { public Pizza createPizza(String orderType); } public class BJFactory implements AbsFactory { @Override public Pizza createPizza(String orderType) { Pizza pizza = null; if (orderType.equals(&quot;cheese&quot;)) { pizza = new BJCheesePizza(); } else if (orderType.equals(&quot;greek&quot;)) { pizza = new BJGreekPizza(); } return pizza; } } public class LDFactory implements AbsFactory { @Override public Pizza createPizza(String orderType) { Pizza pizza = null; if (orderType.equals(&quot;cheese&quot;)) { pizza = new LDCheesePizza(); } else if (orderType.equals(&quot;greek&quot;)) { pizza = new LDGreekOPizza(); } return pizza; } } public class Order { private AbsFactory absFactory; public Order(AbsFactory absFactory) { this.absFactory = absFactory; } public void makePizza(String type) { Pizza pizza = absFactory.createPizza(type); pizza.prepare(); pizza.bake(); pizza.cut(); pizza.box(); } } public class Client { public static void main(String[] args) { Order order = new Order(new LDFactory()); order.makePizza(&quot;cheese&quot;); } }","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"/tags/è®¾è®¡æ¨¡å¼/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]},{"title":"å•ä¾‹æ¨¡å¼","slug":"æŠ€æœ¯/å•ä¾‹æ¨¡å¼","date":"2020-10-06T14:28:00.000Z","updated":"2022-10-09T15:19:10.433Z","comments":true,"path":"2020/10/06/æŠ€æœ¯/å•ä¾‹æ¨¡å¼/","link":"","permalink":"/2020/10/06/æŠ€æœ¯/å•ä¾‹æ¨¡å¼/","excerpt":"","text":"1.é¥¿æ±‰å¼(é™æ€å¸¸é‡)package blog.singleton; public class SingletonTest { public static void main(String[] args) { Singleton singleton1 = Singleton.getInstance(); Singleton singleton2 = Singleton.getInstance(); System.out.println(singleton1 == singleton2); } } class Singleton { // 1.æ„é€ å™¨ç§æœ‰åŒ–ï¼Œé˜²æ­¢å¤–éƒ¨new private Singleton() {} // 2.åœ¨è£…è½½æ—¶ï¼Œå®Œæˆå®ä¾‹åŒ– private final static Singleton instance = new Singleton(); // 3.é€šè¿‡å…¬æœ‰é™æ€æ–¹æ³•ï¼Œè¿”å›å®ä¾‹å¯¹è±¡ public static Singleton getInstance() { return instance; } } ä¼˜ç‚¹ ç±»è£…è½½çš„æ—¶å€™å°±å®Œæˆå®ä¾‹åŒ–ã€‚é¿å…äº†çº¿ç¨‹åŒæ­¥é—®é¢˜ã€‚ ç¼ºç‚¹ åœ¨ç±»è£…è½½çš„æ—¶å€™å°±å®Œæˆå®ä¾‹åŒ–ï¼Œæ²¡æœ‰è¾¾åˆ°LazyLoadingçš„æ•ˆæœã€‚å¦‚æœä»å§‹è‡³ç»ˆä»æœªä½¿ç”¨è¿‡è¿™ä¸ªå®ä¾‹ï¼Œåˆ™ä¼šé€ æˆå†…å­˜çš„æµªè´¹ è¿™ç§æ–¹å¼åŸºäºclassloderæœºåˆ¶é¿å…äº†å¤šçº¿ç¨‹çš„åŒæ­¥é—®é¢˜ï¼Œä¸è¿‡ï¼Œinstanceåœ¨ç±»è£…è½½æ—¶å°±å®ä¾‹åŒ–ï¼Œåœ¨å•ä¾‹æ¨¡å¼ä¸­å¤§ å¤šæ•°éƒ½æ˜¯è°ƒç”¨ getInstance æ–¹æ³•ï¼Œä½†æ˜¯å¯¼è‡´ç±»è£…è½½çš„åŸå› æœ‰å¾ˆå¤šç§ï¼Œå› æ­¤ä¸èƒ½ç¡®å®šæœ‰å…¶ä»–çš„æ–¹å¼(æˆ–è€…å…¶ä»–çš„é™ æ€æ–¹æ³•)å¯¼è‡´ç±»è£…è½½ï¼Œè¿™æ—¶å€™åˆå§‹åŒ– instance å°±æ²¡æœ‰è¾¾åˆ° lazy loading çš„æ•ˆæœ ç»“è®º è¿™ç§å•ä¾‹æ¨¡å¼å¯ç”¨ï¼Œå¯èƒ½é€ æˆå†…å­˜æµªè´¹ 2.é¥¿æ±‰å¼(é™æ€ä»£ç å—)class Singleton { private Singleton() {} private static Singleton instance; { instance = new Singleton(); } public static Singleton getInstance() { return instance; } } ä¼˜ç‚¹ç¼ºç‚¹è¿™ç§æ–¹å¼å’Œä¸Šé¢çš„æ–¹å¼å…¶å®ç±»ä¼¼ï¼Œåªä¸è¿‡å°†ç±»å®ä¾‹åŒ–çš„è¿‡ç¨‹æ”¾åœ¨äº†é™æ€ä»£ç å—ä¸­ï¼Œä¹Ÿæ˜¯åœ¨ç±»è£…è½½çš„æ—¶å€™ï¼Œå°±æ‰§ è¡Œé™æ€ä»£ç å—ä¸­çš„ä»£ç ï¼Œåˆå§‹åŒ–ç±»çš„å®ä¾‹ã€‚ä¼˜ç¼ºç‚¹å’Œä¸Šé¢æ˜¯ä¸€æ ·çš„ã€‚ ç»“è®ºè¿™ç§å•ä¾‹æ¨¡å¼å¯ç”¨ï¼Œä½†æ˜¯å¯èƒ½é€ æˆå†…å­˜æµªè´¹ 3.æ‡’æ±‰å¼(çº¿ç¨‹ä¸å®‰å…¨)class Singleton { private static Singleton instance; private Singleton(){} public static Singleton getInstance() { if (instance == null) { instance = new Singleton(); } return instance; } } ä¼˜ç¼ºç‚¹ èµ·åˆ°äº†LazyLoadingçš„æ•ˆæœï¼Œä½†æ˜¯åªèƒ½åœ¨å•çº¿ç¨‹ä¸‹ä½¿ç”¨ã€‚ å¦‚æœåœ¨å¤šçº¿ç¨‹ä¸‹ï¼Œä¸€ä¸ªçº¿ç¨‹è¿›å…¥äº†if(singleton==null)åˆ¤æ–­è¯­å¥å—ï¼Œè¿˜æœªæ¥å¾—åŠå¾€ä¸‹æ‰§è¡Œï¼Œå¦ä¸€ä¸ªçº¿ç¨‹ä¹Ÿé€šè¿‡äº†è¿™ä¸ªåˆ¤æ–­è¯­å¥ï¼Œè¿™æ—¶ä¾¿ä¼šäº§ç”Ÿå¤šä¸ªå®ä¾‹ã€‚æ‰€ä»¥åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¸å¯ä½¿ç”¨è¿™ç§æ–¹å¼ ç»“è®º å®é™…å¼€å‘ä¸­ï¼Œä¸è¦ä½¿ç”¨è¿™ç§æ–¹å¼. 4.æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥æ–¹æ³•ï¼Œä¸æ¨èä½¿ç”¨)class Singleton { private static Singleton instance; private Singleton(){}; //æä¾›ä¸€ä¸ªé™æ€çš„å…¬æœ‰æ–¹æ³•ï¼ŒåŠ å…¥åŒæ­¥å¤„ç†çš„ä»£ç ï¼Œè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ public static synchronized Singleton getInstance() { if (instance == null) { instance = new Singleton(); } return instance; } } ä¼˜ç¼ºç‚¹ è§£å†³äº†çº¿ç¨‹å®‰å…¨é—®é¢˜ æ•ˆç‡å¤ªä½äº†ï¼Œæ¯ä¸ªçº¿ç¨‹åœ¨æƒ³è·å¾—ç±»çš„å®ä¾‹æ—¶å€™ï¼Œæ‰§è¡ŒgetInstance()æ–¹æ³•éƒ½è¦è¿›è¡ŒåŒæ­¥ã€‚è€Œå…¶å®è¿™ä¸ªæ–¹æ³•åªæ‰§è¡Œä¸€æ¬¡å®ä¾‹åŒ–ä»£ç å°±å¤Ÿäº†ï¼Œåé¢çš„æƒ³è·å¾—è¯¥ç±»å®ä¾‹ï¼Œç›´æ¥ return å°±è¡Œäº†ã€‚æ–¹æ³•è¿›è¡ŒåŒæ­¥æ•ˆç‡å¤ªä½ ç»“è®º å®é™…å¼€å‘ä¸­ï¼Œä¸æ¨èä½¿ç”¨è¿™ç§æ–¹å¼ 5. æ‡’æ±‰å¼(çº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥ä»£ç å—ï¼Œä¸æ¨è)class Singleton { private static Singleton instance; private Singleton(){}; public static Singleton getInstance() { if (instance == null) { synchronized (Singleton.class) { instance = new Singleton(); } } return instance; } } ä¼˜ç¼ºç‚¹ ä¸ä¸Šä¸€ä¸ªæ¨¡å¼åŒæ ·ï¼Œè§£å†³äº†çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä½†æ•ˆç‡å¤ªä½äº† 6.åŒé‡æ£€æŸ¥(æ¨èä½¿ç”¨)class Singleton { private static volatile Singleton instance;//volatile å¾ˆé‡è¦ private Singleton() {} //åŠ å…¥åŒé‡æ£€æŸ¥ä»£ç ï¼Œè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜, åŒæ—¶è§£å†³æ‡’åŠ è½½é—®é¢˜,åŒæ—¶ä¿è¯äº†æ•ˆç‡, æ¨èä½¿ç”¨ public static synchronized Singleton getInstance() { if (instance == null) { synchronized (Singleton.class) { if (instance == null) { instance = new Singleton(); } } } return instance; } } ä¼˜ç¼ºç‚¹ Double-Check æ¦‚å¿µæ˜¯å¤šçº¿ç¨‹å¼€å‘ä¸­å¸¸ä½¿ç”¨åˆ°çš„ï¼Œå¦‚ä»£ç ä¸­æ‰€ç¤ºï¼Œæˆ‘ä»¬è¿›è¡Œäº†ä¸¤æ¬¡ if (singleton == null)æ£€æŸ¥ï¼Œè¿™ æ ·å°±å¯ä»¥ä¿è¯çº¿ç¨‹å®‰å…¨äº†ã€‚ è¿™æ ·ï¼Œå®ä¾‹åŒ–ä»£ç åªç”¨æ‰§è¡Œä¸€æ¬¡ï¼Œåé¢å†æ¬¡è®¿é—®æ—¶ï¼Œåˆ¤æ–­if(singleton==null)ï¼Œç›´æ¥returnå®ä¾‹åŒ–å¯¹è±¡ï¼Œä¹Ÿé¿ å…çš„åå¤è¿›è¡Œæ–¹æ³•åŒæ­¥. çº¿ç¨‹å®‰å…¨;å»¶è¿ŸåŠ è½½;æ•ˆç‡è¾ƒé«˜ volatile ç¦æ­¢æŒ‡ä»¤é‡æ’ ç»“è®º åœ¨å®é™…å¼€å‘ä¸­ï¼Œæ¨èä½¿ç”¨è¿™ç§å•ä¾‹è®¾è®¡æ¨¡å¼ 7.é™æ€å†…éƒ¨ç±»(æ¨è)class Singleton { private static volatile Singleton instance;//volatile å¾ˆé‡è¦ private Singleton() {} private static class SingletonInstance { private static final Singleton INSTANCE = new Singleton(); } public static synchronized Singleton getInstance() { return SingletonInstance.INSTANCE; } } ä¼˜ç¼ºç‚¹ è¿™ç§æ–¹å¼é‡‡ç”¨äº†ç±»è£…è½½çš„æœºåˆ¶æ¥ä¿è¯åˆå§‹åŒ–å®ä¾‹æ—¶åªæœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚ é™æ€å†…éƒ¨ç±»æ–¹å¼åœ¨Singletonç±»è¢«è£…è½½æ—¶å¹¶ä¸ä¼šç«‹å³å®ä¾‹åŒ–ï¼Œè€Œæ˜¯åœ¨éœ€è¦å®ä¾‹åŒ–æ—¶ï¼Œè°ƒç”¨getInstanceæ–¹æ³•ï¼Œæ‰ä¼šè£…è½½ SingletonInstance ç±»ï¼Œä»è€Œå®Œæˆ Singleton çš„å®ä¾‹åŒ–ã€‚ ç±»çš„é™æ€å±æ€§åªä¼šåœ¨ç¬¬ä¸€æ¬¡åŠ è½½ç±»çš„æ—¶å€™åˆå§‹åŒ–ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œï¼ŒJVMå¸®åŠ©æˆ‘ä»¬ä¿è¯äº†çº¿ç¨‹çš„å®‰å…¨æ€§ï¼Œåœ¨ç±»è¿›è¡Œåˆå§‹åŒ–æ—¶ï¼Œåˆ«çš„çº¿ç¨‹æ˜¯æ— æ³•è¿›å…¥çš„ã€‚ é¿å…äº†çº¿ç¨‹ä¸å®‰å…¨ï¼Œåˆ©ç”¨é™æ€å†…éƒ¨ç±»ç‰¹ç‚¹å®ç°å»¶è¿ŸåŠ è½½ï¼Œæ•ˆç‡é«˜ ç»“è®º æ¨èä½¿ç”¨ 8.æšä¸¾ï¼ˆæ¨èä½¿ç”¨ï¼‰package blog.singleton; public class SingletonTest { public static void main(String[] args) { Singleton singleton1 = Singleton.INSTANCE; Singleton singleton2 = Singleton.INSTANCE; System.out.println(singleton1 == singleton2); singleton1.sayOk(); } } // enum Singleton { INSTANCE;//æšä¸¾å®ä¾‹ public void sayOk() { System.out.println(&quot;ok~&quot;); } } ä¼˜ç¼ºç‚¹ è¿™å€ŸåŠ©JDK1.5ä¸­æ·»åŠ çš„æšä¸¾æ¥å®ç°å•ä¾‹æ¨¡å¼ã€‚ä¸ä»…èƒ½é¿å…å¤šçº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œè€Œä¸”è¿˜èƒ½é˜²æ­¢ååºåˆ—åŒ–é‡æ–°åˆ›å»º æ–°çš„å¯¹è±¡ã€‚ è¿™ç§æ–¹å¼æ˜¯EffectiveJavaä½œè€…JoshBlochæå€¡çš„æ–¹å¼ ç»“è®º æ¨èä½¿ç”¨ 9.ä½¿ç”¨åœºæ™¯éœ€è¦é¢‘ç¹çš„è¿›è¡Œåˆ›å»ºå’Œé”€æ¯çš„å¯¹è±¡ã€åˆ›å»ºå¯¹è±¡æ—¶è€—æ—¶è¿‡å¤šæˆ–è€—è´¹èµ„æºè¿‡å¤š(å³:é‡é‡çº§å¯¹è±¡)ï¼Œä½†åˆç»å¸¸ç”¨åˆ°çš„å¯¹è±¡ã€å·¥å…·ç±»å¯¹è±¡ã€é¢‘ç¹è®¿é—®æ•°æ®åº“æˆ–æ–‡ä»¶çš„å¯¹è±¡(æ¯”å¦‚æ•°æ®æºã€session å·¥å‚ç­‰)","categories":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}],"tags":[{"name":"è®¾è®¡æ¨¡å¼","slug":"è®¾è®¡æ¨¡å¼","permalink":"/tags/è®¾è®¡æ¨¡å¼/"}],"keywords":[{"name":"æŠ€æœ¯","slug":"æŠ€æœ¯","permalink":"/categories/æŠ€æœ¯/"}]}]}